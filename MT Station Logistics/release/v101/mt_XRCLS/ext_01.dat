<?xml version="1.0" encoding="utf-8"?>
<!-- 
	MT Station Logistics
	Version 1.0.0 - 2015-01-14
	This ai script is executed by the captain to get a trade offer
-->
<aiscript name="mt_logistics.trade.gettradeoffer" version="1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="C:\Users\andy\Dropbox (Personal)\Games\XRebirth\modwip\Resources\aiscripts.xsd">
	<!-- Returns a valid trade offer with an amount, reservation and return code - be sure to cancel the reserved amount if the trade fails -->
	<params>
		<param name="lWaypoint" default="[]"	comment="The waypoint we are needing to get a trade offer for"/>
		<param name="DebugLvl"	default="0"/>
	</params>
	<interrupts>
		<!-- Vanilla handler refs -->
		<handler ref="AttackHandler" />
		<handler ref="ScannedHandler" />
		<!-- Handlers for changing debug level -->
		<handler comment="Update the global debug level for this ship">
			<conditions>
				<event_object_signalled object="player.primaryship" param="'XRCLS_UpdateDebugLevel'"/>
			</conditions>
			<actions>
				<debug_text text="'Interrupt Fired: Updating global debug level for all ships %1'.[this.ship.knownname]" filter="scripts_verbose" chance="$iDbgVerb"/>
				<set_value name="$bShipDbg"				exact="$DebugLvl"/>
				<set_value name="$iDbgErr"				exact="100 * ((global.$XRCLS.$iDebugLevel + $bShipDbg) ge 0)"/>
				<set_value name="$iDbgInfo"				exact="100 * ((global.$XRCLS.$iDebugLevel + $bShipDbg) ge 1)"/>
				<set_value name="$iDbgDet"				exact="100 * ((global.$XRCLS.$iDebugLevel + $bShipDbg) ge 2)"/>
				<set_value name="$iDbgVerb"				exact="100 * ((global.$XRCLS.$iDebugLevel + $bShipDbg) ge 3)"/>
			</actions>
		</handler>

		<handler comment="Update the debug level just for this ship">
			<conditions>
				<event_object_signalled object="this.ship" param="'XRCLS_UpdateShipDbgLvl'"/>
			</conditions>
			<actions>
				<set_value name="$bShipDbg"				exact="event.param2"/>
				<set_value name="$iDbgErr"				exact="100 * ((global.$XRCLS.$iDebugLevel + $bShipDbg) ge 0)"/>
				<set_value name="$iDbgInfo"				exact="100 * ((global.$XRCLS.$iDebugLevel + $bShipDbg) ge 1)"/>
				<set_value name="$iDbgDet"				exact="100 * ((global.$XRCLS.$iDebugLevel + $bShipDbg) ge 2)"/>
				<set_value name="$iDbgVerb"				exact="100 * ((global.$XRCLS.$iDebugLevel + $bShipDbg) ge 3)"/>
				<debug_text text="'Interrupt Fired: Updating debug level for %1 Debug Verb = %2 ShipDbg = %3 Global = %4'.[this.ship.knownname, $iDbgVerb,$bShipDbg,global.$XRCLS.$iDebugLevel]" filter="scripts_verbose" chance="$iDbgVerb"/>
			</actions>
		</handler>
	</interrupts>
	<init>
		<set_command_action commandaction="commandaction.searchingtrades" />
	</init>
	<attention min="unknown">
		<actions>
			<!-- Set the debugging output chance -->
			<!-- Setup the debugging levels -->
			<set_value name="$bShipDbg"			exact="$DebugLvl"		comment="0 or 1 to override error dbg level"/>
			<set_value name="$iDbgErr"			exact="100 * ((global.$XRCLS.$iDebugLevel + $bShipDbg) ge 0)"/>
			<set_value name="$iDbgInfo"			exact="100 * ((global.$XRCLS.$iDebugLevel + $bShipDbg) ge 1)"/>
			<set_value name="$iDbgDet"			exact="100 * ((global.$XRCLS.$iDebugLevel + $bShipDbg) ge 2)"/>
			<set_value name="$iDbgVerb"			exact="100 * ((global.$XRCLS.$iDebugLevel + $bShipDbg) ge 3)"/>
			<!-- Extract our waypoint for analysis -->
			<set_value name="$iWPCount"			exact="$lWaypoint.{1}"			comment="Index of WP in list"/>
			<set_value name="$bIsWPActive"		exact="$lWaypoint.{2}"			comment="Note that this is an integer value as Lua thinks false=0 is actually true lol"/>
			<set_value name="$oStation"			exact="$lWaypoint.{3}"			comment="Target station"/>
			<set_value name="$iWPType"			exact="$lWaypoint.{4}"			comment="WP Type (buy, sell, fly to etc.) is integer"/>
			<set_value name="$tWare"			exact="ware.{$lWaypoint.{5}}"	comment="Needed to coerce the string value back to a ware type"/>
			<set_value name="$iMinAmount"		exact="$lWaypoint.{6}"			comment="minimum amount worth setting off for"/>
			<set_value name="$iMaxAmount"		exact="$lWaypoint.{7}"			comment="Maximum stored in hold at any given time"/>
			<set_value name="$iPrice"			exact="$lWaypoint.{8}"			comment="Max or Min price depending on whether buying or selling"/>
			<set_value name="$iWPRange"			exact="$lWaypoint.{9}"			comment="Flight range of waypoint relative to home base"/>
			<!-- Set some variables used locally -->
			<set_value name="$iDesiredAmount"	exact="$iMaxAmount - this.ship.cargo.{$tWare}.count"	comment="The amount we need to fulfil our maximium load for a buy order"/>
			<set_value name="$aRetArg"			exact="'NO_TRADEOFFER'"			comment="Default assuming we get no offer"/>
			<set_value name="$lTradeOffer"		exact="'none'"					comment="Empty holder for our returned tradeoffer"/>
			<set_value name="$bIsTradeValid"	exact="false"					comment="True if we found a valid trade offer"/>
			<set_value name="$bPriceOK"			exact="true"					comment="True if ware unit price is in required price range for buy and sell"/>
			<set_value name="$iActualAmount"	exact="0"						comment="Our actual reserved amount to return"/>
			<!-- Remove any ware reservations we might still have at this station -->
			<remove_ware_reservation object="$oStation" entity="this"/>

			<!-- Buy, load or refuel waypoint -->
			<do_if value="$iWPType == 2 or $iWPType == 4 or $iWPType == 7" comment="Buy, load or refuel">
				<do_if value="$iWPType == 7" comment="Refuel waypoint">
					<set_value name="$tWare"			exact="ware.fuelcells"/>
					<set_value name="$iMaxAmount"		exact="this.ship.cargo.{ware.fuelcells}.max"/>
					<set_value name="$iDesiredAmount"	exact="$iMaxAmount - this.ship.cargo.{ware.fuelcells}.count"	comment="Fill to brim on a refuel"/>
					<set_value name="$iMinAmount"		exact="$iMaxAmount - $iMinAmount" comment="Viability check inverted for refuel?? - CHECK!!"/>
				</do_if>
				<do_if value="this.ship.cargo.{$tWare}.free lt $iDesiredAmount" comment="Cant fit desired amount in so set to freespace left">
					<set_value name="$iDesiredAmount" exact="this.ship.cargo.{$tWare}.free"/>
				</do_if>
				<!-- Check that our cargo space available is greater than the minimum amount we are going to buy -->
				<do_if value="$iMinAmount le this.ship.cargo.{$tWare}.free" comment="We have room so continue - also prevents refuelling if tank has more than $iMinAmount">
					<!-- check how many of the target ware we already have onboard -->
					<do_if value="this.ship.cargo.{$tWare}.count lt $iMaxAmount">
						<!-- Check that the amount we want is greater than the minimum trip amount -->
						<do_if value="$iDesiredAmount ge $iMinAmount">
							<!-- If we get here we need to check the station for a valid load/buy offer -->
							<find_sell_offer tradepartner="this.ship" seller="$oStation" space="$oStation.zone" result="$lSellOffers" wares="[$tWare]" multiple="true"/>
							<do_if value="$lSellOffers.count gt 0">
								<do_all exact="$lSellOffers.count" counter="$i" comment="Debugging">
									<debug_text text="'WP #%3 - Sell Offer Found: Ware %1 Amount %2'.[$lSellOffers.{$i}.ware, $lSellOffers.{$i}.offeramount, $iWPCount]" filter="scripts_verbose" chance="$iDbgVerb"/>
								</do_all>
								<!-- Get our trade offer -->
								<set_value name="$lTradeOffer"		exact="$lSellOffers.{1}"/>
								<!-- If this is a buy waypoint we need to check the price of the offer to ensure it meets the WP criteria -->
								<do_if value ="$iWPType == 4"												comment="Assumes we will pay any price for refuelling">
									<set_value name="$iSellPrice"	exact="$lTradeOffer.unitprice/100ct"	comment="Get unit price of offer"/>
									<do_if value="$iPrice lt $iSellPrice">
										<set_value name="$bPriceOK" exact="false"							comment="WP fails on price check"/>
									</do_if>
								</do_if>
								<!-- Price OK? -->
								<do_if value="$bPriceOK">
									<!-- Now check that there is enough ware to meet our needs at the station -->
									<do_if value="$lTradeOffer.offeramount ge $iMinAmount"							comment="TODO: Should we check for more than one offer found??">
										<do_if value="$lTradeOffer.offeramount lt $iDesiredAmount">
											<set_value name="$iActualAmount" exact="$lTradeOffer.offeramount"	comment="Buy as much as the station has"/>
										</do_if>
										<do_else>
											<set_value name="$iActualAmount" exact="$iDesiredAmount"				comment="Buy the amount we want - for refuel the final docked check should ensure we fill up"/>
										</do_else>
										<!-- Check that we have enough funds to make the purchase -->
										<set_value name="$iTradeCost" exact="$lTradeOffer.unitprice * $iActualAmount"/>
										<do_if value="$iTradeCost lt this.money">
											<!-- We have a valid sale if we got to here so let's go ahead and reserve and fly it! -->
											<debug_text text="'Waypoint %1 is valid - loading %2 %3 from %4  Price = %5 (Buyfree: %6 Sellfree %7)'.[ $iWPCount, $iActualAmount, $lTradeOffer.ware, $lTradeOffer.seller.knownname, $lTradeOffer.unitprice/100ct, $lTradeOffer.buyfree, $lTradeOffer.sellfree]" filter="scripts_verbose" chance="$iDbgVerb"/>
											<!-- CALL SCRIPT TO DO TRADE -->
											<set_value name="$bIsTradeValid" exact="true"/>
											<set_value name="$aRetArg"			exact="'ERR_SELLOFFER_SUCCESS'"			comment="Found a valid trade"/>
										</do_if>
										<do_else>
											<debug_text text="'Waypoint %1 - Invalid: Not enough cash to make purchase Need: %2 Have %3'.[ $iWPCount, $iTradeCost, this.money/100ct]" filter="scripts_verbose" chance="$iDbgVerb"/>
											<set_value name="$aRetArg"			exact="'ERR_SELLOFFER_NOCASH'"/>
										</do_else>
									</do_if>
									<do_else>
										<debug_text text="'Waypoint %1 not viable because there are not enough wares for sale at %2'.[$iWPCount, $oStation.knownname]" filter="scripts_verbose" chance="$iDbgVerb"/>
										<set_value name="$aRetArg"			exact="'ERR_SELLOFFER_NOWARES'"/>
									</do_else>
								</do_if>
								<do_else comment="Wares too expensive">
									<debug_text text="'Waypoint %1 not viable because %2 are too expensive (%3cr each) at %4'.[$iWPCount, $lTradeOffer.ware, $iSellPrice, $oStation.knownname]" filter="scripts_verbose" chance="$iDbgVerb"/>
									<set_value name="$aRetArg"			exact="'ERR_SELLOFFER_COST'"/>
								</do_else>
							</do_if>
							<do_else>
								<debug_text text="'Waypoint %1 not viable because there are no sell offers for the ware at %2'.[$iWPCount, $oStation.knownname]" filter="scripts_verbose" chance="$iDbgVerb"/>
								<set_value name="$aRetArg"			exact="'ERR_SELLOFFER_NO_OFFER'"/>
							</do_else>
						</do_if>
						<do_else>
							<debug_text text="'Waypoint %1 not viable because the amount needed is too small for a viable trip'.[$iWPCount]" filter="scripts_verbose" chance="$iDbgVerb"/>
							<set_value name="$aRetArg"			exact="'ERR_SELLOFFER_NOTVIABLE_AMOUNT'"/>
						</do_else>
					</do_if>
					<do_else>
						<debug_text text="'Waypoint %1 not viable because we already have enough of this ware onboard'.[$iWPCount]" filter="scripts_verbose" chance="$iDbgVerb"/>
						<set_value name="$aRetArg"			exact="'ERR_SELLOFFER_DONTNEED'"/>
					</do_else>
				</do_if>
				<do_else>
					<debug_text text="'Waypoint %1 not viable due to not enough cargospace'.[$iWPCount]" filter="scripts_verbose" chance="$iDbgVerb"/>
					<set_value name="$aRetArg"			exact="'ERR_SELLOFFER_NOCARGOSPACE'"/>
				</do_else>
			</do_if>

			<!-- Unload or sell waypoint -->
			<do_elseif value="$iWPType == 3 or $iWPType == 5" comment="Unload or sell">
				<!-- Check that we have the desired ware on board first -->
				<do_if value="this.ship.cargo.{$tWare}.count ge $iMinAmount">
					<!-- We have enough so lets check our target station to see if it wants any -->
					<find_buy_offer tradepartner="this.ship" buyer="$oStation" space="$oStation.zone" wares="[$tWare]" result="$lBuyOffers" multiple="true"/>
					<do_if value="$lBuyOffers.count gt 0">
						<do_all exact="$lBuyOffers.count" counter="$i">
							<debug_text text="'WP #%3 - Buy Offer Found: Ware %1 Amount %2 Station: %4 Zone: %5'.[$lBuyOffers.{$i}.ware, $lBuyOffers.{$i}.offeramount, $iWPCount, $lBuyOffers.{$i}.buyer.knownname,  $lBuyOffers.{$i}.buyer.zone.knownname]" filter="scripts_verbose" chance="$iDbgVerb"/>
						</do_all>
						<!-- Get our trade offer -->
						<set_value name="$lTradeOffer"		exact="$lBuyOffers.{1}"/>
						<!-- Check price if this is a sell waypoint -->
						<do_if value ="$iWPType == 5"												comment="None">
							<set_value name="$iBuyPrice"	exact="$lTradeOffer.unitprice/100ct"	comment="Get unit price of offer"/>
							<do_if value="$iPrice gt $iBuyPrice">
								<set_value name="$bPriceOK" exact="false"							comment="WP fails on price check"/>
							</do_if>
						</do_if>
						<!-- Price OK? -->
						<do_if value="$bPriceOK">
							<!-- Now check that there are enough wares required at the station -->
							<do_if value="$lTradeOffer.offeramount ge $iMinAmount">
								<do_if value="$lTradeOffer.offeramount lt $iMaxAmount">
									<do_if value="this.ship.cargo.{$tWare}.count gt $lTradeOffer.offeramount">
										<set_value name="$iActualAmount" exact="$lTradeOffer.offeramount" comment="Sell the amount the station wants"/>
										<debug_text text="'1. Sell Amount set to %1 cargo = %2'.[$iActualAmount,this.ship.cargo.{$tWare}.count]" filter="scripts_verbose" chance="$iDbgVerb"/>
									</do_if>
									<do_else>
										<set_value name="$iActualAmount" exact="this.ship.cargo.{$tWare}.count" comment="Sell as much as we have"/>
										<debug_text text="'2. Sell Amount set to %1 cargo = %2'.[$iActualAmount,this.ship.cargo.{$tWare}.count]" filter="scripts_verbose" chance="$iDbgVerb"/>
									</do_else>
								</do_if>
								<do_else comment="Station wants more than we are selling">
									<do_if value="this.ship.cargo.{$tWare}.count gt $iMaxAmount">
										<set_value name="$iActualAmount" exact="$iMaxAmount" comment="Sell the amount we want to sell"/>
										<debug_text text="'3. Sell Amount set to %1 cargo = %2'.[$iActualAmount,this.ship.cargo.{$tWare}.count]" filter="scripts_verbose" chance="$iDbgVerb"/>
									</do_if>
									<do_else>
										<set_value name="$iActualAmount" exact="this.ship.cargo.{$tWare}.count" comment="Sell as much as we have"/>
										<debug_text text="'4. Sell Amount set to %1 cargo = %2'.[$iActualAmount,this.ship.cargo.{$tWare}.count]" filter="scripts_verbose" chance="$iDbgVerb"/>
									</do_else>
								</do_else>
								<!-- We have a valid sale if we got to here so let's go ahead and reserve and fly it! -->
								<debug_text text="'Waypoint %1 is valid - Unloading %2 %3 to %4  Price = %5 (Buyfree: %6 Sellfree %7)'.[ $iWPCount, $iActualAmount, $lTradeOffer.ware, $lTradeOffer.buyer.knownname, $lTradeOffer.unitprice/100ct, $lTradeOffer.buyfree, $lTradeOffer.sellfree]" filter="scripts_verbose" chance="$iDbgVerb"/>
								<!-- CALL SCRIPT TO DO TRADE -->
								<set_value name="$bIsTradeValid" exact="true"/>
								<set_value name="$aRetArg"			exact="'ERR_BUYOFFER_SUCCESS'"			comment="Found a valid trade"/>
							</do_if>
							<do_else>
								<debug_text text="'Waypoint %1 not viable because there are not enough wares required at %2'.[$iWPCount, $oStation.knownname]" filter="scripts_verbose" chance="$iDbgVerb"/>
								<set_value name="$aRetArg"			exact="'ERR_BUYOFFER_NOTENOUGHWARES'"/>
							</do_else>
						</do_if>
						<do_else comment="Station won't pay enough">
							<debug_text text="'Waypoint %1 not viable because %2 wont pay enough'.[$iWPCount, $oStation.knownname]" filter="scripts_verbose" chance="$iDbgVerb"/>
							<set_value name="$aRetArg"			exact="'ERR_BUYOFFER_WONTPAY'"/>
						</do_else>
					</do_if>
					<do_else>
						<debug_text text="'Waypoint %1 not viable because there are no buy offers for the ware at %2'.[$iWPCount, $oStation.knownname]" filter="scripts_verbose" chance="$iDbgVerb"/>
						<set_value name="$aRetArg"			exact="'ERR_BUYOFFER_NO_OFFER'"/>
					</do_else>
				</do_if>
				<do_else>
					<debug_text text="'Waypoint %1 not viable due to not enough of ware %2 onboard. Have %3 - Wanted at least %4'.[$iWPCount, $tWare, this.ship.cargo.{$tWare}.count, $iMinAmount]" filter="scripts_verbose" chance="$iDbgVerb"/>
					<set_value name="$aRetArg"			exact="'ERR_BUYOFFER_NOTENOUGHCARGO'"/>
				</do_else>
			</do_elseif>					
		
			<!-- Unhandled waypoint type -->
			<do_else>
				<debug_text text="'Unhandled Waypoint Type Detected!! %1'.[$iWPType]" filter="scripts_verbose" chance="$iDbgVerb"/>
				<set_value name="$aRetArg"			exact="'ERR_UNHANDLED_WP'"/>
			</do_else>	
			
			<!-- Reserve our waypoint wares if trade offer is good -->
			<do_if value="$bIsTradeValid" comment="Offer good so reserve the wares">
				<set_value name="$iReserved" exact="0"/>
				<add_ware_reservation object="$oStation" entity="this" ware="$tWare" amount="$iActualAmount" result="$iReserved"/>
				<set_value name="$iActualAmount" exact="$iReserved"/>
				<do_if value="$iReserved lt $iMinAmount">
					<debug_text text="'Target Station %1 - Failed to reserve sufficient stock Wanted %2 Got Offered %3'.[$oStation.knownname, $iMinAmount, $iReserved]" filter="scripts_verbose" chance="$iDbgVerb"/>
					<set_value name="$aRetArg"			exact="'ERR_CANTRESERVE'"/>
					<remove_ware_reservation object="$oStation" entity="this" comment="Remove the reservation"/>
					<set_value name="$lTradeOffer" exact="'none'"/>
				</do_if>
			</do_if>

			<!-- Cleanup -->
			<remove_value name="$bShipDbg"/>
			<remove_value name="$iDbgErr"/>
			<remove_value name="$iDbgInfo"/>
			<remove_value name="$iDbgDet"/>
			<remove_value name="$iDbgVerb"/>
			<remove_value name="$iWPCount"/>
			<remove_value name="$bIsWPActive"/>
			<remove_value name="$iWPType"/>
			<remove_value name="$tWare"/>
			<remove_value name="$iMinAmount"/>
			<remove_value name="$iMaxAmount"/>
			<remove_value name="$iPrice"/>
			<remove_value name="$iWPRange"/>
			<remove_value name="$iDesiredAmount"/>
			<remove_value name="$bPriceOK"/>

			<!-- Return values to parent -->
			<return>
				<retval name="aRetArg"			value="$aRetArg"/>
				<retval name="lTradeOffer"		value="$lTradeOffer"/>
				<retval name="iActualAmount"	value="$iActualAmount"/>
				<retval name="bIsTradeValid"	value="$bIsTradeValid"/>
			</return>
		</actions>
	</attention>
	<on_abort>
		<do_if value="$oStation.exists">
			<remove_ware_reservation object="$oStation" entity="this" comment="Remove the reservation"/>
			<remove_value name="$oStation"/>
		</do_if>
	</on_abort>
</aiscript><?xml version="1.0" encoding="utf-8"?>
<!-- 
	MT Station Logistics
	Version 1.0.0 - 2015-01-14
	This ai script is executed by the captain to perform a buy trade run
-->
<aiscript name="mt_logistics.trade.ship.perform_run" version="1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="C:\Users\andy\Dropbox (Personal)\Games\XRebirth\modwip\Resources\aiscripts.xsd">
	<params>
		<!-- Pass in the trader list - ship, HB, cargolist, and waypoints -->
		<param name="lWaypoint"		default="[]"/>
		<param name="DebugLvl"		default="0"/>
	</params>
	<interrupts>
		<!-- Vanilla handler refs -->
		<handler ref="AttackHandler" />
		<handler ref="ScannedHandler" />
		<!-- Handlers for changing debug level -->
		<handler comment="Update the global debug level for this ship">
			<conditions>
				<event_object_signalled object="player.primaryship" param="'XRCLS_UpdateDebugLevel'"/>
			</conditions>
			<actions>
				<debug_text text="'Interrupt Fired: Updating global debug level for all ships %1'.[this.ship.knownname]" filter="scripts_verbose" chance="$iDbgVerb"/>
				<set_value name="$bShipDbg"				exact="$DebugLvl"/>
				<set_value name="$iDbgErr"				exact="100 * ((global.$XRCLS.$iDebugLevel + $bShipDbg) ge 0)"/>
				<set_value name="$iDbgInfo"				exact="100 * ((global.$XRCLS.$iDebugLevel + $bShipDbg) ge 1)"/>
				<set_value name="$iDbgDet"				exact="100 * ((global.$XRCLS.$iDebugLevel + $bShipDbg) ge 2)"/>
				<set_value name="$iDbgVerb"				exact="100 * ((global.$XRCLS.$iDebugLevel + $bShipDbg) ge 3)"/>
			</actions>
		</handler>

		<handler comment="Update the debug level just for this ship">
			<conditions>
				<event_object_signalled object="this.ship" param="'XRCLS_UpdateShipDbgLvl'"/>
			</conditions>
			<actions>
				<set_value name="$bShipDbg"				exact="event.param2"/>
				<set_value name="$iDbgErr"				exact="100 * ((global.$XRCLS.$iDebugLevel + $bShipDbg) ge 0)"/>
				<set_value name="$iDbgInfo"				exact="100 * ((global.$XRCLS.$iDebugLevel + $bShipDbg) ge 1)"/>
				<set_value name="$iDbgDet"				exact="100 * ((global.$XRCLS.$iDebugLevel + $bShipDbg) ge 2)"/>
				<set_value name="$iDbgVerb"				exact="100 * ((global.$XRCLS.$iDebugLevel + $bShipDbg) ge 3)"/>
				<debug_text text="'Interrupt Fired: Updating debug level for %1 Debug Verb = %2 ShipDbg = %3 Global = %4'.[this.ship.knownname, $iDbgVerb,$bShipDbg,global.$XRCLS.$iDebugLevel]" filter="scripts_verbose" chance="$iDbgVerb"/>
			</actions>
		</handler>

	</interrupts>
	<init>
		<set_command_action commandaction="commandaction.searchingtrades" />
		<!-- TODO: Maybe do our own logging here - e.g. message to log ship, crew, range, #WPs etc -->
	</init>
	<attention min="unknown">
		<actions>
			<!-- Set debug levels -->
			<!-- Setup the debugging levels -->
			<set_value name="$bShipDbg"				exact="$DebugLvl" comment="0 or 1 to override error dbg level"/>
			<set_value name="$iDbgErr"				exact="100 * ((global.$XRCLS.$iDebugLevel + $bShipDbg) ge 0)"/>
			<set_value name="$iDbgInfo"				exact="100 * ((global.$XRCLS.$iDebugLevel + $bShipDbg) ge 1)"/>
			<set_value name="$iDbgDet"				exact="100 * ((global.$XRCLS.$iDebugLevel + $bShipDbg) ge 2)"/>
			<set_value name="$iDbgVerb"				exact="100 * ((global.$XRCLS.$iDebugLevel + $bShipDbg) ge 3)"/>
			<!-- Extract our waypoint for analysis -->
			<set_value name="$iWPCount"				exact="$lWaypoint.{1}"						comment="Index of WP in list"/>
			<set_value name="$bIsWPActive"			exact="$lWaypoint.{2}"						comment="Note that this is an integer value as Lua thinks false=0 is actually true lol"/>
			<set_value name="$oStation"				exact="$lWaypoint.{3}"						comment="Target station"/>
			<set_value name="$iWPType"				exact="$lWaypoint.{4}"						comment="WP Type (buy, sell, fly to etc.) is integer"/>
			<set_value name="$tWare"				exact="ware.{$lWaypoint.{5}}"				comment="Needed to coerce the string value back to a ware type"/>
			<set_value name="$iMinAmount"			exact="$lWaypoint.{6}"						comment="minimum amount worth setting off for"/>
			<set_value name="$iMaxAmount"			exact="$lWaypoint.{7}"						comment="Maximum stored in hold at any given time"/>
			<set_value name="$iPrice"				exact="$lWaypoint.{8}"						comment="Max or Min price depending on whether buying or selling"/>
			<set_value name="$iWPRange"				exact="$lWaypoint.{9}"						comment="Flight range of waypoint relative to home base"/>
			<!-- Set some variables used locally -->
			<set_value name="$iDesiredAmount"		exact="$iMaxAmount - this.ship.cargo.{$tWare}.count"	comment="The amount we need to fulfil our maximium load for a buy order"/>
			<set_value name="$aRetArg"				exact="'NO_TRADEOFFER'"						comment="Default assuming we get no offer"/>
			<set_value name="$lTradeOffer"			exact="'none'"								comment="Empty holder for our returned tradeoffer"/>
			<set_value name="$bIsTradeValid"		exact="false"								comment="True if we found a valid trade offer"/>
			<set_value name="$iActualAmount"		exact="0"									comment="Our actual reserved amount to return"/>
			<set_value name="$iUnitPrice"			exact="0"									comment="Initialise return value"/>
			<set_value name="$iCurrentCargoAmount"	exact="this.ship.cargo.{$tWare}.count"		comment="Initialise return value"/>
			<set_value name="$iNewCargoAmount"		exact="this.ship.cargo.{$tWare}.count"		comment="Initialise return value"/>
			<set_value name="$iTradedAmount"		exact="0"									comment="Initialise return value"/>

			<!-- Does our target exist? -->
			<do_if value="not $oStation.isoperational or not $oStation.exists" comment="Station Offline or Destroyed so abort">
				<debug_text text="'Target Station %1 is not operational'.[$oStation.knownname]" filter="scripts_verbose" chance="$iDbgVerb"/>
				<set_value name="$aRetArg" exact="'ERR_TARGET_INVALID'"/>
				<resume label="finished"/>
			</do_if>

			<!-- Try to get a trade offer to see if it's worth flying -->
			<run_script name="'mt_logistics.trade.gettradeoffer'" sinceversion="1">
				<param		 name="lWaypoint"		value="$lWaypoint"/>
				<param		 name="DebugLvl"		value="$bShipDbg"/>
				<save_retval name="aRetArg"			variable="$aRetArg"/>
				<save_retval name="lTradeOffer"		variable="$lTradeOffer"/>
				<save_retval name="iActualAmount"	variable="$iActualAmount"/>
				<save_retval name="bIsTradeValid"	variable="$bIsTradeValid"/>
			</run_script>

			<!-- Check our trade offer first before travelling to make sure it's worth the trip -->
			<do_if value="not $bIsTradeValid" comment="No trade so bug out">
				<debug_text text="'%1 has no valid offers - %2'.[$oStation.knownname, $aRetArg]" filter="scripts_verbose" chance="$iDbgVerb"/>
				<resume label="finished"/>
			</do_if>

			
			
			<!-- Good to go if we get here - Ware is reserved so let's make the trip -->
			<do_if value="@this.ship.parkedat.container != $oStation" comment="Only move if we need to go to a new station">
				<do_if value="this.zone != $oStation.zone" comment="Get a bit closer if we're not already in the zone">
					<do_if value="this.ship.parkedat.exists">
						<debug_text text="'Undocking - Moving to target station %1'.[$oStation.knownname]" filter="scripts_verbose" chance="$iDbgVerb"/>
						<run_script name="'move.unpark'" sinceversion="1"/>
					</do_if>
					<debug_text text="'Target Station %1 - Moving in range of target'.[$oStation.knownname]" filter="scripts_verbose" chance="$iDbgVerb"/>
					<run_script name="'move.generic'" sinceversion="1">
						<param name="destination" value="$oStation" />
						<param name="endintargetzone" value="true"		comment="Just fly to the zone and let move.park take it from there" />
						<param name="debugchance" value="$iDbgVerb"/>
					</run_script>
				</do_if>
				<do_else>
					<debug_text text="'Target Station %1 - Already in zone - moving to dock'.[$oStation.knownname]" filter="scripts_verbose" chance="$iDbgVerb"/>
					<resume label="move to target"/>
				</do_else>
			</do_if>
			<do_else>
				<debug_text text="'Already parked at %1 so lets make the trade'.[$oStation.knownname]" filter="scripts_verbose" chance="$iDbgVerb"/>
				<resume label="make trade"/>
			</do_else>

			<!-- Check station is still functioning after trip -->
			<do_if value="not $oStation.isoperational or not $oStation.exists" comment="Station Offline or Destroyed so abort">
				<set_value name="$aRetArg" exact="'ERR_TARGET_INVALID'"/>
				<remove_ware_reservation object="$oStation" entity="this"/>
				<debug_text text="'Target Station %1 is not operational after trip made'.[$oStation.knownname]" filter="scripts_verbose" chance="$iDbgVerb"/>
				<resume label="finished"/>
			</do_if>

			<!-- Check trade offer again after trip in case it's gone -->
			<run_script name="'mt_logistics.trade.gettradeoffer'" sinceversion="1">
				<param		 name="lWaypoint"		value="$lWaypoint"/>
				<param		 name="DebugLvl"		value="$bShipDbg"/>
				<save_retval name="aRetArg"			variable="$aRetArg"/>
				<save_retval name="lTradeOffer"		variable="$lTradeOffer"/>
				<save_retval name="iActualAmount"	variable="$iActualAmount"/>
				<save_retval name="bIsTradeValid"	variable="$bIsTradeValid"/>
			</run_script>

			<do_if value="not $bIsTradeValid" comment="Offer has died so abort">
				<remove_ware_reservation object="$oStation" entity="this"/>
				<debug_text text="'Target Station %1 has no valid sell offers now we have arrived - Reason - %2'.[$oStation.knownname, $aRetArg]" filter="scripts_verbose" chance="$iDbgVerb"/>
				<resume label="finished"/>
			</do_if>

			<!-- Good to go - lets park up -->
			<label name="move to target"/>
			<debug_text text="'Waypoint %1 - %2 - Proceeding to park at station - %3'.[$iWPCount,player.age,$oStation.knownname]" filter="scripts_verbose" chance="$iDbgVerb"/>
			<run_script name="'move.park'" result="$parkresult" sinceversion="1">
				<param name="destination" value="$oStation" />
				<param name="tradeoffer" value="$lTradeOffer" />
				<param name="amount" value="$iActualAmount" />
			</run_script>
			<do_if value="$parkresult">
				<debug_text text="player.age + ' now parked at ' + $oStation.knownname" filter="scripts_verbose" chance="$iDbgVerb"/>
			</do_if>
			<do_elseif value="this.$reevaluate_parking?">
				<remove_value name="this.$reevaluate_parking" />
				<debug_text text="player.age + ' need to re-evaluate our reason for parking at' + $oStation.knownname" filter="scripts_verbose" chance="$iDbgVerb"/>
				<resume label="move to target" />
			</do_elseif>
			<do_else>
				<debug_text text="player.age + ' critical parking error!'" filter="scripts_verbose" chance="$iDbgVerb"/>
				<set_value name="$aRetArg" exact="'ERR_CANT_PARK'"/>
				<remove_ware_reservation object="$oStation" entity="this"/>
				<resume label="finished" />
			</do_else>

			<label name="make trade"/>
			<!-- All Good so let's trade -->
			<!-- Let's check the trade order is still valid - final check now we're parked -->
			<run_script name="'mt_logistics.trade.gettradeoffer'" sinceversion="1">
				<param		 name="lWaypoint"		value="$lWaypoint"/>
				<param		 name="DebugLvl"		value="$bShipDbg"/>
				<save_retval name="aRetArg"			variable="$aRetArg"/>
				<save_retval name="lTradeOffer"		variable="$lTradeOffer"/>
				<save_retval name="iActualAmount"	variable="$iActualAmount"/>
				<save_retval name="bIsTradeValid"	variable="$bIsTradeValid"/>
			</run_script>

			<do_if value="not $bIsTradeValid">
				<debug_text text="'Waypoint %1 - We have arrived and parked up at %2 but there is no longer a trade that matches our current way point - ABORTING %3'.[$iWPCount,$oStation.knownname, $aRetArg]" filter="scripts_verbose" chance="$iDbgVerb"/>
				<resume label="finished"/>
			</do_if>

			<!-- Final volume check for buy orders and get faction of trade partner -->
			<do_if value="$iWPType == 2 or $iWPType == 4 or $iWPType == 7" comment="Final Volume check to prevent buying more than will fit in ship">
				<do_if value="this.ship.cargo.{$tWare}.free lt $iActualAmount">
					<set_value name="$iActualAmount" exact="this.ship.cargo.{$tWare}.free"/>
				</do_if>
				<set_value name="$OtherFaction" exact="$lTradeOffer.seller.owner"/>
			</do_if>
			<do_else>
				<set_value name="$OtherFaction" exact="$lTradeOffer.buyer.owner"/>
			</do_else>

			<!-- Start Trade - Get some data first - (should be valid to get dot values here) -->
			<set_value name="$iUnitPrice" exact="$lTradeOffer.unitprice"/>
			<set_value name="$tTradeTime" exact="((( ($iActualAmount)LF * ($tWare.volume)LF  )/(  (this.ship.cargo.{$tWare}.max)LF  * ($tWare.volume)LF   ))LF)s * 360s" comment="Calculated time is %ware transferred * 5mins"/>
			<do_if value="$tTradeTime gt 360s" comment="BandB to prevent huge wait times if data gets screwed">
				<set_value name="$tTradeTime" exact="360s"/>
			</do_if>
			
			<debug_text text="'Waypoint %1 - %2 - Calculated Delivery time = %3'.[$iWPCount, player.age, $tTradeTime]"  filter="scripts_verbose" chance="$iDbgVerb"/>

			<!-- remove the reservation at the correct point -->
			<do_if value="$iWPType == 2 or $iWPType == 4 or $iWPType == 7" comment="Remove reservation before trade for buy">
				<remove_ware_reservation object="$oStation" entity="this" comment="Remove reservation before buy as per vanilla script"/>
			</do_if>

			<execute_trade commandaction="true" tradeoffer="$lTradeOffer" tradepartner="this.ship" amount="$iActualAmount" result="$traderesult" sinceversion ="1"/>

			<do_if value="$iWPType == 3 or $iWPType == 5" comment="Remove reservation after trade for sell">
				<remove_ware_reservation object="$oStation" entity="this" comment="Remove reservation after sell as per vanilla script"/>
			</do_if>

			<detach_from_masstraffic object="this.ship" wait="true" sinceversion="1">
				<interrupt_after_time time="120s + $tTradeTime" comment="Delay is volume dependant - seems to only affect OOZ park time!" />
			</detach_from_masstraffic>
			<remove_value name="$tTradeTime"/>

			<do_if value="not $traderesult">
				<debug_text text="'Waypoint %1 - Trade seems to have failed - %2'.[$iWPCount,$aRetArg]" filter="scripts_verbose" chance="$iDbgVerb"/>
				<set_value name="$aRetArg" exact="'ERR_INTRADE_FAIL'"/>
				<resume label="finished" />
			</do_if>

			<set_value name="$aRetArg" exact="'TRADE_SUCCESS'"/>
			<debug_text text="'Waypoint %1 - %2 - Successfully traded chosen goods! - %3'.[$iWPCount, player.age, $aRetArg]"  filter="scripts_verbose" chance="$iDbgVerb"/>

			<label name="finished"/>
			<do_if value="$aRetArg == 'TRADE_SUCCESS'">
				<set_value name="$iNewCargoAmount" exact="this.ship.cargo.{$tWare}.count"/>
				<do_if value="$iWPType == 2 or $iWPType == 4 or $iWPType == 7">
					<set_value name="$iTradedAmount" exact="$iNewCargoAmount - $iCurrentCargoAmount"/>
				</do_if>
				<do_else>
					<set_value name="$iTradedAmount" exact="$iCurrentCargoAmount - $iNewCargoAmount"/>
				</do_else>
				<do_if value="@$traderesult and $OtherFaction != faction.player">
					<!-- Relation bonus for the player: Base bonus for the trade itself (max +1 UI value per 4 trades) and price-based bonus (max +1 UI value per 4M Credits) -->
					<set_value name="$iFactionBoost" exact="0.00016LF + (0.00064LF / (4000000Cr)LF * (($iTradedAmount)*$iUnitPrice/1Cr)LF)"/>
					<add_faction_relation faction="faction.player" otherfaction="$OtherFaction" value="$iFactionBoost" />
					<debug_text text="'Adding some faction relation bonus - Increased rep with %1 by %2'.[$OtherFaction.knownname, $iFactionBoost]"  filter="scripts_verbose" chance="$iDbgVerb"/>
				</do_if>
				<debug_text text="'Traded: %1 units of %2 at %3 each - Total = %4'.[$iTradedAmount, $tWare, $iUnitPrice/1Cr, ($iTradedAmount)*$iUnitPrice/1Cr]"  filter="scripts_verbose" chance="$iDbgVerb"/>
			</do_if>
			<do_else>
				<debug_text text="'Waypoint %1 - Trade Failed for some reason - %2'.[$iWPCount, $aRetArg]" filter="scripts_verbose" chance="$iDbgVerb"/>
			</do_else>
			
			<!-- Clean up -->
			<remove_value name="$bShipDbg"/>
			<remove_value name="$iDbgErr"/>
			<remove_value name="$iDbgInfo"/>
			<remove_value name="$iDbgDet"/>
			<remove_value name="$iDbgVerb"/>
			<remove_value name="$iWPCount"/>
			<remove_value name="$bIsWPActive"/>
			<remove_value name="$iWPType"/>
			<remove_value name="$tWare"/>
			<remove_value name="$iMinAmount"/>
			<remove_value name="$iMaxAmount"/>
			<remove_value name="$iPrice"/>
			<remove_value name="$iWPRange"/>
			<remove_value name="$iDesiredAmount"/>
			<remove_value name="$lTradeOffer"/>
			<remove_value name="$bIsTradeValid"/>
			<remove_value name="$iActualAmount"/>
			<remove_value name="$iCurrentCargoAmount"/>
			<remove_value name="$iNewCargoAmount"/>

			<!-- Return trade details here so we can add to log -->
			<return>
				<retval name="RetArg" value="$aRetArg"/>
				<retval name="UnitPrice" value="$iUnitPrice"/>
				<retval name="Volume" value="$iTradedAmount"/>
			</return>			
		</actions>
	</attention>
	<on_abort>
		<do_if value="this.ship.parkedat.exists">
			<disconnect_from_trade_location ship="this.ship"/>
		</do_if>
		<do_if value="$oStation.exists">
			<remove_ware_reservation object="$oStation" entity="this"/>
		</do_if>
		<remove_value name="$oStation"/>
	</on_abort>
</aiscript><?xml version="1.0" encoding="utf-8"?>
<!-- 
	MT Station Logistics
	Version 1.0.0 - 2015-01-10
	This is the main ai script that is run by XRCLS trade ship captains (DO and Engineer run vanilla scripts for now)
-->
<aiscript name="mt_logistics.trade.ship" version="1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="C:\Users\andy\Dropbox (Personal)\Games\XRebirth\modwip\Resources\aiscripts.xsd">
	<params>
		<!-- Pass in the trader list - ship, HB, cargolist, and waypoints -->
		<param name="lTradeDetails" default="[]"/>
	</params>
	<interrupts>
		<!-- Vanilla handler refs -->
		<handler ref="AttackHandler" />
		<handler ref="ScannedHandler" />
		<!-- Handlers for updating WP list and changing debug level -->
		<handler comment="Update the global debug level for this ship">
			<conditions>
				<event_object_signalled object="player.primaryship" param="'XRCLS_UpdateDebugLevel'"/>
			</conditions>
			<actions>
				<debug_text text="'Interrupt Fired: Updating global debug level for all ships %1'.[this.ship.knownname]" filter="scripts_verbose" chance="$iDbgVerb"/>
				<set_value name="$bShipDbg"				exact="$lTradeDetails.{13}"/>
				<set_value name="$iDbgErr"				exact="100 * ((global.$XRCLS.$iDebugLevel + $bShipDbg) ge 0)"/>
				<set_value name="$iDbgInfo"				exact="100 * ((global.$XRCLS.$iDebugLevel + $bShipDbg) ge 1)"/>
				<set_value name="$iDbgDet"				exact="100 * ((global.$XRCLS.$iDebugLevel + $bShipDbg) ge 2)"/>
				<set_value name="$iDbgVerb"				exact="100 * ((global.$XRCLS.$iDebugLevel + $bShipDbg) ge 3)"/>
			</actions>
		</handler>

		<handler comment="Update the debug level just for this ship">
			<conditions>
				<event_object_signalled object="this.ship" param="'XRCLS_UpdateShipDbgLvl'"/>
			</conditions>
			<actions>
				<set_value name="$bShipDbg"				exact="event.param2"/>
				<set_value name="$iDbgErr"				exact="100 * ((global.$XRCLS.$iDebugLevel + $bShipDbg) ge 0)"/>
				<set_value name="$iDbgInfo"				exact="100 * ((global.$XRCLS.$iDebugLevel + $bShipDbg) ge 1)"/>
				<set_value name="$iDbgDet"				exact="100 * ((global.$XRCLS.$iDebugLevel + $bShipDbg) ge 2)"/>
				<set_value name="$iDbgVerb"				exact="100 * ((global.$XRCLS.$iDebugLevel + $bShipDbg) ge 3)"/>
				<debug_text text="'Interrupt Fired: Updating debug level for %1 Debug Verb = %2 ShipDbg = %3 Global = %4'.[this.ship.knownname, $iDbgVerb,$bShipDbg,global.$XRCLS.$iDebugLevel]" filter="scripts_verbose" chance="$iDbgDet"/>
			</actions>
		</handler>
		
		<handler comment="Update the traders parameters">
			<conditions>
				<event_object_signalled object="this.ship" param="'XRCLS_UpdateWaypoints'"/>
			</conditions>
			<actions>
				<set_value name="$lTradeDetails" exact="event.param2"/>
				<debug_text text="'Interrupt Fired:  Crew Skill: %1  Crew Level: %2  Number of Waypoints = %3'.[$iCrewSkill, $iCrewLevel, event.param2.{4}.count]" filter="scripts_verbose" chance="$iDbgVerb"/>
			</actions>
		</handler>
	</interrupts>
	<init>
		<set_command command="command.freetrade" />
		<!-- Main action for waiting times -->
		<set_command_action commandaction="commandaction.searchingtrades" />
		<!-- TODO: Maybe do our own logging here - e.g. message to log ship, crew, range, #WPs etc -->
		<set_value name="$oShip" exact="this.ship" comment="set to allow reporting if ship dies"/>
	</init>
	<attention min="unknown"> 
		<actions>
			<!-- Setup the debugging levels -->
			<set_value name="$bShipDbg"				exact="$lTradeDetails.{13}" comment="0 or 1 to override error dbg level"/>
			<set_value name="$iDbgErr"				exact="100 * ((global.$XRCLS.$iDebugLevel + $bShipDbg) ge 0)"/>
			<set_value name="$iDbgInfo"				exact="100 * ((global.$XRCLS.$iDebugLevel + $bShipDbg) ge 1)"/>
			<set_value name="$iDbgDet"				exact="100 * ((global.$XRCLS.$iDebugLevel + $bShipDbg) ge 2)"/>
			<set_value name="$iDbgVerb"				exact="100 * ((global.$XRCLS.$iDebugLevel + $bShipDbg) ge 3)"/>

			<set_value name="$tLastWageRun"			exact="player.age"/>
			<set_value name="$tStartTime"			exact="player.age"/>
			<set_value name="$tCumlTime"			exact="0s"/>
			<set_value name="$lWPTypeList"			exact="['No Action','Load','Unload','Buy','Sell','Fly To','Refuel']"/>

			<!-- Perpetual loop - can be interrupted and aborted only -->
			<do_while value="true">
				<set_value name="$lWaypoints"			exact="$lTradeDetails.{4}"		comment="Get our list of waypoints"/>
				<set_value name="$iShipIndex"			exact="$lTradeDetails.{10}"		comment="Index of this trader in global list"/>
				<set_value name="$iWPCount"				exact="1"						comment="Counter for the waypoint loop"/>	
				<set_value name="$iNullSweepCount"		exact="0"						comment="Counts the number of times we have a zero hit sweep of the list"/>
				<set_value name="$bIsNullSweep"			exact="true"					comment="True if we got a null sweep"/>
				<set_value name="$iWageBill"			exact="0ct"						comment="Running total of wages to pay"/>
				<set_value name="$bStaffOnStrike"		exact="false"					comment="True if staff didn't get paid on last wage run"/>
				<set_value name="$iAmountOwed"			exact="0ct"						comment="Holds amount of wages owed until they are paid"/>

				<!-- Loop through all our waypoints looking for valid ones to execute -->
				<do_while value="$iWPCount le $lWaypoints.count" comment="Use a while loop with compares as our waypoint list size could change at any time">
					<!-- Calculate our crew level after each waypoint to stop cheating -->
					<set_value name="$iCrewSkill"		exact="@this.combinedskill + @this.ship.defencenpc.combinedskill + @this.ship.engineer.combinedskill"/>
					<set_value name="$iCrewLevel"		exact="1"/>
					<set_value name="$aTradeRetArg"		exact="'NO_TRADE'"/>
					<set_value name="$iUnitPrice"		exact="0ct"/>
					<set_value name="$iVolume"			exact="0"/>
					<!-- set crew level based on crew skills -->
					<do_if value="$iCrewSkill"			min="200" max="249">
						<set_value name="$iCrewLevel"		exact="2"/>
					</do_if>
					<do_if value="$iCrewSkill ge 250">
						<set_value name="$iCrewLevel"		exact="3"/>
					</do_if>
					<!-- debug_text text="'Crew Skill: %1  Crew Level: %2  Number of Waypoints = %3'.[$iCrewSkill, $iCrewLevel, $lWaypoints.count]" filter="scripts_verbose" chance="$iDbgVerb"/ -->
					<!-- Extract our waypoint for analysis -->
					<set_value name="$lWaypoint"		exact="$lWaypoints.{$iWPCount}"/>
					<set_value name="$iWPIndex"			exact="$lWaypoints.{$iWPCount}.{1}"		comment="Index of WP in list"/>
					<set_value name="$bIsWPActive"		exact="$lWaypoints.{$iWPCount}.{2}"		comment="Note that this is an integer value as Lua thinks false=0 is actually true lol"/>
					<set_value name="$oStation"			exact="$lWaypoints.{$iWPCount}.{3}"		comment="Target station"/>
					<set_value name="$iWPType"			exact="$lWaypoints.{$iWPCount}.{4}"		comment="WP Type (buy, sell, fly to etc.) is integer"/>
					<set_value name="$iMinAmount"		exact="$lWaypoints.{$iWPCount}.{6}"		comment="minimum amount worth setting off for"/>
					<set_value name="$iMaxAmount"		exact="$lWaypoints.{$iWPCount}.{7}"		comment="Maximum stored in hold at any given time"/>
					<set_value name="$tWare"			exact="'none'"							comment="default for logging"/>
					<do_if value="$lWaypoints.{$iWPCount}.{5} != {150402,162}"					comment="'None Selected'">
						<set_value name="$tWare"			exact="ware.{$lWaypoints.{$iWPCount}.{5}}"		comment="Needed to coerce the string value back to a ware type"/>
						<set_value name="$iDesiredAmount"	exact="$iMaxAmount - this.ship.cargo.{$tWare}.count" comment="The amount we need to fulfil our maximium load"/>
					</do_if>
					<set_value name="$iPrice"			exact="$lWaypoints.{$iWPCount}.{8}"		comment="Max or Min price depending on whether buying or selling"/>
					<set_value name="$iWPRange"			exact="$lWaypoints.{$iWPCount}.{9}"		comment="Flight range of waypoint relative to home base"/>

					<set_value name="$bIsTradeValid"	exact="false"							comment="Set this to true only if we are to perform our traderun"/>
					<set_value name="$lTradeOffer"		exact="'none'"							comment="Holder for our return from get offer script"/>
					<set_value name="$iActualAmount"	exact="0"								comment="The actual amount we are going to trade"/>
					
					<set_value name="$tFlyingTime"		exact="0s"/>
					<set_value name="$iCaptainsWage"	exact="0ct"/>
					<set_value name="$iDefenceWage"		exact="0ct"/>
					<set_value name="$iEngineerWage"	exact="0ct"/>
					<set_value name="$iXPoints"			exact="0"/>

					<!-- Check our homebase account level -->
					<set_value name="$oHomebase"		exact="$lTradeDetails.{2}"/>
					<!-- debug_text text="'Manager account = %1'.[$oHomebase.controlentity.{entitytype.manager}.money/100ct]" filter="scripts_verbose" chance="$iDbgVerb"/ -->
					<!-- debug_text text="'Ship account = %1'.[this.money/100ct]" filter="scripts_verbose" chance="$iDbgVerb"/ -->

					<!-- Now analyse our waypoint - first check if the waypoint is active -->
					<do_if value="$bIsWPActive lt 1">
						<debug_text text="'Waypoint %1 set to inactive so skipping to next waypoint'.[$iWPCount]" filter="scripts_verbose" chance="$iDbgVerb"/>
						<set_value name="$aTradeRetArg"		exact="'WP_INACTIVE'"/>
					</do_if>
					
					<!-- Check for staff not getting paid -->
					<do_elseif value="$bStaffOnStrike">
						<debug_text text="'Waypoint %1 - staff on strike - didnt get paid for last trip'.[$iWPCount]" filter="scripts_verbose" chance="$iDbgVerb"/>
						<do_if value="$oHomebase.controlentity.{entitytype.manager}.money ge $iAmountOwed">
							<transfer_money from="$oHomebase.controlentity.{entitytype.manager}" to="player.entity" amount="$iAmountOwed"/>
							<reward_player money="- $iAmountOwed"/>
							<set_value name="$bStaffOnStrike"	exact="false"		comment="Back to work!"/>
							<set_value name="$iAmountOwed"		exact="0ct"			comment="Don't owe anything"/>
							<set_value name="$aTradeRetArg"		exact="'WAGES_PAID'"/>
						</do_if>
						<set_value name="$aTradeRetArg"		exact="'NO_WAGES'"/>
					</do_elseif>
						
					<!-- Check that WP is in range for crew skill level -->
					<do_elseif value="$iWPRange gt $iCrewLevel">
						<debug_text text="'Waypoint %1 is out of range for the current crew so skipping'.[$iWPCount]" filter="scripts_verbose" chance="$iDbgVerb"/>
						<set_value name="$aTradeRetArg"		exact="'ERR_RANGE'"/>
					</do_elseif>
						
					<!-- Check here for relation status of target NPC station (covers relation changes that happen after waypoint is set) -->
					<do_elseif value="$oStation.mayattack.{faction.player} == true" comment="Do not fly to stations that have become hostile after their waypoint was set">
						<debug_text text="'Waypoint %1 - Skipping: station is now hostile'.[$iWPCount]" filter="scripts_verbose" chance="$iDbgVerb"/>
						<set_value name="$aTradeRetArg"		exact="'ERR_HOSTILE'"/>
					</do_elseif>
					
					<!-- Now check our waypoint type and act accordingly -->
					<do_elseif value="$iWPType == 1" comment="Type 1 is no action so skip">
						<debug_text text="'Waypoint %1 set to \'no action\' so skipping to next waypoint'.[$iWPCount]" filter="scripts_verbose" chance="$iDbgVerb"/>
						<set_value name="$aTradeRetArg"		exact="'WP_INACTIVE'"/>
					</do_elseif>

					<!-- Check for a "fly to" Waypoint -->
					<do_elseif value="$iWPType == 6"															comment="Waypoint is a Fly To waypoint">
						<debug_text text="'Waypoint %1 set to \'Fly To\' %2'.[$iWPCount,$oStation.knownname]"	filter="scripts_verbose" chance="$iDbgVerb"/>
						<do_if value="this.ship.distanceto.[$oStation, position.[0,0,0]] lt 10km"				comment="Range check to prevent this constantly flying about">
							<debug_text text="'Close enough to %1 so no need to move'.[$oStation.knownname]"	filter="scripts_verbose" chance="$iDbgVerb"/>
							<set_value name="$aTradeRetArg"		exact="'WP_FLYTO_NOMOVE'"/>
						</do_if>
						<do_else>
							<!-- Set a trip timer here -->
							<set_value name="$tTripStartTime"		exact="player.age"/>
							<set_value name="$tFlyingTime"			exact="0"/>
							<run_script	name="'move.generic'"		sinceversion="1">
								<param name="destination"				value="$oStation"/>
								<param name="debugchance"				value="$iDbgVerb"/>
							</run_script>
							<set_value name="$tTripEndTime"			exact="player.age"/>
							<set_value name="$tFlyingTime"			exact="$tTripEndTime - $tTripStartTime"/>
							<remove_value name="$tTripStartTime"/>
							<remove_value name="$tTripEndTime"/>
							<debug_text text="'We\'ve arrived at %1 Trip Time was %2'.[$oStation.knownname, $tFlyingTime/1min]" filter="scripts_verbose" chance="$iDbgVerb"/>
							<set_value name="$aTradeRetArg"		exact="'WP_FLYTO'"/>
						</do_else>
					</do_elseif>

					<!-- Check for a Load, Unload, buy, sell or refuel Waypoint -->
					<do_elseif value="$iWPType == 2 or $iWPType == 3 or $iWPType == 4 or $iWPType == 5 or $iWPType == 7" comment="Waypoint is a Load waypoint">
						<debug_text text="'Waypoint %1 set to \'%2\' at %3'.[$iWPCount, $lWPTypeList.{$iWPType}, $oStation.knownname]" filter="scripts_verbose" chance="$iDbgVerb"/>
						<debug_text text="'Free space available: %1 - min amount %3 - max amount %4  ware = %2 '.[this.ship.cargo.{$tWare}.free , $tWare, $iMinAmount, $iMaxAmount]" filter="scripts_verbose" chance="$iDbgVerb"/>
						<!-- Perform our trade run -->
						<debug_text text="'Waypoint %1 - Performing Trade'.[$iWPCount]"				filter="scripts_verbose" chance="$iDbgVerb"/>
						<set_value name="$bIsTradeValid"		exact="false"						comment="Reset this variable for next waypoint just in case"/>
						<set_value name="$bIsNullSweep"			exact="false"						comment="Got a trade so no need to wait"/>
						<set_value name="$tTripStartTime"		exact="player.age"/>
						<set_value name="$tFlyingTime"			exact="0"							comment="Trip timer"/>
						<run_script name="'mt_logistics.trade.ship.perform_run'"					sinceversion="1">
							<param		 name="lWaypoint"		value="$lWaypoint"					comment="Pass waypoint to buy script for offer checking"/>
							<param		 name="DebugLvl"		value="$bShipDbg"/>
							<save_retval name="RetArg"			variable="$aTradeRetArg"			comment="The result of our trade on return"/>
							<save_retval name="UnitPrice"		variable="$iUnitPrice"				comment="The unit price we traded at"/>
							<save_retval name="Volume"			variable="$iVolume"					comment="The actual volume we ended up trading"/>
						</run_script>
						<!-- Set null sweep counter if trade was a fail -->
						<do_if value="$aTradeRetArg == 'TRADE_SUCCESS'">
							<set_value name="$bIsNullSweep" exact="false"/>
						</do_if>
						<set_value name="$tTripEndTime"			exact="player.age"/>
						<set_value name="$tFlyingTime"			exact="$tTripEndTime - $tTripStartTime"/>
						<remove_value name="$tTripStartTime"/>
						<remove_value name="$tTripEndTime"/>
						<debug_text text="'Waypoint %1 - Completed Trade Script - %2 Round Trip Time %3'.[$iWPCount, $aTradeRetArg, $tFlyingTime/1min]" filter="scripts_verbose" chance="$iDbgVerb"/>
					</do_elseif>

					<!-- Unhandled waypoint type detected-->
					<do_else>
						<debug_text text="'Unhandled Waypoint Type Detected!! %1 - %2'.[$iWPCount,$iWPType]" filter="scripts_verbose" chance="$iDbgVerb"/>
					</do_else>

					<!-- Get cumulative time -->
					<set_value name="global.$XRCLS.$lTradeShips.{$iShipIndex}.{9}.{2}"	exact="player.age - $tStartTime" operation="add"/>
					<set_value name="$tStartTime"										exact="player.age"/>

					<!-- Salary and XP calculations -->
					<do_if value="$tFlyingTime gt 0s">
						<set_value name="$iSalary"		exact="0ct"						comment="Salary calc"/>
						<set_value name="$iXPoints"		exact="0L"						comment="XP Calc"/>
						<!-- Increment crew salary and XP here based on fly time, volume and commission -->
						<do_if value="$iWPType != 6" comment="Only calculate volume if ware is valid">
							<set_value name="$iCubicMetres" exact="($iVolume * $tWare.volume)LF"/>
						</do_if>
						<do_else>
							<set_value name="$iCubicMetres" exact="0LF"/>
						</do_else>
						<do_if value="$iCrewLevel == 1" comment="Salary and xp for L1 crew">
							<!-- L1 crew gets basic time based salary and time+volume based xp -->
							<set_value name="$iFlightTime" exact="($tFlyingTime/60s)L"/>
							<set_value name="$iSalary" exact="($iFlightTime)Cr*20ct" comment="Salary calc"/>
							<set_value name="$iCommission" exact="0ct"/>
							<set_value name="$iTotalSalary" exact="$iSalary + $iCommission"/>
							<set_value name="$iXPVol" exact="$iCubicMetres / 10.0"/>
							<set_value name="$iXPoints" exact="(($iTotalSalary)L + ($iXPVol)L)/20L" comment="XP Calc"/>
						</do_if>
						<do_if value="$iCrewLevel == 2" comment="Salary and xp for L2 crew">
							<!-- L2 crew gets intermediate salary and time+volume+commission based xp -->
							<set_value name="$iFlightTime" exact="($tFlyingTime/60s)L"/>
							<set_value name="$iSalary" exact="($iFlightTime)Cr*50ct" comment="Salary calc"/>
							<set_value name="$iCommission" exact="0ct"/>
							<set_value name="$iTotalSalary" exact="$iSalary + $iCommission"/>
							<set_value name="$iXPVol" exact="$iCubicMetres / 10.0"/>
							<set_value name="$iXPoints" exact="(($iTotalSalary)L + ($iXPVol)L)/20L" comment="XP Calc"/>
						</do_if>
						<do_if value="$iCrewLevel == 3" comment="Salary and xp for L3 crew">
							<!-- L3 crew gets top salary + 0.5% commission on sales to NPC stations and time+volume+commission based xp -->
							<set_value name="$iFlightTime" exact="($tFlyingTime/60s)L"/>
							<set_value name="$iSalary" exact="($iFlightTime)Cr*100ct" comment="Salary calc"/>
							<do_if value="$iWPType == 5" comment="Sale to NPC station">
								<set_value name="$iCommission" exact="(($iVolume)ct * ($iUnitPrice - $tWare.minprice))L/100L"/>
								<debug_text text="'Waypoint %1 - Crew earned %2 commission volume = %3 unitprice = %4 minprice = %5'.[$iWPCount, $iCommission, $iVolume, $iUnitPrice, $tWare.minprice]" filter="scripts_verbose" chance="$iDbgVerb"/>
								<do_if value="$iCommission lt 0ct">
									<set_value name="$iCommission" exact="0ct"/>
								</do_if>
							</do_if>
							<do_else>
								<set_value name="$iCommission" exact="0ct"/>
							</do_else>
							<set_value name="$iTotalSalary" exact="$iSalary + $iCommission"/>
							<set_value name="$iXPVol" exact="$iCubicMetres / 10.0"/>
							<set_value name="$iXPoints" exact="(($iTotalSalary)L + ($iXPVol)L)/20L" comment="XP Calc"/>
						</do_if>
						<debug_text text="'Waypoint %1 - Crew earned %2 basic %4 commission each and gained %3 XP each Volume %5 UnitPr %6 XP Vol: %7'.[$iWPCount, $iSalary/1Cr, $iXPoints, $iCommission/1Cr, $iVolume, $iUnitPrice, $iXPVol]" filter="scripts_verbose" chance="$iDbgVerb"/>

						<!-- Individual salary apportionments -->
						<!-- Captain - always gets 100% of salary -->
						<do_if value="true">
							<!-- set_value name="$iWageBill" exact="0ct"/ -->
							<set_value name="$iCaptainsWage" exact="$iTotalSalary"/>
							<set_value name="this.$XRCLS.{2}" exact="$tFlyingTime" operation="add"/>
							<set_value name="this.$XRCLS.{3}" exact="$iCaptainsWage" operation="add"/>
							<set_value name="this.$XRCLS.{4}" exact="$iXPoints" operation="add"/>
							<set_value name="this.$XRCLS.{5}" exact="$iXPoints" operation="add" comment="Experience available to spend on training"/>
							<set_value name="$iWageBill" exact="$iCaptainsWage" operation="add"/>
						</do_if>
								
						<!-- DO gets 75% salary -->
						<do_if value="@this.ship.defencenpc.exists" comment="Set values if DO is onboard">
							<set_value name="$iDefenceWage" exact="(($iTotalSalary)f * 0.75)/1ct"/>
							<set_value name="this.ship.defencenpc.$XRCLS.{2}" exact="$tFlyingTime" operation="add"/>
							<set_value name="this.ship.defencenpc.$XRCLS.{3}" exact="$iDefenceWage" operation="add"/>
							<set_value name="this.ship.defencenpc.$XRCLS.{4}" exact="$iXPoints" operation="add"/>
							<set_value name="this.ship.defencenpc.$XRCLS.{5}" exact="$iXPoints" operation="add" comment="Experience available to spend on training"/>
							<set_value name="$iWageBill" exact="$iDefenceWage" operation="add"/>
						</do_if>
						<do_else>
							<set_value name="$iDefenceWage" exact="0ct"/>
						</do_else>
						
						<!-- Engineer gets 50% salary -->
						<do_if value="@this.ship.engineer.exists" comment="Set values if DO is onboard">
							<set_value name="$iEngineerWage" exact="(($iTotalSalary)f * 0.5)/1ct"/>
							<set_value name="this.ship.engineer.$XRCLS.{2}" exact="$tFlyingTime" operation="add"/>
							<set_value name="this.ship.engineer.$XRCLS.{3}" exact="$iEngineerWage" operation="add"/>
							<set_value name="this.ship.engineer.$XRCLS.{4}" exact="$iXPoints" operation="add"/>
							<set_value name="this.ship.engineer.$XRCLS.{5}" exact="$iXPoints" operation="add" comment="Experience available to spend on training"/>
							<set_value name="$iWageBill" exact="$iEngineerWage" operation="add"/>
						</do_if>
						<do_else>
							<set_value name="$iEngineerWage" exact="0ct"/>
						</do_else>

						<!-- Set ship stats -->
						<set_value name="global.$XRCLS.$lTradeShips.{$iShipIndex}.{9}.{1}" exact="$tFlyingTime" operation="add"/>
						<set_value name="global.$XRCLS.$lTradeShips.{$iShipIndex}.{9}.{3}" exact="$iCubicMetres" operation="add"/>
						<set_value name="global.$XRCLS.$lTradeShips.{$iShipIndex}.{9}.{4}" exact="($iVolume)ct * $iUnitPrice" operation="add"/>

						<debug_text text="'Waypoint %1 - Captain: %2 ,  DO: %3 ,  Engineer:  %4  Total Wage Bill: %5'.[$iWPCount, $iCaptainsWage/1Cr, $iDefenceWage/1Cr, $iEngineerWage/1Cr, $iWageBill/1Cr]" filter="scripts_verbose" chance="$iDbgVerb"/>
						<debug_text text="'Waypoint %1 - Captain cuml: %2 ,  DO cuml: %3 ,  Engineer cuml:  %4'.[$iWPCount, this.$XRCLS.{3}/1Cr, this.ship.defencenpc.$XRCLS.{3}/1Cr, this.ship.engineer.$XRCLS.{3}/1Cr ]" filter="scripts_verbose" chance="$iDbgVerb"/>
						<debug_text text="'Waypoint %1 - Captain XP: %2 ,  DO XP: %3 ,  Engineer XP:  %4'.[$iWPCount, this.$XRCLS.{4}, this.ship.defencenpc.$XRCLS.{4}, this.ship.engineer.$XRCLS.{4}]" filter="scripts_verbose" chance="$iDbgVerb"/>
						<debug_text text="'Waypoint %1 - Ship Stats:  Flying Time %2 - Total Time %3 - Volume %4 - turnover %5'.[$iWPCount, global.$XRCLS.$lTradeShips.{$iShipIndex}.{9}.{1}, global.$XRCLS.$lTradeShips.{$iShipIndex}.{9}.{2}, global.$XRCLS.$lTradeShips.{$iShipIndex}.{9}.{3}, global.$XRCLS.$lTradeShips.{$iShipIndex}.{9}.{4}]" filter="scripts_verbose" chance="$iDbgVerb"/>

						<!-- [player.age, id(wp-complete = 1), traderetarg, ship, hb, wptype, trade-station, ware, amount, unitprice, captsal, dosal, engsal, XP, flighttime] -->
						<set_value name="$lCapLogMsg" exact="[player.age, 1, $aTradeRetArg, this.ship, $oHomebase, $iWPType, $oStation, $tWare, $iVolume, $iUnitPrice, 
															$iCaptainsWage, $iDefenceWage, $iEngineerWage, $iXPoints, $tFlyingTime, '', $iWPCount]"/>
						<set_value name="global.$XRCLS.$lTradeShips.{$iShipIndex}.{7}.{1}" exact="$lCapLogMsg" operation="insert"/>
					</do_if>

					<!-- Conditional on Tracking variable in ships log + add 50 entry limit -->
					<set_value name="$bTrack" exact="global.$XRCLS.$lTradeShips.{$iShipIndex}.{14} gt 0"/>
					<set_value name="$lLogEntry" exact="[]"/>
					<do_if value="$bTrack">
						<set_value name="$idx" exact="1" operation="add"/>
						<set_value name="$lLogEntry" exact="[player.age, 2, $aTradeRetArg, this.ship, $oHomebase, $iWPType, $oStation, $tWare, $iVolume, $iUnitPrice, 
															$iCaptainsWage, $iDefenceWage, $iEngineerWage, $iXPoints, $tFlyingTime, $idx, $iWPCount]"/>
						<set_value name="this.$XRCLS.{6}.{1}" exact="$lLogEntry" operation="insert" comment="Track log entry"/>
						<do_if value="this.$XRCLS.{6}.count gt 50">
							<remove_value name="this.$XRCLS.{6}.{51}" comment="Keep the list at 50 entries long"/>
						</do_if>
					</do_if>
					<remove_value name="$bTrack"/>
					<remove_value name="$lLogEntry"/>

					<debug_text text="'Waypoint %1 - Captain XP: %2 ,  DO XP: %3 ,  Engineer XP:  %4'.[$iWPCount, this.$XRCLS.{4}, this.ship.defencenpc.$XRCLS.{4}, this.ship.engineer.$XRCLS.{4}]" filter="scripts_verbose" chance="$iDbgVerb"/>
					<debug_text text="'Waypoint %1 - Ship Stats:  Flying Time %2 - Total Time %3 - Volume %4 - turnover %5'.[$iWPCount, global.$XRCLS.$lTradeShips.{$iShipIndex}.{9}.{1}, global.$XRCLS.$lTradeShips.{$iShipIndex}.{9}.{2}, global.$XRCLS.$lTradeShips.{$iShipIndex}.{9}.{3}, global.$XRCLS.$lTradeShips.{$iShipIndex}.{9}.{4}]" filter="scripts_verbose" chance="$iDbgVerb"/>

					<!-- Increment our waypoint counter -->
					<set_value name="$iWPCount" operation="add" comment="Increment by 1"/>
					<set_value name="$lWaypoints" exact="$lTradeDetails.{4}" comment="Get our list of waypoints again in case it's been updated"/>
					
					<!-- debug level switchable delay -->
					<do_if value="$bShipDbg gt 3">
						<set_value name="$iWPDelay" exact="10s"/>
					</do_if>
					<do_else>
						<set_value name="$iWPDelay" exact="25s - (3s * (this.skill.navigation)s)"/>
					</do_else>
					<wait exact="$iWPDelay" sinceversion="1" comment="Set this wait time based on crew skills"/>
				</do_while>

				<do_if value="$bShipDbg gt 3">
					<set_value name="$iWPDelay" exact="10s"/>
				</do_if>
				<do_else>
					<set_value name="$iWPDelay" exact="110s - (15s * (this.skill.navigation)s)"/>
				</do_else>
				<wait exact="$iWPDelay" sinceversion="1" comment="Set this wait time based on crew skills"/>

				<!-- Pay wages - Subtract total from station account here and deal with not being able to pay -->
				<!-- Add delay here so that wages are only paid every 30 minutes -->
				<do_if value="$oHomebase.controlentity.{entitytype.manager}.money ge $iWageBill and not $bStaffOnStrike">
					<set_value name="$bStaffOnStrike" exact="false"/>
					<do_if value="(player.age - $tLastWageRun) gt 1800s" comment="Pay wages every 30 mins">
						<do_if value="$iWageBill gt 0ct">
							<debug_text text="'Paying wages for this sweep %1'.[$iWageBill/1Cr]" filter="scripts_verbose" chance="$iDbgVerb"/>
							<transfer_money from="$oHomebase.controlentity.{entitytype.manager}" to="player.entity" amount="$iWageBill"/>
							<reward_player money="- $iWageBill" comment="Workaround as cant find another way to reduce station budget"/>
							<set_value name="$tLastWageRun" exact="player.age"/>
						</do_if>
						<do_else comment="Nothing to pay this time">
							<debug_text text="'Wage bill for this period is zero'" filter="scripts_verbose" chance="$iDbgVerb"/>
						</do_else>
					</do_if>
					<do_else comment="Not time to pay wages yet">
						<debug_text text="'Wage bill %1 is not yet due. Due in %2 minutes'.[$iWageBill/1Cr, (1800s - (player.age - $tLastWageRun))/1min]" filter="scripts_verbose" chance="$iDbgVerb"/>
					</do_else>
				</do_if>
				<do_else comment="Can't pay staff so they go on stop">
					<set_value name="$bStaffOnStrike" exact="true"/>
					<set_value name="$iAmountOwed" exact="$iWageBill"/>
					<set_value name="$iWageBill" exact="0ct"/>
				</do_else>

				<do_if value="$bIsNullSweep">
					<set_value name="$iNullSweepCounter" exact="1" operation="add"/>
					<set_value name="$bIsNullSweep" exact="false" comment="Reset for next sweep"/>
					<!-- Make sure we undock first so that we don't hog a docking slot - only do this on a null sweep so we don't undock if two trades at the same station -->
					<do_if value="this.ship.parkedat.exists" comment="If we are parked">
						<debug_text text="'We got a null WP sweep so undock'" filter="scripts_verbose" chance="$iDbgVerb"/>
						<run_script name="'move.unpark'" sinceversion="1"/>					
					</do_if>
					<do_if value="$iNullSweepCounter gt 5">
						<debug_text text="'Longer wait due to 5 null sweeps of the waypoint list'" filter="scripts_verbose" chance="$iDbgVerb"/>
						<set_value name="$iNullSweepCounter" exact="0"/>
						<!-- debug level switchable delay -->
						<do_if value="$bShipDbg gt 3">
							<set_value name="$iWPDelay" exact="10s"/>
						</do_if>
						<do_else>
							<set_value name="$iWPDelay" exact="300s - (50s * (this.skill.navigation)s)"/>
						</do_else>
						<wait exact="$iWPDelay" sinceversion="1" comment="Set this wait time based on crew skills"/>
						<!-- Fly back to homebase here to avoid possibility of hanging about in dangerous space for too long -->
						<set_value name="$aTradeRetArg"		exact="'WP_NULLSWEEP_FLYING'"/>
						<set_value name="$bTrack" exact="global.$XRCLS.$lTradeShips.{$iShipIndex}.{14} gt 0"/>
						<set_value name="$lLogEntry" exact="[]"/>
						<do_if value="$bTrack">
							<set_value name="$idx" exact="1" operation="add"/>
							<set_value name="$lLogEntry" exact="[player.age, 2, $aTradeRetArg, this.ship, $oHomebase, $iWPType, $oStation, $tWare, $iVolume, $iUnitPrice, 
															$iCaptainsWage, $iDefenceWage, $iEngineerWage, $iXPoints, $tFlyingTime, $idx, $iWPCount]"/>
							<set_value name="this.$XRCLS.{6}.{1}" exact="$lLogEntry" operation="insert" comment="Track log entry"/>
							<do_if value="this.$XRCLS.{6}.count gt 50">
								<remove_value name="this.$XRCLS.{6}.{51}" comment="Keep the list at 50 entries long"/>
							</do_if>
						</do_if>
						<remove_value name="$bTrack"/>
						<remove_value name="$lLogEntry"/>
						<debug_text text="'Null sweep timeout - flying back to homebase'" filter="scripts_verbose" chance="$iDbgVerb"/>
						<do_if value="this.ship.distanceto.[$oHomebase, position.[0,0,0]] lt 10km" comment="Range check to prevent this constantly flying about">
							<debug_text text="'Close enough to Homebase %1 so no need to move'.[$oHomebase.knownname]" filter="scripts_verbose" chance="$iDbgVerb"/>
							<set_value name="$aTradeRetArg"		exact="'WP_NULLSWEEP_NOFLY'"/>
						</do_if>
						<do_else>
							<run_script name="'move.generic'" sinceversion="1">
								<param name="destination" value="$oHomebase"/>
								<param name="debugchance" value="$iDbgVerb"/>
							</run_script>
							<debug_text text="'We\'ve arrived at Homebase %1'.[$oHomebase.knownname]" filter="scripts_verbose" chance="$iDbgVerb"/>
							<set_value name="$aTradeRetArg"		exact="'WP_NULLSWEEP_FLY'"/>
						</do_else>
						<!-- Conditional on Tracking variable in ships log + add 50 entry limit -->
						<set_value name="$bTrack" exact="global.$XRCLS.$lTradeShips.{$iShipIndex}.{14} gt 0"/>
						<set_value name="$lLogEntry" exact="[]"/>
						<do_if value="$bTrack">
							<set_value name="$idx" exact="1" operation="add"/>
							<set_value name="$lLogEntry" exact="[player.age, 2, $aTradeRetArg, this.ship, $oHomebase, $iWPType, $oStation, $tWare, $iVolume, $iUnitPrice, 
															$iCaptainsWage, $iDefenceWage, $iEngineerWage, $iXPoints, $tFlyingTime, $idx, $iWPCount]"/>
							<set_value name="this.$XRCLS.{6}.{1}" exact="$lLogEntry" operation="insert" comment="Track log entry"/>
							<do_if value="this.$XRCLS.{6}.count gt 50">
								<remove_value name="this.$XRCLS.{6}.{51}" comment="Keep the list at 50 entries long"/>
							</do_if>
						</do_if>
						<remove_value name="$bTrack"/>
						<remove_value name="$lLogEntry"/>
					</do_if>
				</do_if>
				<do_else comment="No null sweep so carry on">
					<set_value name="$iNullSweepCounter" exact="0"/>
				</do_else>
			<!-- Ends main loop -->
			</do_while>
		</actions>
	</attention>

	<on_abort>
		<!-- TODO: Check do we need to clean up our variables here?? -->
		<debug_text text="'Stopped running script for ship %1'.[$oShip.knownname]" filter="scripts_verbose" chance="$iDbgVerb"/>
		<set_value name="this.$XRCLS.{6}" exact="[]" operation="set" comment="Track log entry delete"/>
		<do_if value="this.ship.exists and this.ship.isoperational" comment="Reporting hook">
			<set_value name="$aTradeRetArg" exact="{150402,451}"/>
			<set_value name="$lCapLogMsg" exact="[player.age, 1, $aTradeRetArg, this.ship, $oHomebase, $iWPType, $oStation, $tWare, $iVolume, $iUnitPrice, 
															$iCaptainsWage, $iDefenceWage, $iEngineerWage, $iXPoints, $tFlyingTime, '', $iWPCount]"/>
			<set_value name="global.$XRCLS.$lTradeShips.{$iShipIndex}.{7}.{1}" exact="$lCapLogMsg" operation="insert"/>
		</do_if>
		<do_else>
			<debug_text text="'Ship is dead %1'.[$oShip.knownname]" filter="scripts_verbose" chance="$iDbgVerb"/>
			<set_value name="$aTradeRetArg" exact="{150402,452}"/>
			<set_value name="$lCapLogMsg" exact="[player.age, 1, $aTradeRetArg, this.ship, $oHomebase, $iWPType, $oStation, $tWare, $iVolume, $iUnitPrice, 
															$iCaptainsWage, $iDefenceWage, $iEngineerWage, $iXPoints, $tFlyingTime, '', $iWPCount]"/>
			<set_value name="global.$XRCLS.$lTradeShips.{$iShipIndex}.{7}.{1}" exact="$lCapLogMsg" operation="insert"/>
		</do_else>
	</on_abort>
</aiscript>
<?xml version="1.0" encoding="utf-8"?>
<diff>
	<add sel="/aiscript/attention/actions/do_all/set_value[@name='$subordinate']" pos="after">
		<!-- Stops the newly appointed manager assigning CLS ships to normal station duty -->
		<debug_text  text="'MT Logistics trade.station.player vanilla script patch - subordinate %1'.[$subordinate.name]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)" />
		<do_if value="@$subordinate.pilot.$XRCLS and @$subordinate.pilot.$XRCLS.{1} == true">
			<debug_text  text="'Manager Ignoring Ship - %1 as it is a CLS Ship'.[$subordinate.name]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)" />
			<continue />
		</do_if>
	</add>
</diff>
<?xml version="1.0" encoding="utf-8"?>
<content id="ws_383547458" name="MitchTech Station Logistics" description="Facilitates CLS style ships for player stations" author="wysiwyg" version="101" date="2015-01-30" save="false">
  <dependency version="300"></dependency>
  <text language="44" name="MitchTech Station Logistics" description="Facilitates CLS style ships for player stations" author="wysiwyg" />
</content>
<?xml version="1.0" encoding="utf-8"?>
<!-- MT Station Logistics -->
<!-- Version 1.0 - 2014-12-06 -->
<!-- This MD script handles the main functions and admin of the mod -->
<!--  mdscript name="XRCLS" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="md.xsd" -->
<mdscript name="XRCLS" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="C:\Users\andy\Dropbox (Personal)\Games\XRebirth\modwip\Resources\md.xsd">
	<cues>
		<!-- Initialise the mod on game start and on a new game -->
		<cue name="Initialise" instantiate="false" namespace="this">
			<conditions>
				<check_any>
					<!-- Will fire once on every game load, but not on new game -->
					<event_player_created />
					<!-- Will fire as long as game is less than 20 seconds old -->
					<event_cue_signalled cue="md.Setup.GameStart" />
				</check_any>
			</conditions>
			<actions>
				<!-- Set the mod name "MT Station Logitics" -->
				<set_value name="$sName" exact="{150402,1}" />

				<!-- Version number -->
				<set_value name="$iMajVer" exact="1" />
				<set_value name="$iMinVer" exact="0" />
				<set_value name="$iBugfixVer" exact="1" />
        
				<!-- Create a mod config descriptors container if it doesn't exist -->
				<do_if value="not global.$XRCLS?">
					<create_cue_actor name="$dConfig" cue="md.XRCLS.DescriptorsContainer" />
					<set_value name="global.$XRCLS" exact="$dConfig" />
				</do_if>
				<do_else>
					<!-- It does exist so load it -->
					<set_value name="$dConfig" exact="global.$XRCLS" />
				</do_else>
				
				<!-- Mod debug level -->
				<!-- Set the global debug level here (0 - Error; 1 - Info; 2 - Fine; 3 - Finest) -->
				<set_value name="$dConfig.$iDebugLevel" exact="0" />
				<debug_text text="{150402,9994}.[$sName,$dConfig.$iDebugLevel]" filter="scripts_verbose" chance="100 * ($dConfig.$iDebugLevel ge 1)" />
			
				<!-- Signal the initialisation cue -->
				<signal_cue_instantly cue="md.XRCLS.GenericInit" param="[$sName,$dConfig,$iMajVer,$iMinVer,$iBugfixVer]" />

				<!-- Initialise various lists used in the mod -->
				<do_if value="not global.$XRCLS.$lTradeShips?">
					<set_value name="global.$XRCLS.$lTradeShips" exact="[]"/>			<!-- Add a new empty trader fleet list -->
				</do_if>

				<do_if value="not global.$XRCLS.$lAdminLog?">
					<set_value name="global.$XRCLS.$lAdminLog" exact="[]"/>				<!-- Add a new empty admin log list -->
				</do_if>

				<!-- THESE TO BE DEPRACATED -->
				<do_if value="not global.$XRCLS.$lActiveTradeShips?">					<!-- Add a check for first time initialisation of the trader list -->
					<set_value name="global.$XRCLS.$lActiveTradeShips" exact="[]"/>		<!-- Add a new empty trader fleet list -->
				</do_if>
				<do_if value="not global.$XRCLS.$lInactiveTradeShips?">					<!-- Add a check for first time initialisation of the inactive trader list -->
					<set_value name="global.$XRCLS.$lInactiveTradeShips" exact="[]"/>	<!-- Add a new empty inactive trader fleet list -->
				</do_if>
				<!-- THESE TO BE DEPRACATED -->


				<do_if value="not global.$XRCLS.$lConfiguredNPCs?">						<!-- Check if we have a list of configured NPCs set up -->
					<set_value name="global.$XRCLS.$lConfiguredNPCs" exact="[]"/>		<!-- Add one if not -->
				</do_if>
				<do_if value="not global.$XRCLS.$lExpandStates?">
					<set_value name="global.$XRCLS.$lExpandStates" exact="[]"/>			<!-- Add a check for first time initialisation of the menu expand states -->
					<set_value name="global.$XRCLS.$lExpandStates.{1}" exact="[0, 0, [null, null]]"/>	<!-- Add a new closed list for the ship select menu -->
					<set_value name="global.$XRCLS.$lExpandStates.{2}" exact="[null, null]"/>			<!-- Add a new closed list for the Reports menu -->
				</do_if>

				<!-- DEPRACATE: Log to be in trader variable. set up list for trader logging -->
				<do_if value="not global.$XRCLS.$lTraderLog?">
					<set_value name="global.$XRCLS.$lTraderLog" exact="[]"/>
				</do_if>
				<!-- DEPRACATE -->
				
				<!-- Finally, we reset the cue so that it will trigger again on next game load -->
				<reset_cue cue="this" />
			</actions>
		</cue>	

		<!--	Generic mod initialisation cue.
				It expects parameters in the following form:
				event.param.{1} - name of the mod
				event.param.{2} - the config container of the mod
				event.param.{3} - major version number
				event.param.{4} - minor version number
				event.param.{5} - bugfix version number
		-->
		<cue name="GenericInit" instantiate="true" namespace="this">
			<conditions>
				<event_cue_signalled />
			</conditions>
			<actions>
				<set_value name="$sName" exact="event.param.{1}" />
				<set_value name="$dConfig" exact="event.param.{2}" />

				<!-- Library version number -->
				<set_value name="$iMajVer" exact="event.param.{3}" />
				<set_value name="$iMinVer" exact="event.param.{4}" />
				<set_value name="$iBugfixVer" exact="event.param.{5}" />
				<set_value name="$sVersion" exact="'%1.%2.%3'.[$iMajVer, $iMinVer, $iBugfixVer]" />

				<set_value name="$sInstallMsg" exact="@event.param.{6}" />
				<set_value name="$sUpgradeMsg" exact="@event.param.{7}" />
        
				<!-- Check for version -->
				<do_if value="not $dConfig.$iMajVer?">
					<!-- Write first time installation message to logbook -->
					<write_to_logbook category="general" text="{150402,9997}.[$sName,$sVersion,'']" />
          
					<!-- If an additional installation message was provided, we notify the user -->
					<set_value name="$sCustomMsg" exact="''" />
					<do_if value="$sInstallMsg != null">
						<set_value name="$sCustomMsg" exact="{150402,9992}" />
						<write_to_logbook category="general" text="$sInstallMsg" />
					</do_if>
	
					<!-- Display the message in the center of the screen -->
					<set_value name="$sMsg" exact="{150402,9997}.[$sName,$sVersion,$sCustomMsg]" />
					<show_help force="true" custom="$sMsg" duration="5s" />
				</do_if>
				<do_elseif value="$dConfig.$iMajVer lt $iMajVer or $dConfig.$iMinVer lt $iMinVer or $dConfig.$iBugfixVer lt $iBugfixVer">
					<!-- Write upgrade message to logbook -->
					<write_to_logbook category="general" text="{150402,9998}.[$sName,$dConfig.$sVersion,$sVersion,'']" />
          
					<!-- If an additional update message was provided, notify the user -->
					<set_value name="$sCustomMsg" exact="''" />
					<do_if value="$sUpgradeMsg != null">
						<set_value name="$sCustomMsg" exact="{150402,9992}" />
						<write_to_logbook category="general" text="$sUpgradeMsg" />
					</do_if>
          
					<!-- Display the message in the center of the screen -->
					<set_value name="$sMsg" exact="{150402,9998}.[$sName,$dConfig.$sVersion,$sVersion,$sCustomMsg]" />
					<show_help force="true" custom="$sMsg" duration="10s" />
				</do_elseif>
				<do_elseif value="$dConfig.$iMajVer gt $iMajVer or $dConfig.$iMinVer gt $iMinVer or $dConfig.$iBugfixVer gt $iBugfixVer">
					<!-- Show warning for downgrade -->
					<show_help force="true" custom="{150402,9996}.[$sName,$dConfig.$sVersion,$sVersion]" duration="5s" />
					<write_to_logbook category="general" text="{150402,9996}.[$sName,$dConfig.$sVersion,$sVersion]" />
				</do_elseif>

				<!-- Save the version to the config container -->
				<set_value name="$dConfig.$iMajVer" exact="$iMajVer" />
				<set_value name="$dConfig.$iMinVer" exact="$iMinVer" />
				<set_value name="$dConfig.$iBugfixVer" exact="$iBugfixVer" />
				<set_value name="$dConfig.$sVersion" exact="$sVersion" />
				
				<!-- Turn this on and off using debug level < 1 -->
				<write_to_logbook category="general" text="{150402,9993}.[$sName,$dConfig.$sVersion]" chance="100 * ($dConfig.$iDebugLevel ge 1)" />
				<show_help force="true" custom="{150402,9993}.[$sName,$dConfig.$sVersion]" duration="5s" chance="100 * ($dConfig.$iDebugLevel ge 1)" />
        
				<!-- Reset the cue for clean-up -->
				<reset_cue cue="this" />
			</actions>
		</cue>

		<!-- 	Generic cue to handle un-installation of mods. -->
		<cue name="GenericUninst" instantiate="true" namespace="this">
			<conditions>
				<event_cue_signalled />
			</conditions>
			<actions>
				<set_value name="$sName" exact="event.param.{1}" />
				<set_value name="$dConfig" exact="event.param.{2}" />
				<set_value name="$iMajVer" exact="$dConfig.$iMajVer" />
				<set_value name="$iMinVer" exact="$dConfig.$iMinVer" />
				<set_value name="$iBugfixVer" exact="$dConfig.$iBugfixVer" />
				<set_value name="$sVersion" exact="'%1.%2.%3'.[$iMajVer,$iMinVer,$iBugfixVer]" />

				<set_value name="$sUninstallMsg" exact="@event.param.{3}" />
        
				<!-- Write uninstallation message to logbook -->
				<write_to_logbook category="general" text="{150402,9995}.[$sName,$sVersion,'']" />

				<!-- If an additional installation message was provided, we notify the user -->
				<set_value name="$sCustomMsg" exact="''" />
				<do_if value="$sUninstallMsg != null">
					<set_value name="$sCustomMsg" exact="{150402,9992}" />
					<write_to_logbook category="general" text="$sUninstallMsg" />
				</do_if>

				<!-- Lastly, we display the message in the center of the screen -->
				<debug_text filter="scripts_verbose" text="'Uninstalling MT Mod Library - version %1...'.[$sVersion]" chance="100 * (global.$XRCLS.$iDebugLevel ge 1)" />
				<set_value name="$sMsg" exact="{150402,9995}.[$sName,$sVersion,$sCustomMsg]" />
				<show_help force="true" custom="$sMsg" duration="10s" />
			</actions>
		</cue>

		<!-- 	Cue to uninstall the Mod -->
		<cue name="Uninstall" instantiate="true" namespace="this">
			<conditions>
				<event_cue_signalled />
			</conditions>
			<actions>
				<signal_cue_instantly cue="md.XRCLS.GenericUninst" param="[{150402,1},global.$XRCLS]" />
				<!-- stop all trading ships -->
				<do_all exact="global.$XRCLS.$lTradeShips.count" counter="$i">
					<do_if value="global.$XRCLS.$lTradeShips.{$i}.{8} gt 0">
						<signal_cue_instantly cue="md.Manage_MT_Logistics.StopCLStrader" param="global.$XRCLS.$lTradeShips.{$i}"/>
						<debug_text text="'Stopping ship %1'.[global.$XRCLS.$lTradeShips.{$i}.{1}.knownname]" filter="error" chance="100 * (global.$XRCLS.$iDebugLevel ge 0)" />
					</do_if>
				</do_all>
				<!-- Remove stuff from NPCs -->
				<do_all exact="global.$XRCLS.$lConfiguredNPCs.count" counter="$i">
					<set_value name="$eEntity" exact="global.$XRCLS.$lConfiguredNPCs.{$i}"/>
					<remove_value name="$eEntity.$XRCLS"/>
					<debug_text text="'Removing variable from %1'.[$eEntity.knownname]" filter="error" chance="100 * (global.$XRCLS.$iDebugLevel ge 0)" />
				</do_all>
				<remove_cue_actor actor="global.$XRCLS" cue="md.XRCLS.DescriptorsContainer" />
				<remove_value name="global.$XRCLS" />
			</actions>
		</cue>

		<!--	Cue to create descriptors for a given entity. Descriptors are represented
				by creating a virtual actor and using its blackboard to store the values. -->
		<cue name="DescriptorsFactory" instantiate="true" namespace="this">
			<conditions>
				<event_object_signalled object="player.primaryship" param="'XRCLS_CreateDescriptor'" />
			</conditions>
			<actions>
				<set_value name="$oEntity" exact="event.param2" />
				<debug_text text="'Creating descriptors for entity \'%1\'...'.[$oEntity.knownname]" filter="error" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)" />

				<create_cue_actor name="$dDesc" cue="DescriptorsContainer" />

				<!-- Set the result -->
				<set_value name="$oEntity.$dXRCLS_CreateDescriptorResult" exact="$dDesc" />
			</actions>
		</cue>
	
		<!--	Cue to dispose a given descriptor/virtual actor. -->
		<cue name="DescriptorsDisposer" instantiate="true" namespace="this">
			<conditions>
				<event_object_signalled object="player.primaryship" param="'XRCLS_DisposeDescriptor'" />
			</conditions>
			<actions>
				<set_value name="$dDesc" exact="event.param2" />
				<debug_text text="'Disposing descriptor/virtual actor \'%1\'...'.[$dDesc.knownname]" filter="error" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)" />
				<remove_cue_actor cue="DescriptorsContainer" actor="$dDesc" />
			</actions>
		</cue>

		<!-- 	This cue is responsible for storing all created descriptors globally. -->
		<cue name="DescriptorsContainer" instantiate="false" namespace="static">
			<conditions>
				<check_any>
					<!-- Will fire once on every game load, but not on new game -->
					<event_player_created />
					<!-- Will fire as long as game is less than 20 seconds old -->
					<event_cue_signalled cue="md.Setup.GameStart" />
				</check_any>
			</conditions>
		</cue>
	
	</cues>
</mdscript>
<?xml version="1.0" encoding="utf-8"?>
<!-- MT Station Logistics -->
<!-- Version 1.0 - 2015-01-10 -->
<!-- This MD script handles interaction with player ships assigned to CLS duty -->
<!-- mdscript name="Manage_MT_Logistics" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="md.xsd" -->
<mdscript name="Manage_MT_Logistics" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="C:\Users\andy\Dropbox (Personal)\Games\XRebirth\modwip\Resources\md.xsd">
	<cues>
		<!-- This cue starts a ship trading -->
		<cue name="StartCLStrader" instantiate="true" namespace="this">
			<conditions>
				<event_cue_signalled/>
			</conditions>
			<actions>
				<set_value name="$lTradeDetails" exact="event.param"/>
				<set_value name="$oShip" exact="$lTradeDetails.{1}"/>
				<set_value name="$oHomebase" exact="$lTradeDetails.{2}"/>
				<debug_text text="'Fired cue to start trading with ship %1'.[$oShip.name]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/>
				<!-- Get station commander and set our ship to be assigned to the homebase station -->
				<set_value name="$oManager" exact="$oHomebase.controlentity.{entitytype.manager}"/>

				<set_value name="$eCaptain" exact="$oShip.pilot"/>
				<!-- Mark our Captain as a current XRCLS captain so that a new station manager knows to ignore the ship -->
				<!-- We mark the npc so that we can save their individual progress for promotion etc -->
				<do_if value="@$eCaptain">
					<do_if value="not $eCaptain.$XRCLS?">														<!-- Check if Captain is already configured -->
						<set_value name="$eCaptain.$XRCLS" exact="[true, 0s, 0ct, 0L, 0L,[]]"/>				<!-- Not configured so add a new configuration record -->
						<!-- [active(boolean), hours logged(int), salary(int), experience(int), xp not spent, log(list) -->
						<!-- Now add our captain to our list of configured NPCs -->
						<append_to_list name="global.$XRCLS.$lConfiguredNPCs" exact="$eCaptain"/>
					</do_if>
					<do_else>																					<!-- Already configured so just set to active -->
						<set_value name="$eCaptain.$XRCLS.{1}" exact="true" operation="set"/>
					</do_else>
				</do_if>

				<set_value name="$eDefenceOfficer" exact="$oShip.defencenpc"/>
				<!-- Mark our Defence Officer as a current XRCLS DO -->
				<!-- We mark the npc so that we can save their individual progress for promotion etc -->
				<do_if value="@$eDefenceOfficer">
					<do_if value="not $eDefenceOfficer.$XRCLS?">												<!-- Check if DO is already configured -->
						<set_value name="$eDefenceOfficer.$XRCLS" exact="[true, 0s, 0ct, 0L, 0L,[]]"/>		<!-- Not configured so add a new configuration record -->
						<!-- [active(boolean), hours logged(int), salary(int), experience(int), xp not spent, log(list) -->
						<!-- Now add our DO to our list of configured NPCs -->
						<append_to_list name="global.$XRCLS.$lConfiguredNPCs" exact="$eDefenceOfficer"/>
					</do_if>
					<do_else>																					<!-- Already configured so just set to active -->
						<set_value name="$eDefenceOfficer.$XRCLS.{1}" exact="true" operation="set"/>
					</do_else>
				</do_if>

				<set_value name="$eEngineer" exact="$oShip.engineer"/>
				<!-- Mark our engineer as a current XRCLS engineer -->
				<!-- We mark the npc so that we can save their individual progress for promotion etc -->
				<do_if value="@$eEngineer">
					<do_if value="not $eEngineer.$XRCLS?">
						<!-- Check if Engineer is already configured -->
						<set_value name="$eEngineer.$XRCLS" exact="[true, 0s, 0ct, 0L, 0L,[]]"/>
						<!-- Not configured so add a new configuration record -->
						<!-- [active(boolean), hours logged(int), salary(int), experience(int), xp not spent, log(list) -->
						<!-- Now add our Engineer to our list of configured NPCs -->
						<append_to_list name="global.$XRCLS.$lConfiguredNPCs" exact="$eEngineer"/>
					</do_if>
					<do_else>
						<!-- Already configured so just set to active -->
						<set_value name="$eEngineer.$XRCLS.{1}" exact="true" operation="set"/>
					</do_else>
				</do_if>

				<debug_text text ="'NPC List = %1'.[global.$XRCLS.$lConfiguredNPCs]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)" />
				<set_object_commander object="$oShip" commander="$oHomebase" type="entitytype.manager"/>
				<share_actor_account actor="$oShip.pilot" otherobject="$oManager" transferto="$oManager"/>
				<!-- Start our trading script here -->
				<start_script name="'mt_logistics.trade.ship'" object="$eCaptain">
					<param name="lTradeDetails" value="$lTradeDetails"/>
				</start_script> 
			</actions>
		</cue>

		<!-- This cue stops a ship trading -->
		<cue name="StopCLStrader" instantiate="true" namespace="this">
			<conditions>
				<event_cue_signalled/>
			</conditions>
			<actions>
				<set_value name="$oShip" exact="event.param.{1}"/>
				<debug_text text="'Fired cue to stop trading with ship %1'.[$oShip.name]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/>
				<!-- Set captain to inactive -->
				<set_value name="$eCaptain" exact="$oShip.pilot"/>
				<set_value name="$eDefenceOfficer" exact="$oShip.defencenpc"/>
				<set_value name="$eEngineer" exact="$oShip.engineer"/>
				<do_if value="@$eCaptain">
					<set_value name="$eCaptain.$XRCLS.{1}" exact="false" operation="set"/>
				</do_if>
				<do_if value="@$eDefenceOfficer">
					<set_value name="$eDefenceOfficer.$XRCLS.{1}" exact="false" operation="set"/>
				</do_if>
				<do_if value="@$eEngineer">
					<set_value name="$eEngineer.$XRCLS.{1}" exact="false" operation="set"/>
				</do_if>
				<!-- Remove ship from station command -->
				<remove_object_commander object="$oShip"/>
				<remove_actor_account actor="$oShip.pilot"/>
				<debug_text text ="'NPC List = %1'.[global.$XRCLS.$lConfiguredNPCs]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)" />
				<!-- Stop Running the script here -->
				<abort_scripts entity="$oShip.pilot"/>
			</actions>
		</cue>

		<!-- This cue updates a ship that is already trading -->
		<cue name="UpdateCLStrader" instantiate="true" namespace="this">
			<conditions>
				<event_cue_signalled/>
			</conditions>
			<actions>
				<set_value name="$lNewTradeDetails" exact="event.param"/>
				<set_value name="$oShip" exact="event.param.{1}"/>
				<signal_objects object="$oShip" param="'XRCLS_UpdateWaypoints'" param2="$lNewTradeDetails"/>
				<debug_text text="'Fired cue to update ship %1'.[$oShip.name]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/>
			</actions>
		</cue>

	</cues>
</mdscript>
<?xml version="1.0" encoding="utf-8"?>
<!-- MT Station Logistics -->
<!-- Version 1.0 - 2014-12-06 -->
<!-- This MD script handles all the side bar menu and detailmonitor driven calls -->
<!-- mdscript name="Menu_MT_Logistics" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="md.xsd" -->
<mdscript name="Menu_MT_Logistics" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="C:\Users\andy\Dropbox (Personal)\Games\XRebirth\modwip\Resources\md.xsd">
    <cues>
		<!-- Reports menu handler -->
		<cue name="SectionHandler_ReportsMenu" instantiate="true" namespace="this">
			<conditions>
				<check_any>
					<event_conversation_next_section sectionprefix="gMT_ReportMenu_"/>
					<event_conversation_returned_to_section sectionprefix="gMT_ReportMenu_"/>
				</check_any>
			</conditions>
			<actions>
				<debug_text text="'MTL - Report Menu: param = %1 - param2 = %2 Expand states = %3'.[event.param, event.param2, event.param2.{4}]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/>
				<!-- Return to admin screen -->
				<do_if value="event.param == 'gMT_ReportMenu_back'">
					<!-- Save report menu expand states -->
					<set_value name="global.$XRCLS.$lExpandStates.{2}" exact="event.param2.{4}"/>
					<open_conversation_menu menu="gMT_Station_Logistics_Admin" param="event.param2"/>
					<add_conversation_view view="closeupdetailmonitor"/>
				</do_if>

				<!-- Return from ship log screen -->
				<do_elseif value="event.param == 'gMT_ReportMenu_return'">
					<set_value name="$iShipIdx" exact="event.param2.{7}.{10}"/>
					<set_value name="global.$XRCLS.$lTradeShips.{$iShipIdx}.{14}" exact="0"/>
					<signal_cue_instantly cue="GetShipLists" param="[this]"/>
					<debug_text text="'MTL - Report Menu: XRCLS Crew: %1'.[global.$XRCLS.$lConfiguredNPCs]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/>
					<open_conversation_menu menu="gMT_Station_Logistics_Reports" param="[event.param2.{4}.{1}, event.param2.{4}.{2}, [], event.param2.{4}, $aReturn.{1}, global.$XRCLS.$lConfiguredNPCs, []]"/>
					<add_conversation_view view="closeupdetailmonitor"/>
					<remove_value name="$iShipIdx"/>
				</do_elseif>

				<!-- Return from crew report screens -->
				<do_elseif value="event.param == 'gMT_ReportMenu_returncrew'">
					<signal_cue_instantly cue="GetShipLists" param="[this]"/>
					<debug_text text="'MTL - Report Menu: XRCLS Crew: %1'.[global.$XRCLS.$lConfiguredNPCs]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/>
					<open_conversation_menu menu="gMT_Station_Logistics_Reports" param="[event.param2.{4}.{1}, event.param2.{4}.{2}, [], event.param2.{4}, $aReturn.{1}, global.$XRCLS.$lConfiguredNPCs, []]"/>
					<add_conversation_view view="closeupdetailmonitor"/>
				</do_elseif>

				<!-- Return admin log report screens -->
				<do_elseif value="event.param == 'gMT_ReportMenu_returnadmin'">
					<signal_cue_instantly cue="GetShipLists" param="[this]"/>
					<debug_text text="'MTL - Report Menu: XRCLS Admin: %1'.[global.$XRCLS.$lConfiguredNPCs]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/>
					<open_conversation_menu menu="gMT_Station_Logistics_Reports" param="[event.param2.{4}.{1}, event.param2.{4}.{2}, [], event.param2.{4}, $aReturn.{1}, global.$XRCLS.$lConfiguredNPCs, []]"/>
					<add_conversation_view view="closeupdetailmonitor"/>
				</do_elseif>

				<!-- Toggle ship debug level -->
				<do_elseif value="event.param == 'gMT_ReportMenu_toggleDbg'">
					<set_value name="$oShip" exact="event.param2.{7}.{1}"/>
					<set_value name="$iShipIdx" exact="event.param2.{7}.{10}"/>
					<set_value name="$iNewDbg" exact="event.param2.{3}"/>
					<set_value name="global.$XRCLS.$lTradeShips.{$iShipIdx}.{13}" exact="$iNewDbg"/>
					<debug_text text="'MTL - Report Menu: Debug level: %1'.[global.$XRCLS.$lTradeShips.{$iShipIdx}.{13}]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/>
					<signal_objects object="$oShip" param="'XRCLS_UpdateShipDbgLvl'" param2="$iNewDbg"/>
					<open_conversation_menu menu="gMT_Station_Logistics_ShipLog" param="[event.param2.{4}.{1}, event.param2.{4}.{2}, [], event.param2.{4}, [], [], global.$XRCLS.$lTradeShips.{$iShipIdx}]"/>
					<add_conversation_view view="closeupdetailmonitor"/>
					<remove_value name="$iShipIdx"/>
					<remove_value name="$iNewDbg"/>
				</do_elseif>

				<!-- Toggle ship tracking level -->
				<do_elseif value="event.param == 'gMT_ReportMenu_toggleTracking'">
					<set_value name="$oShip" exact="event.param2.{7}.{1}"/>
					<set_value name="$iShipIdx" exact="event.param2.{7}.{10}"/>
					<set_value name="$iNewTrk" exact="event.param2.{3}"/>
					<set_value name="global.$XRCLS.$lTradeShips.{$iShipIdx}.{14}" exact="$iNewTrk"/>
					<debug_text text="'MTL - Report Menu: Debug level: %1'.[global.$XRCLS.$lTradeShips.{$iShipIdx}.{14}]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/>
					<signal_objects object="$oShip" param="'XRCLS_UpdateShipTrkLvl'" param2="$iNewTrk"/>
					<open_conversation_menu menu="gMT_Station_Logistics_ShipLog" param="[event.param2.{4}.{1}, event.param2.{4}.{2}, [], event.param2.{4}, [], [], global.$XRCLS.$lTradeShips.{$iShipIdx}]"/>
					<add_conversation_view view="closeupdetailmonitor"/>
					<remove_value name="$iShipIdx"/>
					<remove_value name="$iNewTrk"/>
				</do_elseif>

				<!-- Update the tracking display -->
				<do_elseif value="event.param == 'gMT_ReportMenu_updateTracking'">
					<set_value name="$iShipIdx" exact="event.param2.{7}.{10}"/>
					<debug_text text="'MTL - Report Menu: Debug level: %1'.[global.$XRCLS.$lTradeShips.{$iShipIdx}.{14}]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/>
					<open_conversation_menu menu="gMT_Station_Logistics_ShipLog" param="[event.param2.{4}.{1}, event.param2.{4}.{2}, [], event.param2.{4}, [], [], global.$XRCLS.$lTradeShips.{$iShipIdx}]"/>
					<add_conversation_view view="closeupdetailmonitor"/>
					<remove_value name="$iShipIdx"/>
				</do_elseif>

				<!-- Show ship report screen -->
				<do_elseif value="event.param == 'gMT_ReportMenu_shiplog'">
					<set_value name="$lAdminLog" exact="global.$XRCLS.$lAdminLog"/>
					<set_value name="$lParam2" exact="event.param2"/>
					<append_to_list name="$lParam2" exact="$lAdminLog"/>
					<open_conversation_menu menu="gMT_Station_Logistics_ShipLog" param="$lParam2"/>
					<add_conversation_view view="closeupdetailmonitor"/>
				</do_elseif>

				<!-- Show admin log report screen -->
				<do_elseif value="event.param == 'gMT_ReportMenu_adminlog'">
					<set_value name="$lAdminLog" exact="global.$XRCLS.$lAdminLog"/>
					<set_value name="$lParam2" exact="event.param2"/>
					<append_to_list name="$lParam2" exact="$lAdminLog"/>
					<open_conversation_menu menu="gMT_Station_Logistics_AdminLog" param="$lParam2"/>
					<add_conversation_view view="closeupdetailmonitor"/>
				</do_elseif>

				<!-- Train a crew member -->
				<do_elseif value="event.param == 'gMT_ReportMenu_train'">
					<set_value name="$oEntity" exact="event.param2.{3}.{2}"/>
					<set_value name="$tSkillType" exact="skilltype.{event.param2.{5}.{7}}"/>
					<set_value name="$iMoney" exact="event.param2.{5}.{3}"/>
					<set_value name="$iXP" exact="event.param2.{5}.{4}"/>
					<!-- Add the skill -->
					<add_skill entity="$oEntity" type="$tSkillType" exact="1"/>
					<!-- Reduce player cash -->
					<reward_player money="- $iMoney"/>
					<!-- reduce available entity XP to spend -->
					<set_value name="$oEntity.$XRCLS.{5}" exact="$iXP" operation="subtract"/>
					<!-- Return to skills menu -->
					<open_conversation_menu menu="gMT_Station_Logistics_CrewLog" param="event.param2"/>
					<add_conversation_view view="closeupdetailmonitor"/>
					<!-- Clean up-->
					<remove_value name="$oEntity"/>
					<remove_value name="$tSkillType"/>
					<remove_value name="$iMoney"/>
					<remove_value name="$iXP"/>
				</do_elseif>

				<!-- Rename a crew member -->
				<do_elseif value="event.param == 'gMT_ReportMenu_rename'">
					<open_conversation_menu menu="gMT_Station_Logistics_Rename" param="event.param2"/>
					<add_conversation_view view="closeupdetailmonitor"/>
				</do_elseif>

				<!-- Return from Rename a crew member -->
				<do_elseif value="event.param == 'gMT_ReportMenu_rename_return'">
					<open_conversation_menu menu="gMT_Station_Logistics_CrewLog" param="event.param2"/>
					<add_conversation_view view="closeupdetailmonitor"/>
				</do_elseif>

				<!-- Test increase XP -->
				<do_elseif value="event.param == 'gMT_ReportMenu_testxp'">
					<set_value name="$oEntity" exact="event.param2.{3}.{2}"/>
					<set_value name="$tSkillType" exact="skilltype.{event.param2.{5}.{7}}"/>
					<set_value name="$iMoney" exact="event.param2.{5}.{3}"/>
					<set_value name="$iXP" exact="event.param2.{5}.{4}"/>
					<set_value name="$oEntity.$XRCLS.{4}" exact="1000000" operation="add"/>
					<set_value name="$oEntity.$XRCLS.{5}" exact="1000000" operation="add"/>

					<!-- Return to skills menu -->
					<open_conversation_menu menu="gMT_Station_Logistics_CrewLog" param="event.param2"/>
					<add_conversation_view view="closeupdetailmonitor"/>
					<!-- Clean up-->
					<remove_value name="$oEntity"/>
					<remove_value name="$tSkillType"/>
					<remove_value name="$iMoney"/>
					<remove_value name="$iXP"/>
				</do_elseif>

				<!-- Crew training/log screen -->
				<do_elseif value="event.param == 'gMT_ReportMenu_crewskills'">
					<open_conversation_menu menu="gMT_Station_Logistics_CrewLog" param="event.param2"/>
					<add_conversation_view view="closeupdetailmonitor"/>
				</do_elseif>
				
				<!-- Unhandled return event -->
				<do_else>
					<!-- Unhandled section value -->
					<debug_text text="'ERROR: Unhandled Reports menu event: %1'.[event.param]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 1)"/>
				</do_else>

			</actions>			
		</cue>
		
		<!-- Waypoint List menu handler cue -->
		<cue name="SectionHandler_WaypointListMenu" instantiate="true" namespace="this">
			<conditions>
				<check_any>
					<event_conversation_returned_to_section sectionprefix="gMT_WPListMenu_"/>
					<event_conversation_next_section sectionprefix="gMT_WPListMenu_"/>
				</check_any>
				<check_value value="global.$XRCLS?" />
			</conditions>
			<actions>
				<debug_text text="'MTL Waypoint List menu: event.param2 = %1'.[event.param2]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/>

				<!-- Call up the edit waypoint screen -->
				<do_if value="event.param == 'gMT_WPListMenu_editwaypoint'">
					<!-- Save temp parameter? -->
					<set_value name="global.$lTempparam2" exact="event.param2"/>
					<!-- get a list of station products if a station is selected -->
					<set_value name ="$lSelectedStation" exact="event.param2.{7}.{3}"/>
					<set_value name="$lWareList" exact="[]"/>
					<do_if value="@$lSelectedStation.exists">
						<set_value name="$lWareList" exact="[$lSelectedStation.resources.list, $lSelectedStation.products.list, $lSelectedStation.tradewares.list]"/>
					</do_if>
					<debug_text text="'Add/edit a waypoint ep2(4): %1 ep2(5) %2  ep2(6) = %3'.[event.param2.{4}, event.param2.{5}, event.param2.{6}]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/>
					<open_conversation_menu menu="gMT_Station_Logistics_EditWaypoint" param="[0, 0, [], event.param2.{4}, [], event.param2.{6}, event.param2.{7}, $lWareList]"/>
					<add_conversation_view view="closeupdetailmonitor"/>
				</do_if>
				
				<!-- deal with return from waypoint edit screen -->
				<do_elseif value="event.param == 'gMT_WPListMenu_return'">
					<!-- Get our return parameters back -->
					<set_value name="$lRet" exact="global.$lTempparam2"/>
					<remove_value name="global.$XRCLS.$tempparam"/>
					<set_value name="$iTopRow" exact="$lRet.{4}.{1}"/>
					<set_value name="$iSelRow" exact="$lRet.{4}.{2}"/>
					<set_value name="$lRet.{4}.{4}" exact="event.param2.{4}.{4}"/>
					<debug_text text="'Done adding/editing waypoint %1'.[$lRet.{4}]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/>
					<open_conversation_menu menu="gMT_Station_Logistics_ListWaypoints" param="[$iTopRow, $iSelRow, [], $lRet.{4}, [], event.param2.{6}, event.param2.{7}]"/>
					<add_conversation_view view="closeupdetailmonitor"/>
					<remove_value name="$lRet"/>
					<remove_value name="$iTopRow"/>
					<remove_value name="$iSelRow"/>
				</do_elseif>
				
				<!-- Unhandled parameter value -->
				<do_else>
					<debug_text text="'Unhandled Waypoint List menu choice... %1'.[event.param]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/>
				</do_else>
				
			</actions>
		</cue>
		
		<!-- Ship select and configure menu screen handler cue -->
		<cue name="SectionHandler_ShipMenu" instantiate="true" namespace="this">
			<conditions>
				<check_any>
					<event_conversation_returned_to_section sectionprefix="gMT_ShipMenu_"/>
					<event_conversation_next_section sectionprefix="gMT_ShipMenu_"/>
				</check_any>
				<check_value value="global.$XRCLS?"/>
			</conditions>
			<actions>
				<!-- Set up some variables -->
				<do_if value="event.param != 'gMT_ShipMenu_back' and event.param != 'gMT_ShipMenu_gothomebase' and event.param != 'gMT_ShipMenu_configreturn' and not @global.$bMapCall">
					<debug_text text="'MTL Ship Menu: Param = %1 - Param2 = %2 Expand state = %3'.[event.param, event.param2, event.param2.{4}.{3}]"/>
					<set_value name="global.$bMapCall" exact="false"/>
					<set_value name="$iTopRow" exact="event.param2.{1}"/>
					<set_value name="$iSelRow" exact="event.param2.{2}"/>
					<set_value name="$lExpand" exact="event.param2.{4}.{3}"/>
					<set_value name="$tAction" exact="event.param2.{4}.{4}"/>
					<set_value name="$lTrader" exact="event.param2.{6}"/>
					<set_value name="$oShip" exact="$lTrader.{1}"/>
					<set_value name="$iShip" exact="$lTrader.{10}"/>
				</do_if>
				
				<!-- Add a brand new, never used before ship -->
				<do_if value="event.param == 'gMT_ShipMenu_addship' and not global.$bMapCall">
					<do_if value="$tAction == 'addship'">
						<debug_text text="'MTL Ship Menu: Ship Data = %1'.[$lTrader]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/>
						<debug_text text="'The new ship selected was:  %1'.[$oShip.knownname]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/>
						<debug_text text="'Trader = %1'.[$lTrader]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/>
						<append_to_list name="global.$XRCLS.$lTradeShips" exact="$lTrader"/>
						<!-- append_to_list name="global.$XRCLS.$lAdminLog" exact="[player.age,'New Trade Ship Added to fleet %1'.[$lTrader.{1}.knownname]]"/ -->
						<signal_cue_instantly cue="WriteLog" param="[true, 'admin', [player.age,{150402, 500}.[$lTrader.{1}.knownname]], null, null]"/>
					</do_if>
					<!-- Sort the ship list out and re-call the ship select menu -->
					<signal_cue_instantly cue="GetShipLists" param="[this]"/>
					<!-- Open the select ship menu -->
					<debug_text text="'Ship Menu: Expand state = %1'.[$lExpand]"/>
					<open_conversation_menu menu="gMT_Station_Logistics_Select_Ship" param="[$iTopRow, $iSelRow, [], [$iTopRow, $iSelRow, $lExpand],  $aReturn.{1}, [], []]"/>
					<add_conversation_view view="closeupdetailmonitor"/>
					<remove_value name="$aReturn"/>
				</do_if>

				<!-- Remove the selected ship if requested -->
				<do_elseif value="event.param == 'gMT_ShipMenu_removeship' and not global.$bMapCall">
					<do_if value="$tAction == 'removeship'">
						<set_value name="$oShipRemove" exact="global.$XRCLS.$lTradeShips.{$iShip}.{1}" comment="for debug text only"/>
						<remove_value name="global.$XRCLS.$lTradeShips.{$iShip}"/>
						<!-- append_to_list name="global.$XRCLS.$lAdminLog" exact="[player.age,'Removed ship from fleet %1'.[$lTrader.{1}.knownname]]"/ -->
						<signal_cue_instantly cue="WriteLog" param="[true, 'admin', [player.age,{150402, 501}.[$lTrader.{1}.knownname]], null, null]"/>
						<debug_text text="'Removed ship: %1 - Global Active: %2'.[$oShipRemove.knownname, global.$XRCLS.$lTradeShips]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/>
					</do_if>
					<!-- Sort the ship list out and re-call the ship select menu -->
					<signal_cue_instantly cue="GetShipLists" param="[this]"/>
					<!-- Open the select ship menu -->
					<open_conversation_menu menu="gMT_Station_Logistics_Select_Ship" param="[$iTopRow, $iSelRow, [], [$iTopRow, $iSelRow, $lExpand], $aReturn.{1}, [], []]"/>
					<add_conversation_view view="closeupdetailmonitor"/>
					<remove_value name="$aReturn"/>
					<remove_value name="$oShipRemove"/>
				</do_elseif>

				<!-- Start a ship trading -->
				<do_elseif value="event.param == 'gMT_ShipMenu_startship' and not global.$bMapCall">
					<do_if value="event.param2.{4}.{4} == 'startship'">
						<debug_text text="'MTL Ship Menu: Started ship: %1  Ship Index = %2'.[$oShip.knownname, $iShip]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/>
						<set_value name="global.$XRCLS.$lTradeShips.{$iShip}.{8}" exact="1" comment="Now Trading"/>
						<!-- append_to_list name="global.$XRCLS.$lTradeShips.{$iShip}.{7}" exact="[player.age,'Started Trading with ship %1'.[$oShip.knownname]]"/ -->
						<signal_cue_instantly cue="WriteLog" param="[true, 'admin', [player.age,{150402, 502}.[$oShip.knownname]], null, null]"/>
						<!-- Need to trigger our trader script here to start the ship doing something -->
						<signal_cue_instantly cue="md.Manage_MT_Logistics.StartCLStrader" param="global.$XRCLS.$lTradeShips.{$iShip}"/>
					</do_if>
					<!-- Sort the ship list out and re-call the ship select menu -->
					<signal_cue_instantly cue="GetShipLists" param="[this]"/>
					<!-- Open the select ship menu -->
					<open_conversation_menu menu="gMT_Station_Logistics_Select_Ship" param="[$iTopRow, $iSelRow, [], event.param2.{4}, $aReturn.{1}, event.param2.{6}]"/>
					<add_conversation_view view="closeupdetailmonitor"/>
					<remove_value name="$aReturn"/>
					<remove_value name="$oShipReadd"/>
				</do_elseif>
				
				<!-- Stop a ship from trading -->
				<do_elseif value="event.param == 'gMT_ShipMenu_stopship' and not global.$bMapCall">
					<do_if value="event.param2.{4}.{4} == 'stopship'">
						<debug_text text="'MTL Ship Menu: Stopped ship: %1  Ship Index %2'.[$oShip.knownname, $iShip]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/>
						<set_value name="global.$XRCLS.$lTradeShips.{$iShip}.{8}" exact="0" comment="Now not Trading"/>
						<!-- append_to_list name="global.$XRCLS.$lTradeShips.{$iShip}.{7}" exact="[player.age,'Stopped Trading with ship %1'.[global.$XRCLS.$lTradeShips.{$iShip}.{1}.knownname]]"/ -->
						<signal_cue_instantly cue="WriteLog" param="[true, 'admin', [player.age,{150402, 503}.[global.$XRCLS.$lTradeShips.{$iShip}.{1}.knownname]], null, null]"/>
						<!-- Stop any XRCLS scripts from running -->
						<signal_cue_instantly cue="md.Manage_MT_Logistics.StopCLStrader" param="global.$XRCLS.$lTradeShips.{$iShip}"/>
					</do_if>
					<!-- Sort the ship list out and re-call the ship select menu -->
					<signal_cue_instantly cue="GetShipLists" param="[this]"/>
					<!-- Open the select ship menu -->
					<open_conversation_menu menu="gMT_Station_Logistics_Select_Ship" param="[$iTopRow, $iSelRow, [], event.param2.{4}, $aReturn.{1}, event.param2.{6}]"/>
					<add_conversation_view view="closeupdetailmonitor"/>
					<remove_value name="$aReturn"/>
				</do_elseif>
				
				<!-- Configure the ship's waypoints (new screen) -->
				<do_elseif value="event.param == 'gMT_ShipMenu_config' and not global.$bMapCall">
					<!-- Save our current return value -->
					<set_value name="global.$lTempParam2" exact="event.param2"/>
					<!-- Now get our ship details -->
					<set_value name="$lTrader" exact="event.param2.{6}"/>
					<open_conversation_menu menu="gMT_Station_Logistics_ListWaypoints" param="[0, 0, [], [$iTopRow, $iSelRow, $lExpand, 'fromshipmenu'], [], $lTrader, []]"/>
					<add_conversation_view view="closeupdetailmonitor"/>
				</do_elseif>
				
				<!-- Deal with return from config menu -->
				<do_elseif value="event.param == 'gMT_ShipMenu_configreturn' and not global.$bMapCall">
					<!-- save our return parameters and restore old value -->
					<debug_text text="'Config return EP2 = %1'.[event.param2]"/>
					<set_value name="$lTrader" exact="event.param2.{6}"/>
					<set_value name="$lRet" exact="global.$lTempParam2"/>
					<remove_value name="global.$lTempParam2"/>
					<set_value name="$iTopRow" exact="$lRet.{1}"/>
					<set_value name="$iSelRow" exact="$lRet.{2}"/>
					<set_value name="$lExpand" exact="$lRet.{4}.{3}"/>
					<set_value name="$tAction" exact="event.param2.{4}.{4}"/>
					<set_value name="$oShip" exact="$lTrader.{1}"/>
					<set_value name="$iShipStatus" exact="$lTrader.{8}"/>
					<set_value name="$iShip" exact="$lTrader.{10}"/>

					<debug_text text="'Ltrader = %1  Action = %2  iShip = %3 Status %4 Debug lvl = %5 Tracking = %6'.[$lTrader, $tAction, $iShip, $iShipStatus, $lTrader.{13}, $lTrader.{14}]"/>

					<do_if value="$tAction == 'updateship'" comment="Only need to do stuff if our waypoint list changed">
						<do_if value="$iShipStatus gt 0" comment="Our ship is actively trading/mining">
							<do_if value="$lTrader.{4}.count lt 2" comment="Ship is active but has less than 2 waypoints so stop it">
								<set_value name="$lTrader.{8}" exact="0" comment="Make ship Inactive"/>
								<!-- append_to_list name="$lTrader.{7}" exact="[player.age,'Updated Waypoints for ship %1 - ship now has less than two waypoints so stopping'.[$lTrader.{1}.knownname]]"/ -->
								<signal_cue_instantly cue="WriteLog" param="[true, 'admin', [player.age,{150402, 504}.[$lTrader.{1}.knownname]], null, null]"/>
								<!-- Signal the ship to stop trading -->
								<signal_cue_instantly cue="md.Manage_MT_Logistics.StopCLStrader" param="$lTrader"/>
							</do_if>
							<do_else comment="All ok so just update">
								<!-- append_to_list name="$lTrader.{7}" exact="[player.age,'Updated Waypoints for ship %1'.[$lTrader.{1}.knownname]]"/ -->
								<signal_cue_instantly cue="WriteLog" param="[true, 'admin', [player.age,{150402, 505}.[$lTrader.{1}.knownname]], null, null]"/>
								<!-- Signal the ship to update its waypoints -->
								<signal_cue_instantly cue="md.Manage_MT_Logistics.UpdateCLStrader" param="$lTrader"/>
							</do_else>
						</do_if>
						<do_else comment="Ship is not actively trading">
							<!-- append_to_list name="$lTrader.{7}" exact="[player.age,'Updated Waypoints for ship %1'.[$lTrader.{1}.knownname]]"/ -->
							<signal_cue_instantly cue="WriteLog" param="[true, 'admin', [player.age,{150402, 505}.[$lTrader.{1}.knownname]], null, null]"/>
						</do_else>
					</do_if>
					
					<!-- Save trader in the global list -->
					<set_value name="global.$XRCLS.$lTradeShips.{$iShip}" exact="$lTrader"/>
					<!-- Sort the ship list out and re-call the ship select menu -->
					<signal_cue_instantly cue="GetShipLists" param="[this]"/>
					<open_conversation_menu menu="gMT_Station_Logistics_Select_Ship" param="[$iTopRow, $iSelRow, [], [$iTopRow, $iSelRow, $lExpand], $aReturn.{1}, [], []]"/>
					<add_conversation_view view="closeupdetailmonitor"/>
					<debug_text text="'Returned from waypoint list......'" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/>
					<remove_value name="$aReturn"/>
					<remove_value name="$lRet"/>
					<remove_value name="$lTrader"/>
					<remove_value name="$tAction"/>
					<remove_value name="$iShip"/>
					<remove_value name="$oShip"/>
				</do_elseif>

				<!-- Get a player station from the map to use as homebase -->
				<do_elseif value="event.param == 'gMT_ShipMenu_gethomebase' and not global.$bMapCall">
					<!-- Need to save stuff here? -->
					<set_value name="global.$lTempParam2" exact="event.param2"/>
					<set_value name="global.$bMapCall" exact="true"/>
					<set_value name="$oShip" exact="event.param2.{6}.{1}"/>
					<debug_text text="'MTL Map Call: event.param2 = %1  Passed expand state = %2'.[event.param2, event.param2.{4}.{3}]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/>
					<!-- open_conversation_menu menu="MapMenu" param="[0, 0, 'zone', player.primaryship.zone, null, null, 'selectplayerobject', ['gMT_ShipMenu_gothomebase', null, false, false, false, true]]"/ -->
					<open_conversation_menu menu="MapMenu" param="[0, 0, 'zone', $oShip.zone, null, null, 'selectplayerobject', ['gMT_ShipMenu_gothomebase', event.object.ship, null, false, false, false, true, null, null, null, null, null, null, null, true]]"/>
					<add_conversation_view view="closeupdetailmonitor"/>
				</do_elseif>
				
				<!-- Deal with the homebase selected -->
				<do_elseif value="event.param == 'gMT_ShipMenu_gothomebase'">
					<debug_text text="'IN MAP RETURN SECTION.......event.param2 = %1'.[event.param2]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/>
					<set_value name="$lRet" exact="global.$lTempParam2"/>
					<set_value name="global.$bMapCall" exact="false"/>
					<remove_value name="global.$lTempParam2"/>
					<set_value name="$iTopRow" exact="$lRet.{1}"/>
					<set_value name="$iSelRow" exact="$lRet.{2}"/>
					<set_value name="$lExpand" exact="$lRet.{4}.{3}"/>
					<set_value name="$tAction" exact="$lRet.{4}.{4}"/>
					<set_value name="$lTrader" exact="$lRet.{6}"/>
					<set_value name="$oShip" exact="$lTrader.{1}"/>
					<set_value name="$iShip" exact="$lTrader.{10}"/>

					<do_if value="event.param2.{4}.{4}?" comment="no homebase selected - Edit our homebase value back into our list">
						<set_value name="$oHome" exact="$lTrader.{2}"/>
					</do_if>
					<do_else>
						<set_value name="$oHome" exact="event.param2.{3}"/>						
						<set_value name="global.$XRCLS.$lTradeShips.{$iShip}.{2}" exact="$oHome"/>
						<!-- append_to_list name="global.$XRCLS.$lTradeShips.{$iShip}.{7}" exact="[player.age,'Added/Updated Homebase for ship %1 to %2'.[$lTrader.{1}.knownname, $oHome.knownname]]"/ -->
						<signal_cue_instantly cue="WriteLog" param="[true, 'admin', [player.age,{150402, 506}.[$lTrader.{1}.knownname, $oHome.knownname]], null, null]"/>
					</do_else>
	
					<!-- Sort the ship list out and re-call the ship select menu -->
					<signal_cue_instantly cue="GetShipLists" param="[this]"/>
					<open_conversation_menu menu="gMT_Station_Logistics_Select_Ship" param="[$iTopRow, $iSelRow, [],  [$iTopRow, $iSelRow, $lExpand, $tAction], $aReturn.{1}, [], []]"/>
					<add_conversation_view view="closeupdetailmonitor"/>
					<debug_text text="'Got a new homebase...... %1'.[@$oHome.name]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/>
					<remove_value name="$aReturn"/>
					<remove_value name="$oHome"/>
					<remove_value name="$lRet"/>
					<remove_value name="$iTopRow"/>
					<remove_value name="$iSelRow"/>
					<remove_value name="$lExpand"/>
					<remove_value name="$tAction"/>
					<remove_value name="$lTrader"/>
					<remove_value name="$oShip"/>
					<remove_value name="$iShip"/>
				</do_elseif>

				<!-- Return to the admin menu -->
				<do_elseif value="event.param == 'gMT_ShipMenu_back' and not global.$bMapCall">
					<debug_text text="'MT Ship Menu: Fired the gMT_ShipMenu_back section'" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/>
					<!-- Save ship menu expand states -->
					<set_value name="global.$XRCLS.$lExpandStates.{1}" exact="event.param2.{4}"/>
					<!-- Save row info -->
					<open_conversation_menu menu="gMT_Station_Logistics_Admin" param="event.param2"/>
					<add_conversation_view view="closeupdetailmonitor"/>
				</do_elseif>

				<!-- Deal with cancel from map screen -->
				<do_elseif value="global.$bMapCall">
					<debug_text text="'IN MAP CANCEL SECTION.......event.param2 = %1'.[event.param2]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/>
					<set_value name="$lRet" exact="global.$lTempParam2"/>
					<set_value name="global.$bMapCall" exact="false"/>
					<remove_value name="global.$lTempParam2"/>
					<set_value name="$iTopRow" exact="$lRet.{1}"/>
					<set_value name="$iSelRow" exact="$lRet.{2}"/>
					<set_value name="$lExpand" exact="$lRet.{4}.{3}"/>
					<set_value name="$tAction" exact="'mapcancel'"/>
					<!-- Sort the ship list out and re-call the ship select menu -->
					<signal_cue_instantly cue="GetShipLists" param="[this]"/>
					<open_conversation_menu menu="gMT_Station_Logistics_Select_Ship" param="[$iTopRow, $iSelRow, [],  [$iTopRow, $iSelRow, $lExpand, $tAction], $aReturn.{1}, [], []]"/>
					<add_conversation_view view="closeupdetailmonitor"/>
					<remove_value name="$aReturn"/>
					<remove_value name="$lRet"/>
					<remove_value name="$iTopRow"/>
					<remove_value name="$iSelRow"/>
					<remove_value name="$lExpand"/>
					<remove_value name="$tAction"/>
				</do_elseif>

				<!-- Unhandled return action -->
				<do_else>
					<debug_text text="'ERROR: Unhandled Ships menu event: %1'.[event.param]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 1)"/>
				</do_else>

				<!-- Clean up some variables -->
				<do_if value="event.param != 'gMT_ShipMenu_back' and event.param != 'gMT_ShipMenu_configreturn' and event.param != 'gMT_ShipMenu_gothomebase' ">
					<remove_value name="$iTopRow"/>
					<remove_value name="$iSelRow"/>
					<remove_value name="$lExpand"/>
					<remove_value name="$tAction"/>
					<remove_value name="$lTrader"/>
					<remove_value name="$oShip"/>
					<remove_value name="$iShip"/>
				</do_if>
				
			</actions>
		</cue>
		
		<!-- Mod Configure menu handler cue -->
		<cue name="SectionHandler_ConfigureMenu" instantiate="true" namespace="this">
			<conditions>
				<check_any>
					<event_conversation_next_section sectionprefix="gMT_ConfigMenu_"/>
					<event_conversation_returned_to_section sectionprefix="gMT_ConfigMenu_"/>
				</check_any>
				<check_value value="global.$XRCLS?" />
			</conditions>
			<actions>
				<debug_text text="'MTL - Config Menu: param = %1 - param2 = %2'.[event.param, event.param2]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/>
				<!-- Uninstall was selected -->
				<do_if value="event.param == 'gMT_ConfigMenu_uninstall'">
					<debug_text text="'MTL - Config Menu: Uninstall selected....'" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/>
					<signal_cue_instantly cue="md.XRCLS.Uninstall" />
				</do_if>

				<!-- Reset all the XCRLS stuff to null-->
				<do_elseif value="event.param == 'gMT_ConfigMenu_reset'">
					<debug_text text="'Reseting all XRCLS lists to null, removing NPC data!!'" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/>
					<set_value name="global.$XRCLS.$lTradeShips" exact="[]"/>
					<set_value name="global.$XRCLS.$lAdminLog" exact="[]"/>
					<set_value name="global.$XRCLS.$lActiveTradeShips" exact="[]"/>
					<set_value name="global.$XRCLS.$lInactiveTradeShips" exact="[]"/>
					<do_all exact="global.$XRCLS.$lConfiguredNPCs.count" counter="$i">
						<set_value name ="$eEntity" exact="global.$XRCLS.$lConfiguredNPCs.{$i}"/>
						<remove_value name="$eEntity.$XRCLS"/>
						<debug_text text="'Entity Removed %1'.[$eEntity.name]"/>
					</do_all>
					<set_value name="global.$XRCLS.$lConfiguredNPCs" exact="[]"/>
					<set_value name="global.$XRCLS.$lExpandStates" exact="[[],[]]"/>
					<set_value name="global.$XRCLS.$lExpandStates.{1}" exact ="[0, 0, [0, 0]]" operation="set"/>
					<set_value name="global.$XRCLS.$lExpandStates.{2}" exact ="[0, 0, [0, 0, 0]]" operation="set"/>
					<set_value name="global.$XRCLS.$lTraderLog" exact="[]"/>
				</do_elseif>

				<!-- Update the debug level -->
				<do_elseif value="event.param == 'gMT_ConfigMenu_debug-error' or event.param == 'gMT_ConfigMenu_debug-info' or event.param == 'gMT_ConfigMenu_debug-detail' or event.param == 'gMT_ConfigMenu_debug-verbose'">
					<debug_text text="'Changed debug level selected.... %1  %2'.[event.param,event.param2.{3}]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/>
					<set_value name="global.$XRCLS.$iDebugLevel" exact="event.param2.{3}" />
					<signal_objects object="player.primaryship" param="'XRCLS_UpdateDebugLevel'"/>
				</do_elseif>

				<!-- unhandled config menu condition -->
				<do_else>
					<debug_text text="'ERROR: Unhandled Config menu event: %1'.[event.param]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 1)"/>
				</do_else>

				<!-- Open the admin main screen -->
				<open_conversation_menu menu="gMT_Station_Logistics_Admin" param="event.param2"/>
				<add_conversation_view view="closeupdetailmonitor"/>
			</actions>
		</cue>

		<!-- Admin menu handler cue -->
		<cue name="SectionHandler_AdminMenu" instantiate="true" namespace="this">
			<conditions>
				<check_any>
					<event_conversation_next_section sectionprefix="gMT_Admin_"/>
					<event_conversation_returned_to_section sectionprefix="gMT_Admin_"/>
				</check_any>
				<check_value value="global.$XRCLS?" />
			</conditions>
			<actions>
				<debug_text text="'MTL - Admin Menu: param = %1 - param2 = %2'.[event.param, event.param2]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/>
				<!-- Add, edit or remove ships -->
				<do_if value="event.param == 'gMT_Admin_Ship_menu'">
					<!-- Go through our list and update all the crew scores -->
					<signal_cue_instantly cue="UpdateCrewScores"/>
					<!-- Call cue to sanitise ship lists -->
					<signal_cue_instantly cue="GetShipLists" param="[this]"/>
					<debug_text text="'Got values back %1'.[$aReturn.{1}]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/>
					<!-- Open the select ship menu -->
					<open_conversation_menu menu="gMT_Station_Logistics_Select_Ship" 
											param="[global.$XRCLS.$lExpandStates.{1}.{1}, 
											global.$XRCLS.$lExpandStates.{1}.{2}, [], global.$XRCLS.$lExpandStates.{1}, $aReturn.{1}, [], []  ]"/>
					<add_conversation_view view="closeupdetailmonitor"/> 
					<remove_value name="$aReturn"/>
					<remove_value name="$iTopRow"/>
					<remove_value name="$iSelRow"/>
				</do_if>
				
				<!-- Open the reports menu screen -->
				<do_elseif value="event.param == 'gMT_Admin_Report_menu'">
					<!-- Call cue to sanitise ship lists -->
					<signal_cue_instantly cue="GetShipLists" param="[this]"/>
					<debug_text text="'Got values back %1'.[$aReturn.{1}]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/>
					<debug_text text="'MTL - Admin Menu: XRCLS Crew: %1'.[global.$XRCLS.$lConfiguredNPCs]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/>
					<!-- open_conversation_menu menu="gMT_Station_Logistics_Configure" param="event.param2"/ -->
					<open_conversation_menu menu="gMT_Station_Logistics_Reports" param="[0, 0, [], global.$XRCLS.$lExpandStates.{2}, $aReturn.{1}, 
																										global.$XRCLS.$lConfiguredNPCs, []]"/>
					<add_conversation_view view="closeupdetailmonitor"/>
					<remove_value name="$aReturn"/>
				</do_elseif>

				<!-- Configure the mod -->
				<do_elseif value="event.param == 'gMT_Admin_Config_menu'">
					<!-- debug_text text="'Global debug level set to %1'.[global.$XRCLS.$iDebugLevel]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/ -->
					<open_conversation_menu menu="gMT_Station_Logistics_Configure" param="[ 0, 0, [], [event.param2.{1}, event.param2.{2}, global.$XRCLS.$iDebugLevel] ]"/>
					<add_conversation_view view="closeupdetailmonitor"/>
				</do_elseif>

				<!-- Handle return from config menu -->
				<do_elseif value="event.param == 'gMT_Admin_Config_return'">
					<open_conversation_menu menu="gMT_Station_Logistics_Admin" param="event.param2"/>
					<add_conversation_view view="closeupdetailmonitor"/>
				</do_elseif>
				
				<!-- Close the window -->
				<do_elseif value="event.param == 'gMT_Admin_close'">
					<add_conversation_view/>
				</do_elseif>
				
				<!-- Unhandled menu event -->
				<do_else>
					<debug_text text="'ERROR: Unhandled Admin Menu Choice %1'.[event.param]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 1)"/>
				</do_else>
			</actions>
		</cue>

		<!-- Main menu handler cue -->
		<cue name="MenuHandler_MT_Logistics" instantiate="true" namespace="this">
			<conditions>
				<check_any>
					<event_conversation_next_section sectionprefix="gMT_Logistics" />
					<event_conversation_returned_to_section sectionprefix="gMT_Logistics" />
				</check_any>
				<check_value value="global.$XRCLS?" />
			</conditions>
			<actions>
				<debug_text text="'MTL - Sidebar Menu: param = %1 - param2 = %2'.[event.param, event.param2]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/>
				<open_conversation_menu menu="gMT_Station_Logistics_Admin" param="event.param2"/>
				<add_conversation_view view="closeupdetailmonitor"/>
				<!-- debug_text text="'Main Menu cue is finished'"/ -->
			</actions>
		</cue>

		<!-- Map Handler cue -->
		<cue name="MapHandler_MT" instantiate="true" namespace="this">
			<conditions>
				<check_any>
					<event_conversation_next_section sectionprefix="gMT_Map_"/>
					<event_conversation_returned_to_section sectionprefix="gMT_Map_"/>
				</check_any>
				<check_value value="global.$XRCLS?"/>
			</conditions>
			<actions>
				<do_if value="event.param == 'gMT_Map_GetStation'">
					<!-- Save our parameters temporarily for return -->
					<set_value name="global.$XRCLS.$mapparam" exact="event.param2"/>
					<set_value name="$oHomebase" exact="event.param2.{6}.{2}"/>
					<!-- Open the map menu with correct selection options -->
					<do_if value="event.param2.{8} == 'npc'">
						<!-- open_conversation_menu menu="MapMenu" param="[0, 0, 'zone', player.primaryship.zone, null, null, 'selectobject', ['gMT_Map_StationSelected', null, false, true]]"/ -->
						<open_conversation_menu menu="MapMenu" param="[0, 0, 'zone', $oHomebase.zone, null, null, 'selectobject', ['gMT_Map_StationSelected', null, false, true]]"/>
					</do_if>
					<do_elseif value="event.param2.{8} == 'player'">
						<!-- open_conversation_menu menu="MapMenu" param="[0, 0, 'zone', player.primaryship.zone, null, null, 'selectplayerobject', ['gMT_Map_StationSelected', null, false, false, false, true]]"/ -->
						<open_conversation_menu menu="MapMenu" param="[0, 0, 'zone', $oHomebase.zone, null, null, 'selectplayerobject', ['gMT_Map_StationSelected', event.object.ship, null, false, false, false, true, null, null, null, null, null, null, null, true]]"/>
					</do_elseif>
					<add_conversation_view view="closeupdetailmonitor"/>
				</do_if>
				
				<do_elseif value="event.param == 'gMT_Map_StationSelected'">
					<!-- Restore our previously saved parameter info -->
						<debug_text text="'event.param2 = %1'.[event.param2]"/>
						<set_value name="$lTrader" exact="global.$XRCLS.$mapparam.{6}"/>
						<set_value name="$tAction" exact="global.$XRCLS.$mapparam.{4}.{4}"/>
						<set_value name="$lWaypoint" exact="global.$XRCLS.$mapparam.{7}"/>
						<set_value name="$oOldStation" exact="global.$XRCLS.$mapparam.{7}.{3}"/>
						<remove_value name="global.$XRCLS.$mapparam"/>
						<debug_text text="'Old station = %1'.[$oOldStation]"/>

						<do_if value="@event.param2.{4}.{4} == 'addwaypoint'">
							<set_value name="$oSelectedStation" exact="$oOldStation"/>
						</do_if>
						<do_else>
							<set_value name="$oSelectedStation" exact="event.param2.{3}"/>
						</do_else>
					
						<debug_text text="'Station selected value on map return = %1'.[$oSelectedStation]"/>
						<!-- Get ware list for station -->
						<set_value name="$lWareList" exact="[$oSelectedStation.resources.list, $oSelectedStation.products.list, $oSelectedStation.tradewares.list]"/>
						<debug_text text="'MT CLS - Selected Station: %1  Ware List = %2'.[$oSelectedStation.name, $lWareList]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 1)"/>
						<!-- Go back to our waypoint editor map with the station info -->
						<open_conversation_menu menu="gMT_Station_Logistics_EditWaypoint" param="[0, 0, [], [0,0,[0,0],$tAction], [], $lTrader, $lWaypoint, $lWareList, $oSelectedStation]"/>
						<add_conversation_view view="closeupdetailmonitor"/>
						<debug_text text="'MT CLS - Selected Station: %1'.[$oSelectedStation.name]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 1)"/>
						<!-- Cleanup -->
						<remove_value name="$lTrader"/>
						<remove_value name="$tAction"/>
						<remove_value name="$lWaypoint"/>
						<remove_value name="$oSelectedStation"/>
						<remove_value name="$oOldStation"/>
				</do_elseif>

				<do_elseif value="event.param == 'gMT_Map_HomebaseSelected'">
					<debug_text text="'event.param2 = %1'.[event.param2]"/>
					<set_value name="$tAction" exact="event.param2.{4}.{4}"/>
					<set_value name="$lTrader" exact="event.param2.{6}"/>
					<set_value name="$lWaypoint" exact="event.param2.{7}"/>
					<set_value name="$oHomebase" exact="$lTrader.{2}"/>
					<debug_text text="'Station selected value on map return = %1'.[$oHomebase]"/>
					<set_value name="$lWaypoint.{3}" exact="$oHomebase"/>
					<!-- Get ware list for station -->
					<set_value name="$lWareList" exact="[$oHomebase.resources.list, $oHomebase.products.list, $oHomebase.tradewares.list]"/>
					<debug_text text="'MT CLS - Selected Station: %1  Ware List = %2'.[$oHomebase.knownname, $lWareList]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 1)"/>
					<!-- Go back to our waypoint editor with the station info -->
					<open_conversation_menu menu="gMT_Station_Logistics_EditWaypoint" param="[0, 0, [], event.param2.{4}, [], $lTrader, $lWaypoint, $lWareList]"/>
					<add_conversation_view view="closeupdetailmonitor"/>
					<debug_text text="'MT CLS - Selected Station: %1'.[$oHomebase.knownname]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 1)"/>
					<!-- Cleanup -->
					<remove_value name="$lTrader"/>
					<remove_value name="$tAction"/>
					<remove_value name="$lWaypoint"/>
					<remove_value name="$oHomebase"/>
				</do_elseif>
				
				<!-- Unhandled map value -->
				<do_else>
					<debug_text text="'ERROR: Unhandled Map menu event:  ' + event.param" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 1)"/>
				</do_else>
			</actions>
		</cue>

		<!-- Cue to re-calculate all the crew scores -->
		<cue name="UpdateCrewScores" instantiate="true" namespace="this">
			<conditions>
				<event_cue_signalled/>
			</conditions>
			<actions>
				<set_value name="$lTraders" exact="global.$XRCLS.$lTradeShips"/>				<!-- Get all the traders into a local list -->
				<do_all exact="$lTraders.count" counter="$i">
					<set_value name="$oShip" exact="$lTraders.{$i}.{1}"/>
					<set_value name="$iCrewSkill" exact="@$oShip.pilot.combinedskill + @$oShip.defencenpc.combinedskill + @$oShip.engineer.combinedskill"/>
					<set_value name="$iCrewLevel" exact="1"/>
					<do_if value="$iCrewSkill" min="200" max="249">
						<set_value name="$iCrewLevel" exact="2"/>
					</do_if>
					<do_if value="$iCrewSkill ge 250">
						<set_value name="$iCrewLevel" exact="3"/>
					</do_if>
					<set_value name="$lTraders.{$i}.{5}" exact="$iCrewLevel"/>
					<set_value name="$lTraders.{$i}.{6}" exact="$iCrewSkill"/>
				</do_all>
				<set_value name="global.$XRCLS.$lTradeShips" exact="$lTraders"/>
				<remove_value name="$iCrewSkill"/>
				<remove_value name="$iCrewLevel"/>
				<remove_value name="$lTraders"/>
				<remove_value name="$oShip"/>
			</actions>
		</cue>
		
		<!-- Synchronise list of ships -->
		<cue name="GetShipLists" instantiate="true" namespace="this">
			<conditions>
				<event_cue_signalled/>
			</conditions>
			<actions>
				<set_value name="$oCue" exact="event.param.{1}"/>
				<set_value name="$lTradeShips" exact="global.$XRCLS.$lTradeShips"/>							<!-- Get all the traders into a local list -->
				<set_value name="$lNewList" exact="[]"/>
				<!-- Set the index for the ship component -->
				<do_all exact="$lTradeShips.count" counter="$iTraderIndex">								<!-- now get a list of ships to pass into the menu -->
					<set_value name="$lTrader" exact="$lTradeShips.{$iTraderIndex}"/>
					<set_value name="$oShip" exact="$lTrader.{1}"/>
					<do_if value="@$oShip.exists and @$oShip.isoperational">
						<set_value name="$iCrewSkill" exact="@$oShip.pilot.combinedskill + @$oShip.defencenpc.combinedskill + @$oShip.engineer.combinedskill"/>
						<set_value name="$iCrewLevel" exact="1"/>
						<do_if value="$iCrewSkill" min="200" max="249">
							<set_value name="$iCrewLevel" exact="2"/>
						</do_if>
						<do_if value="$iCrewSkill ge 250">
							<set_value name="$iCrewLevel" exact="3"/>
						</do_if>
						<set_value name="$lTrader.{5}" exact="$iCrewLevel"/>
						<set_value name="$lTrader.{6}" exact="$iCrewSkill"/>
						<set_value name="$lTrader.{10}" exact="$iTraderIndex"/>
						<set_value name="$lTrader.{11}" exact="$lTrader.{4}.count" comment="Number of waypoints"/>
						<append_to_list name ="$lNewList" exact="$lTrader"/>
					</do_if>
				</do_all>
				
				<!-- Update the saved list -->
				<set_value name="global.$XRCLS.$lTradeShips" exact="$lNewList"/>
				<debug_text text="'Global Ship List: %1'.[global.$XRCLS.$lTradeShips ]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)" />
				
				<set_value name="$oCue.$aReturn" exact="[$lNewList]"/>
				<!-- clean up -->
				<remove_value name="$lTradeShips"/>
				<remove_value name="$lTrader"/>
				<remove_value name="$lNewList"/>
				<remove_value name="$iTraderIndex"/>
				<remove_value name="$oShip"/>
				<remove_value name="$iCrewSkill"/>
				<remove_value name="$iCrewLevel"/>
			</actions>
		</cue>

		<!-- Debug - Write log contents and show in debug log if requested -->
		<!-- Param.{1} - true if write to debug log Param.{2} - log to write  Param.{3} - log entry Param.{4} - ship index if ship log  Param.{5} - ship object if ship log -->
		<cue name="WriteLog" instantiate="true" namespace ="this">
			<conditions>
				<event_cue_signalled/>
			</conditions>
			<actions>
				<set_value name="$bWriteToDebug" exact="event.param.{1}"/>
				<set_value name="$sLog" exact="event.param.{2}"/>
				<set_value name="$lEntry" exact="event.param.{3}"/>
				<set_value name="$iShip" exact="event.param.{4}"/>
				<set_value name="$oShip" exact="event.param.{5}"/>
								
				<!-- Update the admin log -->
				<do_if  value="$sLog == 'admin'" comment="Write to Admin log">
					<set_value name="global.$XRCLS.$lAdminLog.{1}" exact="$lEntry" operation="insert"/>
					<do_if value="$bWriteToDebug">
						<do_all exact="global.$XRCLS.$lAdminLog.count" counter="$i">
							<debug_text text="'++++ MT LOGISTICS ADMIN LOG +++++ %1'.[global.$XRCLS.$lAdminLog.{$i}]" filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/>
						</do_all>
					</do_if>
				</do_if>
				<!-- Update the ship log-->
				<do_elseif value="$sLog == 'ship'" comment="Write to ship log">
					<set_value name="global.$XRCLS.$lTradeShips.{$iShip}.{7}.{1}" exact="$lEntry" operation="insert"/>
					<do_if value="$bWriteToDebug">
						<do_all exact="global.$XRCLS.$lTradeShips.{$iShip}.{7}.count" counter="$i">
							<debug_text text="'++++ MT LOGISTICS SHIP LOG +++++ %1 Data %2'.[$oShip.knownname, global.$XRCLS.$lTradeShips.{$iShip}.{7}.{$i}]"  filter="scripts_verbose" chance="100 * (global.$XRCLS.$iDebugLevel ge 3)"/>
						</do_all>
					</do_if>
				</do_elseif>
				<do_else comment="Unhandled params">
				</do_else>

				<remove_value name="$bWriteToDebug"/>
				<remove_value name="$sLog"/>
				<remove_value name="$lEntry"/>
				<remove_value name="$iShip"/>
				<remove_value name="$oShip"/>
					
			</actions>
		</cue>
	
	</cues>
</mdscript>
MitchTech Station Logistics

== Introduction ==

The folks in the R&D department at MitchTech Corporation went on the internet and found this: http://forum.egosoft.com/viewtopic.php?t=275928 They got to thinking: "How hard could it be?" Well, after many hours, gallons of spacefuel, lashings of pizza and some pancakes MitchTech Corporation is proud to present its second update for the Pride of Albion user interface. 

As usual MitchTech focuses on improvements that enhance the lives of budding empire builders and this mod is no exception. Unhappy with the ad hoc way trade was being conducted in the known galaxy, MitchTech has produced a trade ship orders system using the latest state-of-the-art communication and encryption technology, ensuring traders go where you want and sell what you want. No more cargo going missing (ever wondered why crew where quite happy to work for nothing? - they were "loosing" cargo quite often weren't they!!) - No more dumb captains and dumb managers trading stuff that suited them because they were too lazy to analyse routes and buy what the station needed as opposed to what made a quick buck close to the best bars and nightclubs. Unfortunately, the Teladi trader's union got wind of this innovative technology close to release and we had to modify the software to guarantee pilots being paid a wage as they would no longer be able to "pay" their own wages out of "your" profits. Having threatened to go on strike and *cough* bring the galaxy's economy to a *cough* halt we decided it was better to meet their demands than attract the adverse publicity of a trade boycott on launch.

== Features ==
- Plan a series of waypoints for a station trader - set location, ware, buy, sell, amount and price
- Trader follows waypoints in order, skipping those that are not valid allowing complex supply chains to be set up
- Higher skilled crews can fly further from homebase and have more waypoints
- Crews earn experience points as well as a salary and can be trained using experience points and a small cash sum
- Highest level crews are paid commission on sales to NPC stations in addition to salary based on flight time
- Logs for each trader, an admin log and crew member logs including crew rank increase with XP earned (also a feature to rename crew members!)
- Extensive UI checking to prevent invalid entries e.g. ensures only ware types that can be carried are available to select on waypoint edit screen
- Uninstall command for removing mod from savegames

== Getting started ==
1. Subscribe to the mod on steam and it will automagically be added to your game.

2. Press enter to get the sidebar menu --> select the trade icon --> select MT Station Logistics

3. Highlight "Administer Trade Ships" in the list and click on "Select" button

4. You will be presented with a screen with a list of unconfigured ships. Expand the list and select a ship that you want to trade with. Note that ships will only appear in this list if: i) They have a captain, ii) they are not in your squad, iii) they are not assigned to a station or another ship, iv) they have at least 5 cargo lifter drones onboard.

5. Highlight your chosen ship and click the "Add" button - this adds your ship to the trader list

6. Select the ship again and click "Homebase" - select the ship you want the trader to work for from the map (Yes you need to own at least one station!)

7. Now click on the "Configure" button and add some waypoints (you need at least two waypoints before you can start the trader)

8. The next screen allows you to manage a list of the ship's waypoints. You can add, edit, re-order, cut and paste waypoints.

9. Click on the "Add Waypoint" button to bring up the waypoint add/edit screen. Here you'll need to select the station to trade with, the action (buy, sell etc) the ware type, and the minimum amount required to fly the waypoint (you can also set a maximum/desired amount) and of course price limits.

10. Once all the required information is added you will be able to click the "Save" button to add the waypoint and take you back to the waypoint list screen.

11. Repeat steps 9 and 10 until you have a route defined (note that the software will help prevent you making invalid choices but it will not stop you making dumb choices - e.g. if you give a ship 5 sell waypoints and no buy waypoints it will not do anything because it has nothing to sell!)

12. Once your waypoint list is complete, click on the "Save" button to return to the ship list. 

13. Click on the "Start" button to set your trader off on its chosen route.

Note the following:

1. Active traders are assigned to their chosen homebase and will show up under the station's tab in the vanilla property menu.

2. All transactions for sales by the trader and wages/commission paid will be conducted using the homebase station's account. (except for crew training)

3. You can see what the trader has been up to in the reports section.

== Uninstalling the mod ==
Backup your savegame!!
Select "Configure" from the first menu screen then select "Uninstall" from the next screen. 
Now save the game and exit the game.
Unsubscribe from the mod on steam (if you wish you can also delete the folder in the extensions folder)
Start the game again and load the most recent save. Save this game again and you should now have a squeeky clean save file!

== Known issues == 
none - but you're all going to find lots aren't you :D

== TODO: Suggestions and bug reports are most welcome ==
Detailed instructions/manual
Allow trade with player owned construction vessels
Do something similar with miners (the vanilla ones are fine to be honest but it would be nice if they could sell to NPCs when the station doesn't need stuff they mine)
Load and save waypoint lists
Lots of testing

== Technical ==

Text ID Page 150402
Patched vanilla mods - trade.station.player <- to prevent manager using logistics ships


== Credits ==
Lucike - for the inspiration and the "Original" CLS trader concept
Mad Joker - lots of bits from MJ's library and UFO mod used here<?xml version="1.0" encoding="UTF-8"?>
<!-- 
	Base (English) text file for MT Station Logistics mod.
	
	Author: wysiwyg
  
	Last Change:
	Version: V0.0.1
	Date: 06th December 2014
  
	X Rebirth version: 3.00+
-->
<language>
	<page id="150402" title="MT_Station_Logistics" descr="Texts for MT Station Logistics mod." voice="no">
		<!-- Sidebar Menu 1-20 -->
		<t id="1">MT Station Logistics</t>
		<t id="2">Set-up and manage Station Logistics Traders</t>

		<!-- DetailMonitor Admin menu 21-25 -->
		<t id="21">MT Station Logistics - Administration</t>
		<t id="22">Select an option from the list below and click select</t>
		<!-- DetailMonitor Admin Menu - Buttons -->
		<!-- Select {1001,3102} - vanilla -->
		<!-- Back {1001,2669} - vanilla -->
		<!-- DetailMonitor Admin menu - Options 26-40 -->
		<t id="26">Administer Trade Ships</t>
		<t id="27">Reports</t>
		<t id="28">Configure</t>
		<t id="29">Unassigned Crew Members</t>
		<t id="30">CLS crew currently serving on non-cls vessel</t>
		
		<!-- DetailMonitor Reports Menu 41-80 -->
		<t id="41">MT Station Logistics - Reports Menu</t>
		<t id="42">Get data about ships and crew</t>
		<t id="44">No Rank</t>
		<t id="45">Train</t>
		<t id="46">Report</t>
		<t id="47">Crew member has a service record - eXPerience Points available to spend</t>
		<t id="48">Crew member does not have a service record</t>
		<!-- Captain's Ranks -->
		<t id="49"></t>
		<t id="50">Captain</t>
		<t id="51">Major</t>
		<t id="52">Lieutenant Colonel</t>
		<t id="53">Colonel</t>
		<t id="54">Commander</t>
		<t id="55">Rear Admiral</t>
		<t id="56">Admiral</t>
		<t id="57"></t>
		<t id="58"></t>
		<t id="59"></t>
		<!-- Defence Officer Ranks -->
		<t id="60">Private</t>
		<t id="61">Private 1st Class</t>
		<t id="62">Corporal</t>
		<t id="63">Crew Sergeant</t>
		<t id="64">Sergeant 1st Class</t>
		<t id="65">Gunnery Sergeant</t>
		<t id="66">Sergeant Major</t>
		<t id="67"></t>
		<t id="68"></t>
		<t id="69"></t>
		<!-- Engineer Ranks -->
		<t id="70">Crewman Apprentice</t>
		<t id="71">Crewman</t>
		<t id="72">Specialist</t>
		<t id="73">Petty Officer 2nd Class</t>
		<t id="74">Petty Officer 1st Class</t>
		<t id="75">Chief Petty Officer</t>
		<t id="76">Master Chief Petty Officer</t>
		<t id="77"></t>
		<t id="78"></t>
		<t id="79"></t>
		<t id="80"></t>

		<!-- DetailMonitor Configuration Menu 81-100 -->
		<t id="81">MT Station Logistics - Configuration</t>
		<t id="82">Select an option below</t>
		<t id="83">Set debug level 1 - Error</t>
		<t id="84">Set debug level 2 - Information</t>
		<t id="85">Set debug level 3 - Detailed</t>
		<t id="86">Set debug level 4 - Verbose</t>
		<t id="87">Uninstall MT Station Logistics</t>
		<t id="88">Reset all XRCLS data</t>

		<!-- DetailMonitor Ship Menu 101-160 -->
		<t id="101">Administer Station Logistics Ships</t>
		<t id="102">Configured Logistics Ships</t>
		<t id="103">Homebase</t>
		<t id="104">Score</t>
		<t id="105">Active</t>
		<t id="106">#WP</t>
		<t id="107">Un-configured ships available</t>
		<t id="108">Remove</t>
		<t id="109">Stop</t>
		<t id="110">Configure</t>
		<t id="111">Active?</t>
		<t id="112">None</t>
		<t id="113">Mining</t>
		
		<!-- DetailMonitor Waypoint list menu 161-220 -->
		<t id="161">Waypoint Management</t>
		<t id="162">None Selected</t>
		<t id="163">WP Type</t>
		<t id="164">Min</t>
		<!-- Max = vanilla {1001,19} -->
		<!-- Ware = vanilla {1001,45} -->
		<!-- Range = vanilla {1001,1302} -->
		<t id="165">Active?</t>
		<t id="166">No Station Selected</t>
		<t id="167">No Action</t>
		<t id="168">Load</t>
		<t id="169">Unload</t>
		<t id="170">Fly to</t>
		<!-- Buy = vanilla {1001,2916} -->
		<!-- Sell = vanilla {1001,2917} -->
		<!-- Refuel = vanilla {1002,2027} -->
		<t id="171">Locked</t>
		<t id="172">Add New Waypoint</t>
		<t id="173">Selected Ship</t>
		<t id="174">Homebase Station</t>


		<!-- DetailMonitor Waypoint Edit Menu 221-300 -->
		<t id="221">Edit Waypoint</t>
		<t id="222">Add Waypoint</t>
		<t id="223">!!OBJECT SELECTED MUST BE A STATION!!</t>
		<t id="224">!!STATION MUST HAVE A TRADE AGENT ONBOARD!!</t>
		<t id="225">!!STATION SELECTED IS HOSTILE - PLEASE CHOOSE ANOTHER!!</t>
		<t id="226">!!STATION SELECTED IS OUT OF RANGE FOR THE CURRENT CREW!!</t>
		<t id="227">!!! WARNING!  THE STATION SELECTED DOES NOT DEAL IN ANY WARES THAT THE SHIP CAN CARRY !!!</t>
		<t id="228">Description</t>
		<t id="229">Action</t>
		<!-- Station - vanilla {1001,3} -->
		<t id="230">Home</t>
		<t id="231">NPC</t>
		<t id="232">Waypoint Type</t>
		<t id="233">Ware Type</t>
		<t id="234">If fuel left less than</t>
		<t id="235">Minimum Amount</t>
		<t id="236">Cargo Space</t>
		<t id="237">Maximum Amount</t>
		<t id="238">Maximum buy Price</t>
		<t id="239">Minimum sell Price</t>
		<t id="240">Avg</t>
		<t id="241">Is Waypoint Active?</t>
		<!-- Yes - Vanilla {1001,2617} -->
		<!-- No - Vanilla {1001,2618} -->
		<t id="242">Change</t>
		<t id="243">Waypoint Range</t>
		<t id="244">Save</t>
		<t id="245">Move Up</t>
		<t id="246">Move Down</t>
		<t id="247">Cut</t>
		<t id="248">Paste</t>
		<t id="249">Paste Buffer</t>
		<t id="250">Paste Buffer empty</t>
		<t id="251">Waypoint Station</t>
		
		<!-- Crew log/training screen 301-400 -->
		<t id="301">MT Station Logistics - Crew Details</t>
		<t id="302">Train your crew member</t>
		<t id="303">Flying Time</t>
		<t id="304">Salary Earned</t>
		<t id="305">Experience points left to spend</t>
		<t id="306"></t>
		<t id="307"></t>
		<t id="308"></t>
		<t id="309"></t>

		<!-- Ship Log screen 401-500 -->
		<t id="401">MT Station Logistics - Ship Log</t>
		<t id="402">Get data from your Logistics Trader ships</t>
		<t id="403">Total Time</t>
		<t id="404">Turnover</t>
		<t id="405">Volume Traded</t>
		<t id="406">% Time Active</t>
		<t id="407">Track</t>
		<t id="408">(DBG) Verbose</t>
		<t id="409">Admin Log</t>
		<t id="410">Activity Log</t>
		<t id="411">Debug Level for this ship</t>
		<t id="412">No Log Entries to show</t>
		<t id="413">Tracking Log</t>
		<t id="414"></t>
		<t id="415"></t>
		<t id="416"></t>
		<t id="417"></t>
		<t id="418"></t>
		<t id="419"></t>

		<t id="420">Error - report to author</t>
		<t id="421">Skipping waypoint due to waypoint set to inactive</t>
		<t id="422">Skipping waypoint due to wages not being paid!!</t>
		<t id="423">Wages paid - resuming duties</t>
		<t id="424">Skipping waypoint due to waypoint being out of range for the current crew</t>
		<t id="425">Skipping waypoint due to destination being hostile</t>
		<t id="426">Waypoint is fly to. Already close enough so not moving</t>
		<t id="427">Successfully flew to destination</t>
		<t id="428">Null sweep: already safely at home so not moving</t>
		<t id="429">Null sweep: flew home to safety</t>
		<t id="430">Skipping due to not enough cash to pay for wares</t>
		<t id="431">Skipping due to not enough wares for purchase at destination</t>
		<t id="432">Skipping because the wares are too expensive at the destination</t>
		<t id="433">Skipping due to no wares for sale at the destination</t>
		<t id="434">Skipping because the amount is too low to be worth the trip</t>
		<t id="435">Skipping because we already have enough of that ware on board</t>
		<t id="436">Skipping because we don't have enough room in the hold</t>
		<t id="437">Skipping because the destination does not want enough wares</t>
		<t id="438">Skipping because the destination won't pay enough for the wares</t>
		<t id="439">Skipping due to no buy offers at the destination</t>
		<t id="440">Skipping because we don't have enough wares on board to meet the sale</t>
		<t id="441">Skipping due to not being able to reserve enough wares</t>
		<t id="442">Skipping as it seems that the target has been destroyed or is not functional</t>
		<t id="443">Aborted because we couldn't park at the destination</t>
		<t id="444">Something went wrong during the trade - Egosoft - I'm looking at you!!!</t>
		<t id="445">Flying back to homebase</t>
		<t id="446"></t>
		<t id="447"></t>
		<t id="448"></t>
		<t id="449"></t>
		<t id="450"></t>

		<t id="451">Ship ceased trading - stopped by player</t>
		<t id="452">The ship has been destroyed</t>

		<!-- Admin log screen -->
		<t id="460">MT Station Logistics - Admin Log</t>
		<t id="461">See all actions on logistics ships</t>
		<t id="462">No Admin Log messages</t>
		<t id="463">Message</t>
		<t id="464"></t>
		<t id="465"></t>
		<t id="466"></t>
		<t id="467"></t>
		<t id="468"></t>
		<t id="469"></t>
		<t id="470"></t>

		<!-- Admin log screen 500-530 -->
		<t id="500">New Trade Ship Added to fleet %1</t>
		<t id="501">Removed ship from fleet %1</t>
		<t id="502">Started Trading with ship %1</t>
		<t id="503">Stopped Trading with ship %1</t>
		<t id="504">Updated Waypoints for ship %1 - ship now has less than two waypoints so stopping</t>
		<t id="505">Updated Waypoints for ship %1</t>
		<t id="506">Updated Homebase for ship %1 to %2</t>
		<t id="507"></t>
		<t id="508"></t>
		<t id="509"></t>
		<t id="510"></t>



		<t id="10000">Administration</t>
		<t id="10001">Administer logistics traders</t>
		<t id="10005">Reports</t>
		<t id="10006">Get progress reports from stations and traders</t>
		<t id="10008">Configure MT Station Logistics</t>
		<t id="10009"></t>
		<t id="10010"></t>
		<t id="10011"></t>
			  
		<t id="10023">Edit Trader</t>
		<t id="10026">Select a station that the trader will work for</t>
		<t id="10035">Configure MT Station Logistics</t>
		<t id="10036">Edit selected waypoint</t>

		<!-- 9000 - 9999: Administration -->
		<t id="9000">Uninstall</t>
		<t id="9001">Debug Level</t>
		<t id="9002">Error</t>
		<t id="9003">Information</t>
		<t id="9004">Detailed</t>
		<t id="9005">Verbose</t>
		  
		<t id="9992">\nAdditional information is available in your logbook.</t>
		<t id="9993">Active %1 version: V%2</t>
		<t id="9994">Running %1 initialization cue at debug level %2...</t>
		<t id="9995">Successfully un-installed %1 V%2.\nPlease save your game, close X-Rebirth, delete the %1 folder from your extensions folder and un-subscribe from the mod in the workshop, then load and save your game.%3</t>
		<t id="9996">Warning!\nYou are downgrading your %1 version: V%2 -> V%3</t>
		<t id="9997">Installing %1 V%2...%3</t>
		<t id="9998">Detected %1 update: V%2 -> V%3%4\nPlease save your game and load it again.</t>
		<t id="9999">Updated %1 configuration found....Update successful!</t>
    </page>
</language><?xml version="1.0" encoding="utf-8"?>
<diff xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <add sel="/addon[@name='ego_detailmonitor']/dependency" pos="before">
    <file name="..\..\..\extensions\mt_XRCLS\ui\addons\ego_detailmonitor\MT_Station_Logistics_Admin_Menu.lua" />
    <file name="..\..\..\extensions\mt_XRCLS\ui\addons\ego_detailmonitor\MT_Station_Logistics_Reports_Menu.lua" />
    <file name="..\..\..\extensions\mt_XRCLS\ui\addons\ego_detailmonitor\MT_Station_Logistics_Config_Menu.lua" />
    <file name="..\..\..\extensions\mt_XRCLS\ui\addons\ego_detailmonitor\MT_Station_Logistics_Select_Ship.lua" />
    <file name="..\..\..\extensions\mt_XRCLS\ui\addons\ego_detailmonitor\MT_Station_Logistics_ListWaypoints.lua" />
	<file name="..\..\..\extensions\mt_XRCLS\ui\addons\ego_detailmonitor\MT_Station_Logistics_EditWaypoint.lua" />
	<file name="..\..\..\extensions\mt_XRCLS\ui\addons\ego_detailmonitor\MT_Station_Logistics_CrewLog.lua" />
	<file name="..\..\..\extensions\mt_XRCLS\ui\addons\ego_detailmonitor\MT_Station_Logistics_ShipLog.lua" />
	<file name="..\..\..\extensions\mt_XRCLS\ui\addons\ego_detailmonitor\MT_Station_Logistics_AdminLog.lua" />
	<file name="..\..\..\extensions\mt_XRCLS\ui\addons\ego_detailmonitor\MT_Station_Logistics_Rename.lua" />
	<file name="..\..\..\extensions\mt_XRCLS\ui\addons\ego_detailmonitor\lib\LibMT.lua" />
  </add>
</diff>
LJ   4   +  > T >AN/   4     T2   5  4  7  4 4 > 4     T4  7  4 > G   registerMenuHelper
LibMTinsert
table
Menusipairs 	 3  T2 4  7> <  :::: T'  :H nrOfChildRowsisFixedbgColour	data
cells  getEmptyCellDescriptorHelper. 
    7   )   	 @ CreateCell   ) 
  T	 	 4
   >

 T

4
 
 7

     >
	
   7
 	 %   @
 buttonCreateCellCreateDefaultCenterButton
LibMTstring	type6 
    7   %  	 @ editBoxCreateCell   3  T4  7>: T% :: T' :H colspanscript	type	textelement  getEmptyCellDescriptorHelper     G       )  H  i  3  : T1 : T1 ::0  H hotkeyavailabilityProvider script 
label     &4   7  >4   7 	 )
 >'  ' I  7
   ) >
K  T4   7 	 )
 >  T7>G  displayExpandRowAddRowCollapseRowIsExpanded
LibMT 
   4   7  >4   7  )	 >  7   >  T4   7  )	 >  T7>G  displayExpandRowAddRowExpandStateCollapseRowIsExpanded
LibMTY   '  ' I
  7	    ) >	K  T7>G  displayRemoveRow 	   7    ) >  7   >7  T	77 T777 :  T7>G  displayidxselectedRowDeleteRowExpandStateCollapseRow   4   7  >  T	4   7  	 
 >T4   7  	 
 >G  ExpandRowCollapseRowIsExpanded
LibMT  M7   T2  : 4 7  T) T) %  %	 7


 % $>4  7 7 '	  (
   >4  T	)	 T
)	 %
  %	  % $

>4  T	)	 T
)	 %

 >  T7  T		77 T77	7				:	4 7	>:77:  T7>G  displayselrowdefaulttableGetTopRowtoprowidxselectedRow8Error during row expansion: number of rows left > 0) and target row index (IError during row expansion: mismatch in returned current row index (ExpandRowHelper
LibMT)&) is larger than number of rows (Row index (	rowsassertexpandStates   G'  ' I?  7
 6

6	  T3 2  :7
:7
:9		 T6	7  T'  T6	76	) :   F 6	7  T'  4  7 6	7 6	7 >   6	6	7:	 T   F K  '  F ExpandRowHelper
LibMTexpandedrowsTotalnrOfChildRowschildStates expanded	rows   G7   T2  : 4 7  T) T) %  %	 7


 % $>4  7 7 (	  
 >4  T) T	) %	 >  T7	  T7	7
 T7	7
 T7	:
T7	7	7
:
4 7>:7	7
:  T7>G  displayselrowdefaulttableGetTopRowtoprowidxselectedRow9Error during row collapsing: number of rows left > 0CollapseRowHelper
LibMT)&) is larger than number of rows (Row index (	rowsassertexpandStates   >'  ' I7 	 T	6	 	 T		 '
  F	 6	7	 	 	 T
6	7		 	 T
'	  6
) : 

 	 F
 6	 	 T
6	7	 	 	 T
)	 4
 
 7

 6767 >
	 
 6
67	:
	 T

 	 F
 K '  F nrOfChildRowschildStatesCollapseRowHelper
LibMTrowsTotalexpanded  
 87   T2  :   T7  '   T  T7  4 7   T) T) %  % 7 %	 $	>4  7 7 '  ( 	 >'   T3 2  :	4
 77  >G  insert
tablechildStates nrOfChildRows rowsTotal expandedAddRowExpandStateHelper
LibMT
) + 1&) is larger than number of rows (Parent row index (assert	rowsexpandStates  	='  ' I6  7
 6

6	  T3 2  :7
:7
:9		 T6	6	7 :6	6	7 :  F 6	7  T4  7 6	7 6	7 >5   	 T  F K  F parentRowIdxAddRowExpandStateHelper
LibMTexpandedrowsTotalnrOfChildRowschildStates expanded	rows  
 	&7   T2  : 4 7  T) T) %  % 7 %	 $	>4  7 7 (   >4  T) T) % >G  GError during deletion of row expand state: number of rows left > 0DeleteRowExpandStateHelper
LibMT)&) is larger than number of rows (Row index (	rowsassertexpandStates   .'  ' I) 	 T	4	  7		
  >	H 6	 	 T
6	7		 	 T
4	 
	 7		 6767 >		 	 T	6	6
7


 
:
	6	6
7


 
:
	H KH rowsTotalnrOfChildRowschildStatesDeleteRowExpandStateHelper
LibMTexpandedremove
table  
 7   T2  : 4  7 7 (   '	 >4  T) T) % >  F >Error during row expansion check: number of rows left > 0assertIsExpandedHelper
LibMTexpandStates   	F%  '  '	 I='  ' I % $K6
  T3 2  : 	 T6
  T )  F  6
7 F 6
  T6
7  T) 4  7 6
76
7  >5    4 $	 T   F K ) 	 F s2nrOfChildRowsIsExpandedHelper
LibMTexpandedchildStates nrOfChildRows rowsTotal expanded...
    %  T7  74 7 %   T	4	 7		 	 T
4	 7		
 T
4
 7

77	7
7>	4 7 )	  )
  '  '  '  4 7@	 standardTextHeightcreateButtonabgrstandardFontSizestandardFontstandardFontBoldcentercreateButtonTextHelper
whitecolours   $  T4  774 7	 %
 4 7 T' 777	7
>	4	 7		
 )  )  '   T'   T' ' )   @	 createButtonabgrstandardFontcentercreateButtonTextHelper
whitecolours
LibMT2   +   7   + + + > G  
script F7   TA74  >T	: 
 T77
  T44 7  7
7
>7
   >7
	  T'
 T'  )  7	

 T4 77	
) > 4  77
  *  >	4   7
7
>4 7 )   7
7
1 >0	 A	N	0  G   setButtonScriptSetCellContent!CreateDefaultButtonBarButton
LibMTcreateButtonHotkeyhotkeyavailabilityProvidercolrowremoveButtonScriptsHelper
labelipairsbuttontablebuttons   7 G  topRow ! 4  7  >' 4	  7				7
 2 4  7 ) % ' ' ' 'd 4  74  7) 4  74  7	4  74  7
> <  )  3  T) 4   T4  7>
  T
04
  >
T*7 2 4  7 ) % ' ' ' 'd 4  74  7) 4  74  74  74   7 
 > <  )  3  T) 4   T4  7>4  7		AN  T

 '  
 T
4
  >
T7 2 ;)  3  T) 4   T4  7>4  7		AN  T
3
 '  
 T
/'
  ' I
+7 2 4  7% ) % ' ' ' 'd 4  74  7) 4  74  74  74  7
> <  )  3  T) 4   T4  7>4  7		K
7
 3 ) >
	 F
    createCustomWidthTable      headerRow2HeightheaderRow2OffsetyheaderRow2OffsetxheaderRow2FontSizeheaderRow2Fontipairs defaultTitleBackgroundColor
bgCol  headerRow1WidthheaderRow1OffsetyheaderRow1OffsetxheaderRow1FontSizeheaderRow1Font	leftcreateFontStringaddTitleRowheaderRow1HeightcreateTableSetupHelper,   +   7   + + > G      script8 	 	+  7     + + >G      script 	 +   7     T 
4  7  + )  + 7+ + 1 > +   7     T 
4  7  + )  + 7+ + 1 > G    setEditBoxScripteditBox selecttablesetButtonScriptHelperbutton	type		%  4	  7		
  >	'
 4  7
'  ) 7		  )    T) 4   T4  7>  T24  >T,7		 2 4  7 ) % ' ' ' 'd 4  7	4  7
)  4!  7!!4"  7""4#  7##4$  7$$> <  )  2  ; T) 4   T4  7>4  7
AN4  >TL2  2  ' 4 7>T4 7 7>4 7 7>7  T 4 74 1 >0 70 AN7  T4  % >T) 4   T) T) %  % %  % $>7		  7  T) 4  7>4  7
0 0 AN)  T) ) )  '  '  '  '  7		           > 0  F createCustomWidthTable	data) in row ) and provided colspans (#Missmatch in nr of colWidths (/Cannot add fixed rows after non-fixed rowsassertisFixed cell_scriptsscriptcolspanelementinsert
table
cellsheaderRow1WidthheaderRow2HeightheaderRow2OffsetyheaderRow2OffsetxheaderRow2FontSizeheaderRow2Font	leftcreateFontStringipairs defaultTitleBackgroundColor
bgColaddTitleRowheaderCharacterIconSizecreateTableSetupHelper,   +   7   + + > G      script8 	 	+  7     + + >G      script 	 +   7     T 
4  7  + )  + 7+ + 1 > +   7     T 
4  7  + )  + 7+ + 1 > G    setEditBoxScripteditBox selecttablesetButtonScriptHelperbutton	type
# 4
  7

  >
'  ) 4  >TQ2  2  ' 4 7>T4 7 7>4 7 7>7  T 4 7 1	 >0 70 AN7
  T4  % > T) 4    T) T) %  %  %  % $>7
  T	7

  7 ) 7>T7

  7 ) 7>0 0 AN)  T)  T) ' '    T)  	 T)  7

   T)        )  ! " >0  H createCustomWidthTableaddSimpleRowbgColor	dataaddHeaderRow) in row ) and provided colspans (#Missmatch in nr of colWidths (/Cannot add fixed rows after non-fixed rowsassertisFixed scriptcolspanelementinsert
table
cellsipairscreateTableSetupHelper  4  7  >2  4  7>4  >T
0  T)7  T&7  T4 76
:)  7 T4  7	7) > ' 
 T'
 T'  4  7
7)  *  >	4 7  >T4 7  >A
N
2 ;' '	 '
 I6  T6 T4 7 6>6' :6 :T4 7  >4 7  >K2 ;'	 '
 ' I	6  T6 T4 7 6>6' :6 :T4 7  >4 7  >K	7	
  * ) 4 77>	7	
  * ) 4 77>	3	 )
 ) ) ' ' '  '  7 	 
        ) @ createCustomWidthTable
  00 00transparentcoloursaddSimpleRowcolrowinsert
table!CreateDefaultButtonBarButtoncreateButtonHotkeyhotkeys
LibMThotkey
labelipairsgetEmptyCellDescriptorcreateTableSetupHelper   	  T  7  2 ;>T4  >T
  7
  2 4 	 % >;	 >
ANG  	nameGetComponentDataipairsaddSimpleRow     ' 'I4   >T	
 T4 6 >  T4 7   >TT
 T4 6 4 > =  T4 7   >TT
 T4	 6 % >  T4 7   >T~T{

 T4	 6 %
 >  Ts4 7   >ToTl
 T4	 6 % >  Td4 7   >T`T]
 T4	 6 % >  TU4 7   >TQTN
 T4	 6 % >  TF4 7   >TBT?
 T4	 6 % >  T74 7   >T3T0
 T4 6 >'  4   >
  T4   >T AN'  T4 7   >TT
 T4 6 % >4 7 % >  T4 7   >TA	N	VKQH  units_size_xl_builder_ship	findstring
macroGetComponentDatacv	nextGetStorageDatabattleshipship_lship_xlship_xsship_mship_sIsComponentClass
droneGetPlayerPrimaryShipIDIsSameComponentplayershipremove
tableGetCommandercommanderipairs   .  ' 'I)4  6 >) %	  T
%	 4
 6 % >
 
 T4
 6 % >
 
 T4
  >
T7	 T7	 T) AN T
4

 7

   >
KH  remove
tableamount
macroipairsship_xlship_lIsComponentClass%units_size_xs_transp_empty_macro
cargoGetUnitStorageData     ' 'I4  6 % % %	 >  T4 7	  
 >KH  remove
tableengineerdefencenpc
pilotGetComponentData   34    % % % >'  '  '    T4   %	 >   T4   %	 >   T4   %	 > ' '	 	 T	'	 	 T	' T	'	 	 T	' 	 
    F	 combinedskillengineerdefencenpc
pilotGetComponentData   !' ' N  T' T(    T' T(   T' T(   T' T(   T' T(   T' T' H 	=  4  7%   >4  7%   >$4 7 ) % ' ' '  '	d 4
 7

' @
 starFont	leftcreateFontStringHelper#*repstring
   4  'N' >4  'N'd >4  'N'>4  'N',>4  'N' >2  ) ) )	 )
 ) 4   % > 4 7   T' T'  >4   % >
 4 7  
 T' T'  >4   % > 4 7   T' T'  >4   % >	 4 7  	 T' T'  >4   % > 4 7   T' T'  >'  4	  >TAN'  T4 7 ' >T4 7 '  >4
   >4	  >TG4 77 >  T4 77 >  T4 77 >  T4 77 >  T87 ;;;;;7 T87 ;7 T87 ;7 T87 ;7 T87 ;7 T87 ;ANH capacity	name	findstringGetStorageDataipairs	ionsioncellschemicalcompoundsnividiuminsert
tablefuelcellsCheckSuitableTransportTypeReadTextn 	    ' 'I4  6 % > T4 7   >KH  remove
tabletransportGetWareData 
  4    % % % >4   % % %	 >'  T	' T	 T	' T	' H clustersector	zoneGetComponentData   2  2  2  2  8'	  	 T=4  74	  7		7		
   >	 = 4	  7		4
  7

7

  >
 =	 	 )	 4
  >
T4  % > T)	 4 7	  >4  >T4  % > T4 7	  >ANAN
     	 F
 8'	  	 T"4 	  >T4  % > T4 7
  >AN4 	 >T4  % > T4 7
  >AN8'	  	 T34 	  >T4  % > T4 7
  >AN4 	 >T4  % > T4 7
  >AN4 	 >T4  % > T4 7
  >AN8'	  	 T34 	  >T4  % > T4 7
  >AN4 	 >T4  % > T4 7
  >AN4 	 >T4  % > T4 7
  >AN8'	  	 T34 	  >T4  % > T4 7
  >AN4 	 >T4  % > T4 7
  >AN4 	 >T4  % > T4 7
  >AN8'	  	 T34 	  >T4  % > T4 7
  >AN4 	 >T4  % > T4 7
  >AN4 	 >T4  % > T4 7
  >AN4  74	  7		7		
  >	 = 4	  7		4
  7

7

  >
 =	 	 )	 4
  >
T4  % > T)	 4 7	  >AN
    	 F
 liquidenergycontainer	bulkinsertremove
table	fueltransportGetWareDataipairsSymmetricSetdeepcopy
LibMT   "4    >)   T2  4   )  D	4 7	 >4	 7		
 >	9	BN4  4 74   > =  =T  H getmetatablesetmetatabledeepcopy
LibMT	next
table	type_ 
  4   >T
4  >4 	  > T) H AN) H tostringipairs>   4   >T  T) H AN) H ipairs  2 4    > <  4  >T4 77	 
 >  T4 7	 
 >ANH insert
table	FindSet
LibMTipairsunpack~   2  4   >T4 77	 
  >  T	4 7	 
 >ANH insert
table	FindSet
LibMTipairs~   2  4    >T4 77	 
 >  T4 7	 
 >ANH insert
table	FindSet
LibMTipairso   4  774  77   >4  77   > ? Intersection
UnionDifferenceSet
LibMT  2   4    T4  7 3 2  :3 :2  :5  4  )  :4  3
 3	 :3 :3 :3 :3 ::4  3 :1 4  1 :4  1 :4  1 :4  1 :4  1  :4  1" :!4  1$ :#4  1& :%4  1( :'4  1* :)4  1, :+4  1. :-4  10 :/4  12 :14  14 :34  16 :54  18 :74  1: :94  1< :;4  1> :=4  1@ :?4  1B :A4  1D :C4  1F :E4  1H :G4  1J :I4  1L :K4  1N :M4  1P :O4  1R :Q4  1T :S4  1V :U4  1X :W4  1Z :Y4  1\ :[4  2 2 4^ (  '2 >;4^ (  '3 >;4^ (  '4 >;4^ (  '5 >;4^ (  '6 >;4^ (  '7 >;4^ (  '8 > < ;2 4^ (  '< >;4^ (  '= >;4^ (  '> >;4^ (  '? >;4^ (  '@ >;4^ (  'A >;4^ (  'B > < ;2 4^ (  'F >;4^ (  'G >;4^ (  'H >;4^ (  'I >;4^ (  'J >;4^ (  'K >;4^ (  'L > < ;:]4  3` 4^ (  '>:a4^ (  '>:b4^ (  '>:c4^ (  '>:d4^ (  '>:e4^ (  '>:f4^ (  '>:g4^ (  '>:h4^ (  '>:i4^ (  '>:j4^ (  '>:k4^ (  '>:l4^ (  '>:m4^ (  '>:n4^ (  '>:o4^ (  '>:p4^ (  '>:q4^ (  '>:r4^ (  '>:s4^ (  '>:t4^ (  '>:u4^ (  '>:v4^ (  '>:w4^ (  '>:x4^ (  '>:y4^ (  '>:z:_4  2 4^ (  ' >;4^ (  ' >;4^ (  ' >;4^ ''d>;4^ ''e>;4^ (  ' >;4^ ''> < :{4  1} :|4  1 :~4  1 :4  1 :4  1 :4  1 :4  2  :4  71 :4  71 :4  71 :4  71 :4  71 :4  71 :0  G   Symmetric Difference Intersection 
Union 
Find2 	FindSet deepcopy CompareStationWarelist GetStationRange RemoveWares GetCargoSpecs createStarsTextWPTypeWP_NULLSWEEP_FLYINGERR_INTRADE_FAILERR_CANT_PARKERR_TARGET_INVALIDERR_CANTRESERVE ERR_BUYOFFER_NOTENOUGHCARGOERR_BUYOFFER_NO_OFFERERR_BUYOFFER_WONTPAY ERR_BUYOFFER_NOTENOUGHWARESERR_SELLOFFER_NOCARGOSPACEERR_SELLOFFER_DONTNEED#ERR_SELLOFFER_NOTVIABLE_AMOUNTERR_SELLOFFER_NO_OFFERERR_SELLOFFER_COSTERR_SELLOFFER_NOWARESERR_SELLOFFER_NOCASHWP_NULLSWEEP_FLYWP_NULLSWEEP_NOFLYWP_FLYTOWP_FLYTO_NOMOVEERR_HOSTILEERR_RANGEWAGES_PAIDNO_WAGESWP_INACTIVENO_TRADE  MessagesReadText
Ranks get_entity_rank get_crew_level remove_ships_with_no_crew filter_ships_bydrones filter_ships create_section create_standard_button_bar create_body create_column_header create_standard_header SetSelectedRow CheckButtonBarAvailability !CreateDefaultButtonBarButton CreateDefaultCenterButton IsExpandedHelper IsExpanded DeleteRowExpandStateHelper DeleteRowExpandState AddRowExpandStateHelper AddRowExpandState CollapseRowHelper CollapseRow ExpandRowHelper ExpandRow ToggleRow RemoveRow RemoveRows AddRow AddRows BarButton CreateCell EditBoxCell ButtonCell 	Cell Row 	   INPUT_STATE_DETAILMONITOR_B INPUT_STATE_DETAILMONITOR_X!INPUT_STATE_DETAILMONITOR_LB!INPUT_STATE_DETAILMONITOR_RB INPUT_STATE_DETAILMONITOR_A INPUT_STATE_DETAILMONITOR_0#INPUT_STATE_DETAILMONITOR_BACK INPUT_STATE_DETAILMONITOR_Yhotkeystransparent g a b r 	blue g adbr 
green gadb r red g adrb 
white   gadbrcolours
DEBUGrowDataMap
param  
menus 	name
LibMTregisterFuncs
LibMT LJx   4      T2   5   4  7  4  +  > 4     T4  7  +  > G   registerMenuHelperinsert
table
Menus3   +   )  :  +   )  : G   
adminbuttons  B+   2  :  +   7   +  78: +   7   +  78: +   7   4 (  ' >: +   7   4 (  ' >: +   7   2 3 4 (  ' >;;3	 4 (  ' >;;3
 4 (  ' >;;: +   7   +  7 788: +   7  > G   displayselection   gMT_Admin_Config_menu   gMT_Admin_Report_menu   gMT_Admin_Ship_menuoptionssubtitleReadText
titleselrow
paramtoprow
admin     )  H       )  H  
 &4   7  +  > 4   2  : 4   )  : +   2  : 4  7  +  +  772 +  77	;> '<  2  2  3
 4 +  77>T
2  84 7 4  7 )  ' > =4 7 4  7  4  7) '  > =A
N
4 7+  	 
  ) ) +  77+  77>+  2	  :	4 7+	  7		4
 
 7

>
 =4 7+	  7		4
 
 7

>
 =4 7+	  7		4
 
 7

>
 =4 7+	  7		4
 
 7

>
 =4 7+	  7		4
 
 7

4 ''m
>+ 71 % >
 =4 7+	  7		4
 
 7

>
 =4 7+	  7		4
 
 7

>
 =4 7+	  7		4
 
 7

4 ''>+ 71 % >
 =4 7+	  +
  7

  >+	  +
  +  4  7"+      ) %# %# '  '  '  '  %$ ) ) >:!: 
:	4	 
 >	T >AN4	  7	%	>	0  G   releaseDescriptors	bothdisplayThreeTableViewbuttontableselecttableinfotablecreate_standard_button_bar INPUT_STATE_DETAILMONITOR_X Select INPUT_STATE_DETAILMONITOR_B 	BackReadTextBarButtonbuttonsselrowtoprowcreate_body!defaultHeaderBackgroundColorRow	Cellinsert
tableoptionsipairs   subtitle
title
admincreate_standard_header
LibMTrowDataMapcurrentTableRowDatacurrentTableRowremoveAllButtonScriptsHelperZ  +  7  T+  78:4  7+     >G   CheckButtonBarAvailability
LibMTselection
admindefaulttable     G  "  +   7 >G  	Backh   4   7  +  ) % 2  > +   7  > G   cleanupgMT_Admin_closecloseMenuForSectionHelper   4   +  7> 4 74 7+  ) +  772 ; ;2  ;>+  7>G   cleanupselection
admincloseMenuForSectioncurrentDefaultTableRowHelperdefaulttableGetTopRow   3   3 : 2  1 1 : 1 : 1	 : 1 :
 1 : 1 : 1 :1 : >0  G   Select 	Back onCloseElement onSelectElement onRowChanged display onShowMenu cleanup transparent g a r b  	name gMT_Station_Logistics_AdminstatusWidthstatusHeight LJx   4      T2   5   4  7  4  +  > 4     T4  7  +  > G   registerMenuHelperinsert
table
Menus6   +   )  :  +   )  : G   adminlogbuttons  9+   2  :  +   +  78: +   +  78: +   7   +  78: +   7   +  78: +   7   +  78: +   7   4 (  '>: +   7   4 (  '>:	 +   3 +  7:2  ::
 +   7  > G   display	dataidx  selectedRowsubtitleReadText
titlelogtraderret_expselrow
paramtoprowadminlog     )  H   (4   7  +  > 4   2  : 4   )  : +   2  : 4  7  +  +  773
 +  77	;> '<  2  2  3 +  77 '   T34 +  77>T
*2  4 7 4  74 4 >8>)  ' > =4 7 4  78)  ' > =4 7 4  7 3 4  7) '  > =A
N
T2  4 7	 4
 
 7

4 ( '>)  ' >
 =4 7	 4
 
 7

 3 4  7) '  >
 =4 7+  	 
  ) ) +  7+  7>+  2	  :	4 7+	  7		4
 
 7

>
 =4 7+	  7		4
 
 7

>
 =4 7+	  7		4
 
 7

>
 =4 7+	  7		4
 
 7

>
 =4 7+	  7		4
 
 7

4 ''m
>+ 71 % >
 =4 7+	  7		4
 
 7

>
 =4 7+	  7		4
 
 7

>
 =4 7+	  7		4
 
 7

>
 =4 7 +	  +
  7

  >+	  +
  +  4  7$+      ) %% %% '  '  '  '  %& ) ) >:#:"
:!	4	 
 >	T >AN4	  7	'	>	0  G   releaseDescriptors	bothdisplayThreeTableViewbuttontableselecttableinfotablecreate_standard_button_bar INPUT_STATE_DETAILMONITOR_B 	BackBarButtonbuttonsselrowtoprowcreate_body  	noneReadText!defaultHeaderBackgroundColor  	noneRowGetCurTimeConvertTimeString	Cellinsert
tableipairslog  Kdd    subtitle
titleadminlogcreate_standard_header
LibMTrowDataMapcurrentTableRowDatacurrentTableRowremoveAllButtonScriptsHelper(  +  7  T+  7: +  7:4  7+     >G   CheckButtonBarAvailability
LibMT	dataidxselectedRowdefaulttable     G  "  +   7 >G  	Back   '4   7  +  ) % 2	 +  778;+  778;2  ;+  77;2  ;2  ;+  77;+  77;> +   7  > G   cleanuplogtraderret_expadminloggMT_ReportMenu_returnadmincloseMenuForSectionHelper   3   3 : 2  2  1 1 : 1 : 1	 : 1 :
 1 : 1 : 1 : >0  G   	Back onCloseElement onSelectElement onRowChanged display onShowMenu cleanup transparent g a r b  	name#gMT_Station_Logistics_AdminLogstatusWidthstatusHeight LJx   4      T2   5   4  7  4  +  > 4     T4  7  +  > G   registerMenuHelperinsert
table
Menus4   +   )  :  +   )  : G   buttonsconfig  v+   2  :  +   7   +  788: +   7   +  788: +   7   +  788: +   7   4 (  'Q >: +   7   4 (  'R >% 4 (  ')#>%	 4 (  +  7 7>$: 4 
 7     T/+   7   2 3 4 (  'S >;;3 4 (  'T >;;3 4 (  'U >;;3 4 (  'V >;;3 4 (  'W >;;3 4 (  'X >;;: T +   7   2 3 4 (  'W >;;: +   7  > G   display   ,gMT_ConfigMenu_gMT_ConfigMenu_uninstall    gMT_ConfigMenu_reset    gMT_ConfigMenu_uninstall    !gMT_ConfigMenu_debug-verbose    gMT_ConfigMenu_debug-detail   gMT_ConfigMenu_debug-info   gMT_ConfigMenu_debug-error options
DEBUG
LibMT -    subtitleReadText
titlecurrentdbgselrow
paramtoprowconfig     )  H       )  H  
 $4   7  +  > 4   2  : 4   )  : +   2  : 4  7  +  +  772 +  77	;> '<  2  2  3
 4 +  77>T
2  84 7 4  7 )  ' > =4 7 4  7  4  7) '  > =A
N
4 7+  	 
  ) ) >	+  2	  :	4 7+	  7		4
 
 7

>
 =4 7+	  7		4
 
 7

>
 =4 7+	  7		4
 
 7

>
 =4 7+	  7		4
 
 7

>
 =4 7+	  7		4
 
 7

4 ''m
>+ 71 % >
 =4 7+	  7		4
 
 7

>
 =4 7+	  7		4
 
 7

>
 =4 7+	  7		4
 
 7

4 ''>+ 71 % >
 =4 7+	  +
  7

  >+	  +
  +  4  7 +      ) %! %! '  '  '  '  %" ) ) >::
:	4	 
 >	T >AN4	  7	#	>	0  G   releaseDescriptors	bothdisplayThreeTableViewbuttontableselecttableinfotablecreate_standard_button_bar INPUT_STATE_DETAILMONITOR_X Select INPUT_STATE_DETAILMONITOR_B 	BackReadTextBarButtonbuttonscreate_body!defaultHeaderBackgroundColorRow	Cellinsert
tableoptionsipairs   subtitle
titleconfigcreate_standard_header
LibMTrowDataMapcurrentTableRowDatacurrentTableRowremoveAllButtonScriptsHelperZ  +  7  T+  78:+  78:4  7+     >G   CheckButtonBarAvailability
LibMTdebug_numselectionconfigdefaulttable     G       T4 7+  >+  7>T+  7>+  7>G   	BackcleanupcloseMenuAndCancelHelper
close   4   7  +  ) % 2 +  77;+  77;> +   7  > G   cleanupselrowtoprowconfiggMT_Admin_Config_returncloseMenuForSectionHelper   4   7  +  ) +  772 +  77;+  77;+  77;> +   7  > G   cleanupdebug_numselrowtoprowselectionconfigcloseMenuForSectionHelper   3   3 : 1 2  2  1 : 1 : 1	 : 1 :
 1 : 1 : 1 :1 : >0  G   Select 	Back onCloseElement onSelectElement onRowChanged display onShowMenu cleanup transparent g a r b  	name$gMT_Station_Logistics_ConfigurestatusWidthstatusHeight LJx   4      T2   5   4  7  4  +  > 4     T4  7  +  > G   registerMenuHelperinsert
table
Menus2   +   )  :  +   )  : G   	crewbuttons  C+   2  :  +   +  78: +   +  78: +   7   +  78: +   7   +  78: +   7   +  7 78: +   7   4 +  7 7%	 >: +   7   4 (  '->:
 +   7   4 (  '.>: +   3 +  7:2  :: +   7  > G   display	dataidx  selectedRowsubtitleReadText
title$XRCLSGetNPCBlackboardcrewlogentitycrewdataret_expselrow
paramtoprow	crew1   7 7    T) T) H relevance     )  H       )  H       )  H   -V4   7  +  > 4   2  : 4   )  : +   2  : 4  +  77% %	 %
 % % % > 4 (  ', > T4 784 7+	  7		7		8		>6T! T4 784 7+	  7		7		8		>6T T4 784 7+	  7		7		8		>6T4 (  '	, > 2 4  7	 )
 ' ' ' 'd '  '  4  74  7>;4  7	 %
   $		)
 % ' ' ' 'd 4  74  7>
;4  7	 )
 ' ' ' 'd '  '  4  74  7> < 5 3 4  74	  7		>;4  74	  7		>;3  2	  2
  4! 7"
 4  7#%$ )  ' > =4! 7"
 4  7#4 (  '/>%% $)  ' > =4! 7"
 4  7#4& +  778>)  ' > =4! 7"	 4  7'
 3( 4  7)) '  > =2  4! 7" 4  7#%$ )  ' > =4! 7" 4  7#4 (  '0>%% $)  ' > =4* +  778) ) )  ) >%+ $4! 7" 4  7# )  ' > =4! 7"	 4  7' 3, 4  7)) '  > =2  4! 7" 4  7#%$ )  ' > =4! 7" 4  7#4 (  '1>%% $)  ' > =4! 7" 4  7#4- +  778) ' ) >)  ' > =4! 7"	 4  7' 3. 4  7)) '  > =4 7/+  4 2 ;	   ) >'< 2  2  31 4  70;4  70;2  4! 7" 4  7#4 ''~>)  ' > =4! 7" 4  7#%$ )  ' > =4! 7" 4  7' 2  4  7)) '  > =4! 72 13 >44 >+  77835 46  >TU7767762   )! 7"8'#  #" T")! 4"  7""4# '$7%9>#)$ %% '& '' '( ')d  ! T*4*  7*:* * T+4*  7*;*>"	4# 7#<#7$7>#4$! 7$"$%  4& '& 7&#&(" ))  '* >& =$4$! 7$"$%  4& '& 7&#&(# ))  '* >& =$4$! 7$"$% 4& '& 7&'&(  2) 7*7;*)7*8;*););););)7*;*)4*  7*)*)+ ',  >& =$AN4 7=+     ) )  !+"  7">"+#  7#?#>+  2  :@4! 7"+  7@4  7A> =4! 7"+  7@4  7A> =4! 7"+  7@4  7A> =4! 7"+  7@4  7A> =4! 7"+  7@4  7A4 '' m
>+ 7B1 C %!D > =4 7E  T4! 7"+  7@4  7A%F + 7G1 H %!I > =T	4! 7"+  7@4  7A> =4! 7"+  7@4  7A4 '' Z>+ 7J1 K %!L > =4! 7"+  7@4  7A4 (  ' - >+ 7M+  7 M %!N > =4 7O+  +  7@  >+  +  +  4  7S+    ! " )# %$$ %%$ '&  ''  '(  ')  %*T )+ ), >: R:Q:P46  >T  > AN4  7U>0  G   releaseDescriptors	bothdisplayThreeTableViewbuttontableselecttableinfotablecreate_standard_button_bar INPUT_STATE_DETAILMONITOR_XSelect INPUT_STATE_DETAILMONITOR_Y Rename#INPUT_STATE_DETAILMONITOR_BACK 	Test(DBG) Give XP
DEBUG INPUT_STATE_DETAILMONITOR_B 	BackBarButtonbuttonsselrowtoprowcreate_bodycreateStarsTextstandardFontstandardFontBoldtextidrelevance
valueipairs   GetPlayerMoney 	sort    standardButtonWidthcreate_column_header  	noneConvertIntegerString  	none CrConvertMoneyString!defaultHeaderBackgroundColor  	noneRowConvertTimeString:	Cellinsert
table      scaleX
titleheaderRow1FontSizeheaderRow1Font	left createFontStringheaderCharacterIconSizecreateIconengineerdefencecontrolcrewlogget_entity_rank
Ranks
LibMTcommanderReadTextskillsownericontypenametypeicontypestring	nameentity	crewGetComponentDatarowDataMapcurrentTableRowDatacurrentTableRowremoveAllButtonScriptsHelperJZ  +  7  T+  7: +  7:+  7:4  7+     >G   CheckButtonBarAvailability
LibMTtraining_data	crew	dataidxselectedRowdefaulttable     G  "  +   7 >G  	Back   4   7  +  ) % 2 +  778;+  778;2  ;+  77;2  ;2  ;> +   7  > G   cleanupret_exp	crewgMT_ReportMenu_returncrewcloseMenuForSectionHelper   4   +  7> 4 74 7+  ) % 2 ; ;+  77;+  77;+  77	;>+  7
>G   cleanuptraining_dataret_expcrewdata	crewgMT_ReportMenu_traincloseMenuForSectioncurrentDefaultTableRowHelperdefaulttableGetTopRow   4   +  7> 4 74 7+  ) % 2 ; ;+  77;+  77;+  77	;>+  7
>G   cleanuptraining_dataret_expcrewdata	crewgMT_ReportMenu_renamecloseMenuForSectioncurrentDefaultTableRowHelperdefaulttableGetTopRow   4   +  7> 4 74 7+  ) % 2 ; ;+  77;+  77;+  77	;>+  7
>G   cleanuptraining_dataret_expcrewdata	crewgMT_ReportMenu_testxpcloseMenuForSectioncurrentDefaultTableRowHelperdefaulttableGetTopRowW    8'   T8'  T88 T88  T) T) H     3   3 : 2  2  1 1 : 1 : 1	 : 1 :
 1 : 1 : 1 :1 :1 :1 :1 : >0  G    	Test Rename Select 	Back onCloseElement onSelectElement onRowChanged display onShowMenu cleanup transparent g a r b  	name"gMT_Station_Logistics_CrewLogstatusWidthstatusHeight LJx   4      T2   5   4  7  4  +  > 4     T4  7  +  > G   registerMenuHelperinsert
table
MenusV   +   )  :  +   )  : +   )  : +   )  : G   wpedit	ware	boolbuttons  +   2  :  +   2  : +   2  : +   +  78: +   +  78: +   7  '  : +   7  +  78: +   7  +  788  T%	 : +   7  +  78:
 +   7  +  78: +   7  +  78  T2  : +   7  +  78	: +   7  +  77
8: +   7  +  77
8: +   7   +  778  T' : +   7  +  778: +   7  +  778: +   7   ) : +   7  2 4 (  ' >;4 (  ' >;4 (  ' >;4 ''d>;4 ''e>;4 (  ' >;4 ''> < : +   7  7     T
+   7   ) : +   7  +  77: +   7  4 (  ' >: +   7  7    T +   7  4 (  ' >: T +   7  4 (  ' >: +   7  %	 : +  7  +  7 7) ) ) ) ) > +   7  > G   displayRecheckMenusubtitle3subtitleaddwaypoint
titleReadTextwaypointTypestationchangedwp_stationIsWPActivehomebase
cargonewstationwarelistwaypointtraderwp_actionret_argtoggleselrow
paramtoprowwpedit	ware	bool,   +     7   > G   SelectHomebase2  +   7 % >G   playermapSelect/  +   7 % >G   npcmapSelect/  +   7 ' ) >G   SetAmount/  +   7 '2 ) >G   SetAmount/  +   7 'K ) >G   SetAmount/  +   7 'd ) >G   SetAmount/  +   7 ' ) >G   SetAmount/  +   7 '2 ) >G   SetAmount/  +   7 'K ) >G   SetAmount/  +   7 'd ) >G   SetAmount&  +   7 >G   DecPrice&  +   7 >G   IncPrice.  +   7 % >G   minSetPrice.  +   7 % >G   avgSetPrice.  +   7 % >G   maxSetPrice'  +   7 >G   SetActive     )  H  > #f4   7  +  > 4   2  : 4   )  : +   2  : +   7  7  % +  77$  4	 (  ' >%
 4 +  778% >% 4	 (  ' >%
 4 +  778%	 >$4 7+    2 ;2  ' )  2	 +
  7

7

;
	>'< 2  2  3 4	  7		;	4	  7		;	2	  3
 4	 (  ' >% $;
4	 (  ' >% $;
% 4 
 >D4 7	 4  7 )  ' > =BN4 7	 4  7% )  ' > =4 7 4  7	  +  7) '  > =2  4 7 4  74	 '' >)  ' > =4	 (  'p >+  77  T4 +  77 % > 4 7 4  7 T4	 (  'p >)  ' > =4 7 4  7!% )  ' ) > =4 7 4  7!% )  ' ) > =4 7 4  7!4	 (  ' >1" ' ) > =4 7 4  7!4	 'N'A>1# ' ) > =4 7 4  7!4	 (  ' >1$ ' ) > =4 7 4  7% )  ' > =4 7 4  7 )  +  7) '  > =2  4 7 4  74	 (  ' >)  ' > =4 7 4  7+  77%+  77&+  77'66)  ' > =4 7 4  7!%( + 7)' +  77> =4 7 4  7!%* + 7+' +  77> =4 7 4  7% )  ' > =4 7 4  7 )  +  7) '  > =2  4 7 4  74	 (  ' >)  ' > =+  7,7- T+  7,7.  T4 7 4  74	 (  ' >)  ' > =T4 7 4  74/ +  7,7.+  7,7-6% >)  ' > =4 7 4  7!%( + 70' +  771  T+  772  T	+  7,7.+  7,7-63 T) T) > =4 7 4  7!%* + 74' +  771  T+  772  T	+  7,7.+  7,7-63 T) T) > =4 7 4  7% )  ' > =4 7 4  7 )  +  7) '  > =2  +  7,7.+  7,7-63 T4 7 4  74	 (  ' >)  ' > =T4 7 4  74	 (  ' >)  ' > =4 7 4  7+  7,75%6 +  7,77%8 4	 (  ' >%9 $)  ' > =4 7 4  7!%( + 7:' +  77;  T+  772 > =4 7 4  7!%* + 7<' +  77;  T+  772 > =4 7 4  7!%= 1> ' +  77;  T+  772 > =4 7 4  7!%? 1@ ' +  77;  T+  772 > =4 7 4  7!%A 1B ' +  77;  T+  772 > =4 7 4  7!4	 '' >1C ' +  77;  T+  772 > =4 7 4  7% )  ' > =4 7 4  7 )  +  7) '  > =2  4 7 4  74	 (  ' >)  ' > =4 7 4  7+  7,7D%6 +  7,7E%8 4	 (  ' >%9 $)  ' > =4 7 4  7!%( + 7F' +  77;  T+  772  T	+  7,7.+  7,7-63 T) T) > =4 7 4  7!%* + 7G' +  77;  T+  772  T	+  7,7.+  7,7-63 T) T) > =4 7 4  7!%= 1H ' +  77;  T+  772  T	+  7,7.+  7,7-63 T) T) > =4 7 4  7!%? 1I ' +  77;  T+  772  T	+  7,7.+  7,7-63 T) T) > =4 7 4  7!%A 1J ' +  77;  T+  772  T	+  7,7.+  7,7-63 T) T) > =4 7 4  7!4	 '' >1K ' +  77;  T+  772  T	+  7,7.+  7,7-63 T) T) > =4 7 4  7% )  ' > =4 7 4  7 )  +  7) '  > =2  +  77%+  77&+  77'664	 ''d> T4 7 4  74	 (  ' >)  ' > =T++  77%+  77&+  77'664	 ''e> T4 7 4  74	 (  ' >)  ' > =T4 7 4  7% )  ' > =4 7 4  7+  7,7L)  ' > =4 7 4  7!%( 1M ' +  77;  T++  772  T#+  7,7.+  7,7-63 T+  77%+  77&+  77'66N T+  77%+  77&+  77'66O T) T) > =4 7 4  7!%* 1P ' +  77;  T++  772  T#+  7,7.+  7,7-63 T+  77%+  77&+  77'66N T+  77%+  77&+  77'66O T) T) > =4 7 4  7!4	 (  ' >1Q ' +  77;  T++  772  T#+  7,7.+  7,7-63 T+  77%+  77&+  77'66N T+  77%+  77&+  77'66O T) T) > =4 7 4  7!4	 (  ' >1R ' +  77;  T++  772  T#+  7,7.+  7,7-63 T+  77%+  77&+  77'66N T+  77%+  77&+  77'66O T) T) > =4 7 4  7!4	 '' >1S ' +  77;  T++  772  T#+  7,7.+  7,7-63 T+  77%+  77&+  77'66N T+  77%+  77&+  77'66O T) T) > =4 7 4  7% )  ' > =4 7 4  7 )  +  7) '  > =2  4 7 4  74	 (  ' >)  ' > =% +  77T	 T4	 '':
> T4	 ''9
> 4 7 4  7 )  ' > =4 7 4  7!% )  ' ) > =4 7 4  7!% )  ' ) > =4 7 4  7!4	 (  ' >1U ' ) > =4 7 4  7% )  ' > =4 7 4  7 )  +  7) '  > =2  4 7 4  74	 (  ' >)  ' > =2 4	 '!N' >;4	 '!N'e >;4	 '!N'> < +  77V64 7 4  7 )  ' > =4 7 4  7% )  ' > =4 7 4  7% )  ' > =4 7 4  7% )  ' > =4 7 4  7% )  ' > =4 7 4  7 )  +  7) '   > =4 7W+     ) )   >	+  2  :X4 7+  7X4  7Y> =4 7+  7X4  7Y> =4 7+  7X4  7Y> =4 7+  7X4  7Y> =4 7+  7X4  7Y4	 ''m
>+ 7Z1[ % \ > =4 7+  7X4  7Y> =4 7+  7X4  7Y> =4 7+  7X4  7Y4	 (  ' >+ 7]+ 7]% ^ > =4 7_+  +  7X  >+  +  +  4  7c+     ! )" >:b:a:`4d  >T >AN4  7e>0  G   releaseDescriptorsipairsdisplayThreeTableViewbuttontableselecttableinfotablecreate_standard_button_bar INPUT_STATE_DETAILMONITOR_X	Done INPUT_STATE_DETAILMONITOR_B 	BackBarButtonbuttonscreate_bodywprange IsWPActive    Unload	Load 
Price    IncAmountDecAmountselectedAmountDisplayAmount  75% 50% 25%IncModifierTypeisWareValidDecModifierType) % selectedMinAmount  (MinAmountIncWareTypefuelcellsisFlyToisWPTypeValidDecWareTypeGetWareDatadisplayselectedWareType	wareIncWPType+DecWPType-selectedWPTyperevwaypointTypewaypointType   ButtonCellwp_stationisStationValid	booltransparentRow	Cellinsert
table
pairsheader    :standardTextHeight
    PPPP subtitle3create_standard_header
LibMT	 -- 	nametraderGetComponentData: ReadTextsubtitle - 
titlewpeditrowDataMapcurrentTableRowDatacurrentTableRowremoveAllButtonScriptsHelper   
 *+   7   7  '    T +   7   '  : 4  7  +  7' ' +  7 74 77> T +   7   ' : 4  7  +  7' ' +  7 74 77	> G   
whiteredcolours
LibMTsubtitle3infotableupdateCellTextHelpertogglewpeditg  +  7  T4  7+     >G   CheckButtonBarAvailability
LibMTdefaulttable     G  p     T4 7+  >+  7>T+ 7>G   	BackcleanupcloseMenuAndCancelHelper
close  
  +   7   7  +  7 7% ;4 7+  ) % 3 2  ;+  7 7;2  ;+  7 7;; >+  7	>G   cleanuptrader    gMT_WPListMenu_returncloseMenuForSectionHelper	noneret_argwaypointwpedit  +   7   7  8  +  7 7; +  7 7+  77;+  7 7+  7 7  T% ;+  7 7+  7 7+  7 76;+  7 78	  T+  7 74 ( ' >;+  7 7'  ;+  7 7'  ;+  7 7'  ;+  7 7+  7 7	;	T'+  7 7+  7
7+  7
76;+  7 7+  7
7;+  7 7+  7
7;+  7 7+  7
7;+  7 7+  7 7	;	+  7 7+  7 7+  7 7;4 7+  ) % 3 2  ;+  7 7;2  ;+  7 7;;>+  7>G   cleanuptrader    gMT_WPListMenu_returncloseMenuForSectionHelperwp_actionret_arg
PriceDisplayAmountMinAmountselectedWareTypedisplay	warewprangeReadTextselectedWPTyperevwaypointTypewp_stationIsWPActive	boolwaypointwpedit  !+   7   +  7 7 : +   7   7  '   T +   7   +  7 7 : +  7  ) ) ) ) ) ) > +   7  > G   displayRecheckMenurevwaypointTypeselectedWPTypewpedit  !+   7   +  7 7 : +   7   7  +  7 7   T +   7   ' : +  7  ) ) ) ) ) ) > +   7  > G   displayRecheckMenurevwaypointTypeselectedWPTypewpedit  !+   7   +  7 7 : +   7   7  +  7 7   T +   7   ' : +  7  ) ) ) ) ) ) > +   7  > G   RecheckMenudisplayselectedWareType	ware  !+   7   +  7 7 : +   7   7  '   T +   7   +  7 7 : +  7  ) ) ) ) ) ) > +   7  > G   RecheckMenudisplayselectedWareType	ware  ,+   7   +  7 7 : +   7   7  'd   T +   7   'd : +   7   7  +  7 7  T +   7   +  7 7: +  7  ) ) ) ) ) ) > +   7  > G   displayRecheckMenuselectedAmountselectedMinAmount	ware  +   7   +  7 7 : +   7   7  '    T +   7   '  : +  7  ) ) ) ) ) ) > +   7  > G   displayRecheckMenuselectedMinAmount	ware  +   7   +  7 7 : +   7   7  'd   T +   7   'd : +  7  ) ) ) ) ) ) > +   7  > G   displayRecheckMenuselectedAmount	ware  ,+   7   +  7 7 : +   7   7  '    T +   7   '  : +   7   7  +  7 7  T +   7   +  7 7: +  7  ) ) ) ) ) ) > +   7  > G   displayRecheckMenuselectedMinAmountselectedAmount	ware Z+  7 7+  7 7'd  T+  7 +  7 7 :T(' T+  7 +  7 7:T'' T+  7 +  7 7:T(  T+  7 +  7 7:T+  7 +  7 7:+  7 7+  7 7 T+  7 +  7 7:+  7 7+  7 7 T+  7 +  7 7:+  7>G   display
Priceminpricemaxprice	ware L+  7 7+  7 7'd  T+  7 +  7 7 :T(' T+  7 +  7 7:T'' T+  7 +  7 7:T(  T+  7 +  7 7:T+  7 +  7 7:+  7 7+  7 7 T+  7 +  7 7:+  7>G   display
Priceminpricemaxprice	ware    T+  7+  77:T T+  7+  77:T+  7+  77:+  7>G   displayminpriceavgpriceavgmaxprice
Price	waremaxj +  7 7	  T+  7 ' :T+  7 '  :+  7>G   displayIsWPActive	bool  
 2  T+  7 :+  7 7+  7 7 T+  7 +  7 7:T+  7 :+  7 7+  7 7 T+  7 +  7 7:+ 7) ) ) ) ) )	 >+  7>G   displayRecheckMenuselectedMinAmountselectedAmount	ware 	 +  7 +  7 7:+  7 78+  7 7;+  7 7+  77;+  7 7+  7 7;+  7 7+  7 7+  7 76;+  7 78 T+  7 7% ;+  7 7'  ;+  7 7'  ;+  7 7'  ;T +  7 7+  7	7
+  7	76;+  7 7+  7	7;+  7 7+  7	7;+  7 7+  7	7;+  7 7+  7 7+  7 7;4 7+  ) % 3 2  ;+  7 7;2  ;+  7 7;;>+  7>G   cleanuptrader    gMT_Map_HomebaseSelectedcloseMenuForSectionHelperwp_actionret_arg
PriceDisplayAmountMinAmountselectedWareTypedisplay	wareNone SelectedselectedWPTyperevwaypointTypeIsWPActive	boolwaypointhomebasewp_stationwpedit 	 x+  7 7+  7 78;+  7 7+  77;+  7 7+  7 7;+  7 7+  7 7+  7 76;+  7 78 T+  7 7% ;+  7 7'  ;+  7 7'  ;+  7 7'  ;T +  7 7+  77	+  77
6;+  7 7+  77;+  7 7+  77;+  7 7+  77;+  7 74 7+  ) % 3 2  ;+  7 7;2  ;+  7 7;;;>+  7>G   cleanuptraderret_arg    gMT_Map_GetStationcloseMenuForSubSectionHelper
PriceDisplayAmountMinAmountselectedWareTypedisplay	wareNone SelectedselectedWPTyperevwaypointTypewp_stationIsWPActive	boolwaypointwpedit   +   7   7    T 
+   7   7    T +   7   7  
  T )  T)  H   isWareValidisWPTypeValidisStationValid	bool7 T  T+  7 +  7 +  7 +	  7	 	2
  2  2  2  :	:::
+  7) :+  7) :+  7+  7	7
8  T'  :+  7) :+  7) :+  7) :+  7	7  TY4 +  7	7> TR4 +  7	7% >  T+  7	4 (  '	 >:4 % >T?4 +  7	7% >  T+  7	4 (  '	 >:T/4 +  7	7% >  T+  7	4 (  '	 >:T4 7+  7	7+  7	7>+  7	78 T+  7	4 (  '	 >:T+  7	% :+  7) :+  77  T+  7	78  T2  +  7	78  T2  +  7	78  T	2  +	  7			7		8		4
 7
 
 %! >

 4
 7
 
 %! >

 4
 7
 
 %! >

 +
  7
	
4 7+  7	7+  7	7>:"
+
  7
 
+  7 +  7 +  7 +  74 7#   	 >:::::
+
  7
	
7

4 (  'p >
 T
4
 +  7	7%$ >

% T
+
  7

) :
T
+
  7

) :
+
  7
 
7



 ' 
 T
+
  7
 
7



 ' 
 T
+
  7
 
7



 ' 
 T
+
  7
	
4 (  ' >:
+  7	3' :&+  77  T4( 7)+  7	7&' >+  7 7 '  T+  7 7 '   T+  77  T4( 7)+  7	7&' >+  7 7 '   T+  77  T4( 7)+  7	7&' >+  7 7 '  T+  7 7 '  T+  77  T4( 7)+  7	7&' >+  7 7 '  T+  77  T4( 7)+  7	7&' >+  77  T4( 7)+  7	7&' >4( 7)+  7	7&' >+  7	' :*4+ +  7	7&>T		+  7	7
8
 T+  7	:	*A	N	   T+  7	' :*  T+  7 2  :,+  7 ' :-+  7	7.+  7	7&+  7	7*66+  7) :+  7) :+  7) :/4 (  '	 > T4 ''	d> T4 (  '	 > T+  7 4 70+	  7	 	7		>:,+  7) :Tc4 ''	e> T4 (  '	 > T+  7 4 704	 7	1	7	2	+
  7
 
7

+  7 7>	 = :,+  7) :TB4 ''	> T+  7 33 :,+  7) :+  7 ' :-+  7) :T+4 (  '	 > T%+  7 2 4	 (
  'p >	 <	 :,+  7) :+  7) :+  7) :/+  7 ' :-+  7 '  :4+  7 '  :5+  7 '  :64( 77+  7 7,'	 4
 (  ' >
 =  T>+  7 ' :-4+ +  7 7,>T
%8 4 (  ' > T4 (  'p > T49  %: > +  7 7  T+  7 :
-A
N
+  7 7,8; T+  7 ' :-+  7 7,84 (	  '
p > T+  7 ' :-  Th+  7 7,+  7 7-64 (  '	 > T+  7 7, '  T+  7) :<+  7) :+  7 '  :4+  7 '  :6+  7 '  :5+  7 '  :=+  7 '  :>T7+  7 7,+  7 7-64 (  '	p > T+  7 '  :4+  7 '  :6+  7 '  :5+  7 ' :-+  7 '  :=+  7 '  :>T4? %@ +  7 7,+	  7	 	7	-	6	>+  7 7A:A+  7 +  7 +	  7	 	4
9 +  7 7,+  7 7-6%B %C %D >
:D	:C:
B+  7	7
8	 T+  7 +  7 7C:>T+  7 +  7	7
8:>49 +  7 7,+	  7	 	7	-	6	%	E >+  7	7.+	  7			7	&	+
  7
	
7
*
6	
	6	  T	l+	  7			7	F	8		'
  
	 T	b4	 '
'>		 T	1+	  7	 	4
G 7
H
+  7	7F8+  7	7
8+  7	7F8!'  >
:
4	+	  7	 	4
G 7
H
+  7	7F8+  7	7
8+  7	7F8!'  >
:
5	T	.+	  7	 	4
G 7
H
+  7	7
8+  7 7A +  7	7F8!'  >
:
4	+	  7	 	4
G 7
H
+  7	7
8+  7 7A +  7	7F8!'  >
:
5	T	4	I +
  7
	
7

8

%J >	 	 T
-K T	++	  7	 	4
G 7
H
+  7	7
8+  7 7A +  7	7F8!'  >
:
4	+	  7	 	4
G 7
H
+  7	7
8+  7 7A +  7	7F8!'  >
:
5	T	4	I +
  7
	
7

8

%L >	 	 T
-M T	++	  7	 	4
G 7
H
+  7	7
8+  7 7A +  7	7F8!'  >
:
4	+	  7	 	4
G 7
H
+  7	7
8+  7 7A +  7	7F8!'  >
:
5	T	4	I +
  7
	
7

8

%N >	 	 T
-O T	++	  7	 	4
G 7
H
+  7	7
8+  7 7A +  7	7F8!'  >
:
4	+	  7	 	4
G 7
H
+  7	7
8+  7 7A +  7	7F8!'  >
:
5	T	a4	I +
  7
	
7

8

%P >	 	 T
-Q T	++	  7	 	4
G 7
H
+  7	7
8+  7 7A +  7	7F8!'  >
:
4	+	  7	 	4
G 7
H
+  7	7
8+  7 7A +  7	7F8!'  >
:
5	T	+4	 '
'>		 T	+	  7	 	'
d :
4	+	  7	 	4
G 7
H
+  7	7F8+  7	7
8+  7	7F8!'  >
:
5	T	+	  7	 	'
  :
4	+	  7	 	'
  :
5	+	  7	 	7	,	+
  7
 
7
-
6	
	4
 (  ' >
	
 T	>+	  7		)
 :
	+	  7			7	F	8		'
  
	 T	.+	  7		7		 	 T	)+	  7	 	4
R 7
S
+  7	7F8+  7 74 +  7 7A!'  >
:
6	+	  7	 	4
R 7
S
+  7	7F8+  7 75 +  7 7A!'  >
:
=	T	4	I +
  7
	
7

8

%J >	 	 T
+K T	)+	  7	 	4
R 7
S
+  7	7F8+  7 74 +  7 7A!'  >
:
6	+	  7	 	4
R 7
S
+  7	7F8+  7 75 +  7 7A!'  >
:
=	T	4	I +
  7
	
7

8

%L >	 	 T
+M T	)+	  7	 	4
R 7
S
+  7	7F8+  7 74 +  7 7A!'  >
:
6	+	  7	 	4
R 7
S
+  7	7F8+  7 75 +  7 7A!'  >
:
=	T	4	I +
  7
	
7

8

%N >	 	 T
+O T	)+	  7	 	4
R 7
S
+  7	7F8+  7 74 +  7 7A!'  >
:
6	+	  7	 	4
R 7
S
+  7	7F8+  7 75 +  7 7A!'  >
:
=	T	u4	I +
  7
	
7

8

%P >	 	 T
+Q T	)+	  7	 	4
R 7
S
+  7	7F8+  7 74 +  7 7A!'  >
:
6	+	  7	 	4
R 7
S
+  7	7F8+  7 75 +  7 7A!'  >
:
=	T	A+	  7		7		 	 T
<4	 '
'>		 T	6+	  7	 	4
R 7
S
+  7	7F8'  >
:
6	+	  7	 	'
d :
4	+	  7	 	4
R 7
S
+  7	7F8+  7 75 '  >
:
=	+	  7		)
 :
	+	  7	 	'
 :
-	T	+	  7	 	'
  :
6	+	  7	 	'
  :
=	+	  7		)
 :
	G   
floor	mathliquid	ionsenergyioncellscontainerchemicalcompounds	bulknividiumCheckSuitableTransportType
roundHelper
cargotransportmaxpriceavgpriceminpricevolume
waresGetLibraryEntry
PriceMinAmountstationchangedfuelcells	nameGetWareData	NoneinsertDisplayAmountselectedMinAmountselectedAmount  fuelcellsSymmetricSetdeepcopyisFlyTowaypointTypeselectedWareTypedisplayipairsselectedWPTyperemove
table  revwaypointTypeplayer
ownerCompareStationWarelistwprange	shipRemoveWareswarelisttraderhomebaseGetStationRange
LibMTisenemytradesubscriptionGetComponentDataNOT A STATION WAS FIREDDebugErrorReadTextsubtitle3stationIsComponentClassstring	typewp_stationisWareValidisWPTypeValidisStationValidwaypointwpeditisWayPointValidshipCanRefuelplayerstation	boolshipallshiptradeshipprodshipres	ware   8A3   3 : 2  2  2  1 1 : 1 : 1	 : (  :
 1 : 1 : 1 : 1 : 1 :1 :1 :1 :1 :1 :1  :1" :!1$ :#1& :%1( :'1* :)1, :+1. :-10 :/12 :114 :315 :17 :6 >0  G   RecheckMenu  mapSelect SelectHomebase SetAmount SetActive SetPrice DecPrice IncPrice DecAmount IncAmount DecModifierType IncModifierType DecWareType IncWareType IncWPType DecWPType 	Done 	Back onCloseElement onSelectElement onRowChanged onUpdateupdateInterval display onShowMenu cleanup transparent g a r b  	name'gMT_Station_Logistics_EditWaypointstatusWidthstatusHeight LJx   4      T2   5   4  7  4  +  > 4     T4  7  +  > G  registerMenuHelperinsert
table
Menus4   +   )  :  +   )  : G  wplistbuttons  &+   2  :  +   +  78: +   +  78: +   7   +  788: +   7   +  78: +   7   +  78  T2  : +   7   2 +  788;+  788;+  788;+  7 7;: +   7   4	 (  ' >: +   7   4	 (  ' >:
 +   7   2 4	 (  ' >;4	 (  ' >;4	 (  ' >;4	 ''d>;4	 ''e>;4	 (  ' >;4	 ''> < : +   7   +  7 78: +   7   +  7 78: +   7   +  7 78: +   7   +  7 78: +   7   +  7 78: +   7   +  7 78: +   7   +  7 78: +   7   +  7 78: +   7   +  7 78	: +   7   +  7 78
: +   7   +  7 78: +   7   2  : +   7   +  7 78: +   7   +  7 78: +   7   7    T 4  7  +  7 7+  7 78+  7 7> 4  +  7 7> T;ANT +   7   7    T 4  7  +  7 7+  7 78> 4  7  +  7 7+  7 78+  7 7> +   7   '
 :  +   7   7  '   T +   7   7  '   T +   7   ' :  T 
+   7   7  '   T +   7   '( :  '   4 +  7 7>T8	+  7 7 T+  7 76'  ;
  +  7 7   T+  7 76' ;
T+  7 76' ;
AN+  3" +  7:#2  :$:!+  7%) >G  display	dataidx  selectedRowmaxwaypointsremoveeditwaypointipairsinsert
tableaddwaypoint
TrackDbgLvltracklog
numwp
index
statsactivitylogcrewscore
levelwaypointscargolisthomebase	shipwaypointTypesubtitleReadText
titleret_argwaypointtraderactionselrow
paramtoprowwplist  	 4  7  ) % ' ' ' 'd 4	  7		4
  7

) 4  74  74  74  7@ headerRow1WidthheaderRow2HeightheaderRow2OffsetyheaderRow2OffsetxstandardFontSizestandardFont	leftcreateFontStringHelper  	2	  T4  7  ) % ' ' ' '	d 4
  7

4  7) 4  74  74  74  7@ T4  7  ) % ' '  '  '	d 4
  7

4  7) 4  74  74  74  7@ G  headerRow1WidthheaderRow2HeightheaderRow2OffsetyheaderRow2OffsetxstandardFontSizestandardFont	leftcreateFontStringHelper      )  H   (K4  7+  >% +  77 T4 (  ' > T4 +  77% > 2 4  7	+  77
% +  77$) % ' ' '	 '
d 4  74  7) 4  74  74  74  7> < 3 4  7;2  2  4 (  ' >% 4 +	  7		7		%
 >%	 4
 (  ' >
%  $1 4 7	 4
 
 7

 % >)   >
 =4 7	 4
 
 7

 2  4  7) '  >
 =2  4	 7		
 4  7 % >)   > =	4	 7		
 4  7 2  4  7) '  > =	2	  4
 7

	 4  7 % >)  ' > =
4
 7

	 4  7 % >)  ' > =
4
 7

	 4  7 4 (  ' > = )  ' > =
4
 7

	 4  7 4 (  ' > = )  ' > =
4
 7

	 4  7 4 '' > = )  ' > =
4
 7

	 4  7 4 ''- > = )  ' > =
4
 7

	 4  7 4 ''> = )  ' > =
4
 7

	 4  7 4 (  ' > = )  ' > =
4
 7

 4  7	 2  4  7) '  > =
4
 7
 
+   2 ;  2  ;>
'< 2  2  2  4! +  77">T1# 8
2  4 7 4  7 %  >)  ' > =4 7 4  7 %$ 4%  >$ >)  ' > =4 (  ' >4& 8>' T4( 8%) >  T4 8% > +  77*86  T4 (  'p >4 7 4  7    >)  '  > =8  T4 (  'p >4 7 4  7   ! >)   '! > =8  T4 (  'p >4 7 4  7  ! " > )!  '" > =4 (  ' >8+ T4, 8% > T4 (  ' > 4 7 4   7! " # >!)"  '# > =2 4 '!N'  >;4 '!N' e >;4 '!N' > < 4 7 4  !  7  " 8#	6##$ >")#  '$ >  =2 4 ' '!:
>;4 ' '!9
> < 8
	 T4 7  4! "! 7!!# 8$$$6$$% >#)$  '% >! =T4 7  4! "! 7!!# 4$ (%  '& >$% >#)$  '% >! =4 7  4! "! 7!!# 3$- ;$4%  7%%)& ''  >! =AN2  4 7 4  74 (  ' >)  ' > =4 7 4  7 3. 3/ ;4  7) '  > =30 4  7;   T
+  +  728:1+  +  728:34 74+     ) )  +  71+  73>+  )  :1+  )  :3+  2  :54 7+  754  764 (  ' >+ 77+ 77% > =4 7+  754  764 (  ' >+ 78+ 78% > =4 7+  754  764 (  ' >+ 79+ 79% > =4 7+  754  764 (  ' >+ 7:+ 7:% > =4 7+  754  764 ''m
>+ 7;1< %= > =4 7+  754  764 (  ' >+ 7>+ 7>%? > =4 7+  754  764 (  ' >+ 7@+ 7@%A > =4 7+  754  764 (  ' >+ 7B+ 7B%C > =4 7D+  +  75  >+  +  +  4  7H+  
   ) >:G:F:E4!  >T >AN+  :I4  7J>0  G   releaseDescriptors	rowsdisplayThreeTableViewbuttontableselecttableinfotablecreate_standard_button_bar INPUT_STATE_DETAILMONITOR_X	Done INPUT_STATE_DETAILMONITOR_YEditWaypoint#INPUT_STATE_DETAILMONITOR_BACKAddWaypoint INPUT_STATE_DETAILMONITOR_B 	Back
PasteCutMoveDownMoveUpBarButtonbuttonscreate_bodyselrow
paramtoprow	   <dddK     Add New Waypoint  existsGetWareDataNone SelectedwaypointTypestationIsComponentClassstring	typetostring	WP:  waypointsipairscreate_column_header!defaultHeaderBackgroundColorRow	Cell
LibMTinsert
table 	 -- 	ship: 	   <dddK standardTextHeightheaderRow1WidthheaderRow1HeightheaderRow1OffsetyheaderRow1OffsetxheaderRow1FontSizeheaderRow1Font	leftsubtitle - 
titlecreateFontString	nameGetComponentDataReadText	nonehomebasewplistremoveAllButtonScriptsHelper  +  7  T+  7: +  7: +  7:% 4 (  ' >+  77  T@+  7784 (  ' > T4	 +  778%
 > 4 (  ' >% +  778% 4	 +
  7

7

8

%
 >	 	 T
%	 %
 +  77+  7786% +  778% +  778%  $ T% T4 (  ' > 4 7+  7' ' 	 )
  >% % % % 8	4
 (  ' >
	
 T	% T	4	 8
8

>		 T	8	8	T	4	 8
8

%
 % % % >	  
 	 4	 7		+
  7

' ' 4 (  ' >%  %  %  %  $)  >	4	 
	 7		+     >	G  CheckButtonBarAvailability
LibMT/
  -  	:-  clustersector	zonestring	typeinfotableupdateCellTextHelperwaypointTypeGetComponentData - : 	nameGetWareDatawp_paste_bufferReadText	dataidxselectedRowwaypoint_indexwplistdefaulttable     G  t     T4 7+  >+  7>T+  7>G   	BackcleanupcloseMenuAndCancelHelper
close  84   7  +  77+  77> 4  7+  77+  77   >4 +  77>T;AN+  4 +  7	>:+  +  77 :
+  7+  7
 T+  +  7
 :+  7>G  displayidxselectedRowselrowdefaulttableGetTopRowtoprowipairsinsertwaypoint_indexwaypointswplistremove
table  74   7  +  77+  77> 4  7+  77+  77   >4 +  77>T;AN+  4 +  7	>:+  +  77 :
+  7
'  T+  +  7
:+  7>G  displayidxselectedRowselrowdefaulttableGetTopRowtoprowipairsinsertwaypoint_indexwaypointswplistremove
table 	 =88
	  T
7  4 77  77  7>:T
4 77  77  7>7  )  :4 7  7>T;AN7  77  7  T7  7  7 :4 7	 >: 7  7:
 7 7
  T7
 : 7 >G  displayselrowdefaulttableGetTopRowtoprowipairswaypoint_indexwaypointsremove
tablewp_paste_bufferwplist   C+   7   7     T=+   7   7  '   T +   7   ' : 4  7  +  7 7> 5  4  7  +  7 7+  7 74 > 4 	 +  7 7> T;AN+   4 +  7>:
 +   +  7 7: +   7 
 +  7  T +   +  7 :
 +   7  > G  displayselrowdefaulttableGetTopRowtoprowipairswaypointsinsert
tabletemp_wpdeepcopy
LibMTwaypoint_indexwp_paste_bufferwplist  	 +   7   7  % ; 4  7  +  ) % 3 2  ;+  7 7;2  ;+  7 7;2  ;> +   7  > G  cleanuptrader    gMT_ShipMenu_configreturncloseMenuForSectionHelpernochangesret_argwplist   +   7   2  : 4  7  +  7 7+  7 7> 4  7  +  7 7+  7 7> 4  7  +  7 7+  7 7> 4  7  +  7 7+  7 7> 4  7  +  7 7+  7 7> 4  7  +  7 7+  7 7	> 4  7  +  7 7+  7 7
> 4  7  +  7 7+  7 7> 4  7  +  7 7+  7 7> 4  7  +  7 7+  7 7> 4  7  +  7 7+  7 7 > 4  7  +  7 72  > 4  7  +  7 7+  7 7> 4  7  +  7 7+  7 7> +   7   7  % ; 4  7  +  ) % 3 2  ;+  7 7;2  ;+  7 7;2  ;> +   7  > G  cleanup    gMT_ShipMenu_configreturncloseMenuForSectionHelperupdateshipret_arg
TrackDbgLvl
index
statsactivitylogcrewscore
levelwaypointscargolisthomebase	shipinsert
tabletraderwplist  	:4   +  7> +  773 +  77;4 (  'p >;4 (  ' >;4 (  ' >;+  77% ;4 7	+  ) %
 2 ; ;2  ;+  77;2  ;+  77;;>+  7>G  cleanuptrader gMT_WPListMenu_editwaypointcloseMenuForSectionHelperaddwaypointret_argReadText           waypoint_indexwplistdefaulttableGetTopRow  	 -4   +  7> +  77+  77+  776+  77% ;4 7+  ) %	 2 ; ;2  ;+  77;2  ;+  77
;;>+  7>G  cleanuptrader gMT_WPListMenu_editwaypointcloseMenuForSectionHelpereditwaypointret_argwaypointswaypoint_indexwplistdefaulttableGetTopRow@   
8  T'   T) T) H Add New WaypointY   8  T7 7   T) T) H waypointswplistAdd New Waypoint]   8  T7 7 '    T) T) H waypointswplistAdd New Waypointq   7  7
  T7  7 7  7  T) T) H maxwaypointswaypointswp_paste_bufferwplistQ   7  7 7  7  T) T) H maxwaypointswaypointswplistn  8  T
7 7 '   T88
  T) T) H waypointswplistAdd New Waypoint     ) H   ' 42   2  3  3 :1 1 :1 :1	 :1 :
1 :1 :1 : 1 : 1 : 1 : 1 : 1 : 1 : 1 : 1  :1! :1" :1# :1$ :1% :1& : >0  G          EditWaypoint AddWaypoint 	Done 	Back 
Paste Cut MoveDown MoveUp onCloseElement onSelectElement onRowChanged display onShowMenu cleanup transparent g a r b  	name(gMT_Station_Logistics_ListWaypointsstatusWidthstatusHeight LJx   4      T2   5   4  7  4  +  > 4     T4  7  +  > G   registerMenuHelperinsert
table
Menus[   +   )  :  +   )  : +   )  : +   )  : G   ret_expcrewdataobject
title 	
    T4  +  7 >4 7+  ) % 2 4 ;4 ;+  7;+  7;2  ;2  ;>+  7	>G   cleanupret_expcrewdataselrowtoprow!gMT_ReportMenu_rename_returncloseMenuForSectionHelperobjectSetComponentNameP   4   7  +  7' ' > G   selecttableconfirmEditBoxInputHelper  
  4   7  +  7' ' > 4   7  +  ) % 2 4 ;4 ;+  7;+  7;2  ;2  ;> +   7 	 > G   cleanupret_expcrewdataselrowtoprow!gMT_ReportMenu_rename_returncloseMenuForSectionselecttablecancelEditBoxInputHelper  @+   +  78:  +   +  78: +   +  78: +   +  78: +   +  78: 4  +  7% ) > 4 +  7%	 %
 >   T+  4   %	 >%  T T4 ''8 >$:T
+   T T4 ''8 >:4 7+  >4 +  7% % >7 2 4	 7		)
  4 7% )  ' ' ' 'd >) >	;	4	 7		+
  7

  T% T%  % $$

) % ' ' ' 'd 4 74 7) 4 74 74 74 7 >	 <	  )	  3
! ) 4 7">7# 2 4	 7	$	>	 <	 )	  3
% >7& 3) 4	 7	'	4
 7
(
>	;	4	 7	'	4
 7
*
>			;	)	 )
 ) ' ' >4 7+  > 7 2	 4
 7
+
4 7, % 4 7-4 7.' ' ' 'd >	) '  '  'p' * ) >

 <
 >7& 3	/ )
 ) ) ' '  '  4 70* ' >4 7+	  > 7	 2
 4 7$>;
4 74 7,4 '' >%1 4 7-4 7.' ' ' 'd >	)  ) ) '  '  ' ' )  4 72%3 ) > =	;
4 7$>;
4 74 7,4 ''@ >%1 4 7-4 7.' ' ' 'd >	)  ) ) '  '  ' ' )  4 72%4 ) > =	;
4 7$> < )  35 ) +  76>7&	 3
7 ) ) ) ' ' '  ' >
+	  +
  +  4 7;+     ) >:::9
:8	4	 7	<	+
  )  +  79' ' + >	4	 7	=	+
  )  +  7:' ' + >	4	 7	=	+
  )  +  7:' ' + >	+	  )
 :
>	4	 7	?	>	G   releaseDescriptorsactivateEditBoxsetButtonScriptsetEditBoxScriptdisplayThreeTableViewbuttontableselecttableinfotable   transparent  "INPUT_STATE_DETAILMONITOR_ESC INPUT_STATE_DETAILMONITOR_AcreateButtonHotkeycentertableOffsety   standardFontSizestandardFontcreateButtonTextcreateEditBoxheaderCharacterIconSize    standardButtonWidthscaleXcreateCustomWidthTable  getEmptyCellDescriptoraddTitleRow defaultTitleBackgroundColor  headerRow1WidthheaderRow1HeightheaderRow1OffsetyheaderRow1OffsetxheaderRow1FontSizeheaderRow1Font	left %) (createFontStringmenu_infocreateButtonIconcreateButtonaddSimpleRowrevealpercentisplayerownedcreateTableSetupHelperReadText - 
title
owner	nameGetComponentDatacontainerGetContextByClassobjectret_expcrewdataselrow
paramtoprowJh   +   7      T
+   )  :  4  7   +  7' ' > G   selecttableHelperactivateEditBox     G   
 #   T4 7+  >+  7>T4 7+  ) % 2 4 ;4 ;+  7;+  7	;2  ;2  ;>+  7>G   ret_expcrewdataselrowtoprow!gMT_ReportMenu_rename_returncloseMenuForSectioncleanupcloseMenuAndCancelHelper
close   3   3 : 3 : 1 1 : 1 1	 1
 1 : ' : 1 : 1 : 1 :  >0  G   onCloseElement onSelectElement onUpdateupdateInterval onShowMenu    cleanup red g adrb 
white gadrb 	name!gMT_Station_Logistics_Rename LJx   4      T2   5   4  7  4  +  > 4     T4  7  +  > G  registerMenuHelperinsert
table
Menus[   +   )  :  +   )  : +   )  : +   )  : G  exp_retreportexpandbuttons  T+   2  :  +   +  788  T'  : +   +  788  T'  : +   +  788: +   7   4 (  ') >: +   7   4 (  '* >: +   7   +  78  T2  : +   7   +  78  T2  :	 +   7   +  78  T2  :
 +   3 +  7:2  :: +   2  : +   7  ) > G  displayexp_ret	dataidx  selectedRow	shipcls_crewassigned_shipssubtitleReadText
titleexpandselrow
paramtoprowreport=  	4   7+    ) ) >G    ToggleRow
LibMT=  	4   7+    ) ) >G    ToggleRow
LibMT=  	4   7+    ) ) >G    ToggleRow
LibMT     )  H       )  H  /?_	4  7+  >4  2  :4  )  :+  2  :4 7+  +  773
 +  77	;>2 4 '!N' >;4 '!N'e >;4 '!N'> <  2  4 +  77>T-4
 8	% % % >
 
 T4 
 % >  T4 7 
 >  T4  % >  T4 7  >  T4  % >  T4 7  >AN4 77+  77 >2  2  +  77 '	  	 T34 +	  7		7		>T+% 4 8> T8T4 8% > 6  T
2  982  94 76 >4 8% % % >2 ;;;4 762 ;;>AN '	  	 T4 	 >D BN'< 			2
  2  3 4  7;'  '  +  77 '   T$4  >D'  4 6>DBN4  7 +  
 >  T+  7!  T+  7!6  T	+  7!6'    T) T) 4 7+  7"   T' T'  >4 7#+  7">2    T%$ T%% 1& 4'  >% % % % ( T
4 68% ) %!* %"+ >     %,   %!, " $"4 7 4  !  7 - " # '$ '%   % T%)% T&)% >  =4 7 4  !  7 . " )#  '$ >  =4 7 4  !  7 . " )#  '$ >  =4 7
 4  !  7 / " 3#0 4$  7$1$)% & >  =+  :
2  T+  7!  T+  7!6'   T	4  73+   !
 )" )# >T+  7!  T4  74+   !
 )" )# >  Tm4 6>T!g2#  4$ %$ 7$ $+&  '
 ''>$ $ T%+$  7$!$ $ T%+$  7$!$6$$ $ T%	+$  7$!$6$$'%   %$ T$)$ T%)$ 4% 7%%+&  7&"&'  $ T('( T)'(  >%4% 7%#%+&  7&"&'>%8%"&%  $ T'%'$ T(%'% 1(5 4) 7))*# 4+ ,+ 7+-+-' .( '/ '0   0& T0)0 T1)0 >+ =)4) 7))*# 4+ ,+ 7+.+%-6 4. 8/"8//%0 >.$-.-).  '/ >+ =)4) (* '+p >)8*"8**	* T*4* '+',>*)* 8*"8**	* T*4* (+ ',q >*)* 4* 7**+# 4, -, 7,.,4.' 8/"8//6//>.)/  '0 >, =*4* 7**+# 4, -, 7,.,.) )/  '0 >, =*4* 7**+# 4, -, 7,.,8."8..)/  '0 >, =*4* 7**+
 4, -, 7,/,.# 3/7 ;"/40  7010)1 2& >, =*+*  :
2* $ T*+*  7*!* * T++*  7*!*6**'+  +* T*4* +* 7*3*+,  -
 ). )/ >*4* 7**++  7+"+, '- >*T*+*  7*!* * T+4* +* 7*4*+,  -
 ). )/ >* $ T*4* +% >*T-2/  40 7001/ 42 32 72.2%4 )5  '6 >2 =040 1. %2 >041 7112/ 43 43 73.3%58 60 $565)6  '7 >3 =141 2. %39 >142 3. %4: >243 7334/ 45 65 75.571 )8  '9 >5 =343 4. %5 >344 (5 '6, >4 3 T5&2; T5	45 75<585546 76=6873>66465T52> T5	45 75<585546 76=6873>66465T52 T5	45 75<585546 76=6873>66465T545 (6 '7, >545 45 7556/ 47 87 77.794 ):  '; >7 =545  75?546 7. %8@ >666'7  >546 7667/ 48 98 78.8+: 7:A:;5 >:);  '< >8 =646 7667
 48 98 78/8:/ 3;B ;.;;3;4<  7<1<)= '>  >8 =6A-N-lA!N!~BN}T2  4 7 4  7.%C )  ' > =4 7
 4  7/ 3D 4  71) '  > =+  :
2 '   T('  4  >TAN4  7 +  
 >  T+  7!  T+  7!6  T	+  7!6'    T) T) 4 7+  7"   T' T'  >4 7#+  7">2    T%$ T%% 1E 4 ( ' >4 7 4  7-  ' '    T) T) > =4 7 4  7. )  ' > =4 7
 4  7/ 3F 4  71)  > =+  :
2  T+  7!  T+  7!6'   T	4  73+  
 ) ) >T+  7!  T4  74+  
 ) ) >  T4  >T2  4 7 4  7.% )   '! > =4  % >4 7 4  7.% G ! $ ! )!  '" > =4  %9 >4  %: >4 7 4  !  7 . " )#  '$ >  =4  %  >4 (  '!, >  T &; T 	4  7 < 8  4! 7!=!8">!6! T > T 	4  7 < 8  4! 7!=!8">!6! T  T 	4  7 < 8  4! 7!=!8">!6! T 4  (! '", >   4  7  ! 4" #" 7"."$ )%  '& >" = 4   7 ? 4! " %#@ >!!!'"  > 4! 7!!" 4# $# 7#.#+% 7%A%&  >%)&  '' ># =!4! 7!!"
 4# $# 7#/#% 3&H ;&;&4'  7'1')( ')  ># =!ANl+  :
2+  )  :!   T
+  +  7J8:I+  +  7J8:K4 7L+  
   ) ) 	+  7I+  7K>+  )  :I+  )  :K+  2  :M4 7+  7M4  7N> =4 7+  7M4  7N> =4 7+  7M4  7N> =4 7+  7M4  7N> =4 7+  7M4  7N4 ''m
>+ 7O1P %Q > =4 7+  7M4  7N4 ( '>+ 7R1S %T > =4 7+  7M4  7N4 ( '- >+ 7U+ 7U%V > =4 7+  7M4  7N4 ( '. >+ 7W+ 7W%X > =4 7Y+  +  7M 	 >+  +  +  4  7]+     ) >:\:[:Z4  >T >AN4  7^>0  G   releaseDescriptorsdisplayThreeTableViewbuttontableselecttableinfotablecreate_standard_button_bar INPUT_STATE_DETAILMONITOR_XSelect INPUT_STATE_DETAILMONITOR_Y
Train#INPUT_STATE_DETAILMONITOR_BACK AdminLog INPUT_STATE_DETAILMONITOR_B 	BackBarButtonbuttonscreate_bodyselrow
paramtoprow  notcrew        unusedcrew	none   	noneNo Ships  	crewcreateStarsTextcombinedskill
rounddefencecontrolget_entity_rank
Rankscommandertypestringtypename          	ship	     CollapseRowExpandRow	rows!defaultHeaderBackgroundColor  station	noneRow	CellButtonCell - clustersector	zone	nonetostring +-removeexp_retexpandIsExpanded    standardButtonWidth
pairs	namestring	typecls_crewDifferenceSetinsert
table$XRCLSGetNPCBlackboardengineerdefencenpc
pilotGetComponentDataassigned_shipsipairsReadText   subtitle
titlereportcreate_standard_header
LibMTrowDataMapcurrentTableRowDatacurrentTableRowremoveAllButtonScriptsHelper( K+  7  TF+  7: +  7:4  7+     >% 8 T8
  T88884 (  '/ >%	 4
 	 )
 ' ) >$T4 (  '0 > 8 T84  % ) >4 (  ' >% 4 	 %
 >$4 7+  7' '  )	  >G  infotableupdateCellTextHelper	nameGetComponentData:  containerGetContextByClassnotcrewConvertIntegerString: ReadText	crewCheckButtonBarAvailability
LibMT	dataidxselectedRowdefaulttable     G       T
4 7+  ) % >+  7>T+  7>G   	BackcleanupgMT_Admin_closecloseMenuForSectionHelper
close  
 +     7   > 2 ; ;+ 7;4 7+ ) % 3 2	  ;	;>+ 7>G  cleanup  gMT_ReportMenu_backcloseMenuForSectionHelperexp_retGetExpandState  	 +     7   > 2 ; ;+ 7;+ 774 7+ ) % 3	 ;	;	2
  ;
	2
  ;
	>+ 7>G  cleanup    gMT_ReportMenu_crewskillscloseMenuForSectionHelper	dataselectedRowexp_retGetExpandState  	 !+     7   > 2 ; ;+ 7;+ 774 7+ ) % 3	 2
  ;
	;	2
  ;
	2
  ;
	2
  ;
	>+ 7>G  cleanup    gMT_ReportMenu_adminlogcloseMenuForSectionHelper	dataselectedRowexp_retGetExpandState  	 "+     7   > 2 ; ;+ 7;+ 77884 7+ ) % 3	 2
  ;
	;	2
  ;
	2
  ;
	;	>+ 7>G  cleanup    gMT_ReportMenu_shiplogcloseMenuForSectionHelper	dataselectedRowexp_retGetExpandState(   8  T) T) H 	shipH   8  T8 T8  T) T) H notcrew	crew  		 $2   +  7   T4 +  7 >T7  T4 7  ' >T4 7  '  >AN4 +  7>4 7    F currentDefaultTableRowHelperdefaulttableGetTopRowinsert
tableexpandedipairsexpandStates  4  7%   >4  7%   >$4 7 ) % ' ' '  '	d 4
 7

' @
 starFont	leftcreateFontStringHelper*repstring
   '2   2  2  3  3 :1 1 :1 :1	 :1 :
1 :1 :1 : 1 : 1 : 1 : 1 :1 :1 :1 : >0  G   createStarsText GetExpandState   Select AdminLog 
Train 	Back onCloseElement onSelectElement onRowChanged display onShowMenu cleanup transparent g a r b  	name"gMT_Station_Logistics_ReportsstatusWidthstatusHeight LJx   4      T2   5   4  7  4  +  > 4     T4  7  +  > G  registerMenuHelperinsert
table
MenusV   +   )  :  +   )  : +   )  : +   )  : G  	shipexpand	rowsbuttons  A+   2  :  +   +  788  T'  : +   +  788  T'  : +   +  788  T3 : +   7   4 (  ' >: +   7   4 (  'e >: +   7   +  78  T2  :	 +   3 +  7:2  ::
 +   7  > G  display	dataidx  selectedRowassigned_shipssubtitleReadText
title    expandselrow
paramtoprow	ship=  	4   7+    ) ) >G    ToggleRow
LibMT9  4   7+    ) >G    ToggleRow
LibMT     )  H  $ .O4   7  +  > 4   2  : 4   )  : +   2  : 4  7  +  +  773
 +  77	;> 2 4 '!N' >;4 '!N'e >;4 '!N'> <  +  74 % >:+  74 7+  773 >:+  74 7+  77% ' >:+  74 7+  77>:2  2  2  2  4 +  77>T
4 7 8>A
N
+  77 '   T+  74 77+	  7		7		
 >:4 +  77>T
8'   T4 7  >T4 7  >A
N
+  74 77	 
 >:'< 2	  2
  3 4  7;4  7+  	 >  T+  7  T+  78  T	+  78'    T) T) +  77 2    T% T%  1! 4 ( 'f >%" +  77   T'  %# $4 7 4  7$  ' +  77 '    T) T) > =4 7 4  7% )  ' > =4 7 4  7%4 ( 'g >)  ' > =4 7 4  7%4 ''>)  ' > =4 7 4  7%4 ( 'o >)  ' > =4 7 4  7%4 ( 'j >)  ' > =4 7	 4  7& 3' 4  7()  > =+  :	)  T+  7  T	4  7*+  	 ) ) >T+  7  T4  7++  	 ) ) >2    T4 +  77  T2  >T{2  %, 4- 8>. T8T4/ 8%0 > 4 7 4  7%%, )  ' > =4 7 4  7%%1 4/ 8% 0 >$)  ' > =4 7 4  7% )  ' > =4 ( 'p >8	 T4 ''> 8	 T4 ( 'q > 4 7 4  7%42 86>)  '  > =4 7 4  7% )  '  > =4 7 4  7%8)  '  > =4 7	 4  7& 33 ;4   7 ( )! '"  > =AN4  7+  	 >  T+  7  T+  78  T	+  78'    T) T) +  77 2    T% T%  14 4 ( 'k >%" +  77 %# $4 7 4  7$  ' +   7  7     '!   !  T )  T!)  > =4 7 4  7% )  ' > =4 7 4  7%%, )  ' > =4 7 4  7%%, )  ' > =4 7 4  7%%, )  ' > =4 7 4  7%%, )  ' > =4 7	 4  7& 35 4  7()  ! > =+  :	)  T+  7  T4  7*+  	 ) >T+  7  T4  7++  	 ) >2    Tk4 +  77>Tc2  4 76  >4$ 7$$% 4& '& 7&%&%(, ))  '* >& =$4$ 7$$% 4& '& 7&%&%(1 4)/ * %+0 >)$()())  '* >& =$4$ 7$$% 4& '& 7&%&%(, ))  '* >& =$4$ 7$$% 4& '& 7&%&4(2 6)">())  '* >& =$4$ (% '&p >$4% 7%%& 4' (' 7'%')$ )*  '+ >' =%4% 7%%& 4' (' 7'%'%), )*  '+ >' =%4% 7%%&	 4' (' 7'&') 3*7 2+ ;+;+*4+  7+(+), '-  >' =%AN+  :	)+  )  :4 78+  	 
  ) )  !"+#  7#9#+$  7$:$>+  2  :;4 7+  7;4  7<> =4 7+  7;4  7<4 (  '!l >+  7 = +! 7!=!%", > =4 7+  7;4  7<4 (  '!m >+  7 > +! 7!>!%", > =4 7+  7;4  7<4 (  '!g >+  7 ? +! 7!?!%", > =4 7+  7;4  7<4 ' '!m
>+  7 @ 1!A %"B > =4 7+  7;4  7<4 ' '!">+  7 C +! 7!C!%"D > =4 7+  7;4  7<4 ' '! >+  7 E +! 7!E!%"F > =4 7+  7;4  7<4 (  '!n >+  7 G +! 7!G!%"H > =4 7I+  +  7;  >+  +  +  4  7M+   !  " # )$ >:!L: K:J4 
 >T!  >!AN4  7N>0  G   releaseDescriptorsdisplayThreeTableViewbuttontableselecttableinfotablecreate_standard_button_bar INPUT_STATE_DETAILMONITOR_XSelect INPUT_STATE_DETAILMONITOR_Y
Start#INPUT_STATE_DETAILMONITOR_BACKAdd INPUT_STATE_DETAILMONITOR_B 	BackHomebase	StopRemoveBarButtonbuttonsselrowtoprowcreate_body  newget_crew_level  header	none   activetostring   	nameGetComponentDatastring	typeCollapseRowExpandRow	rows!defaultHeaderBackgroundColor  header	noneRow	CellButtonCell) ( +-expandIsExpanded   FF standardTextHeight
UnionDifferenceSetinsert
tableassigned_shipsipairsremove_ships_with_no_crew
cargofilter_ships_bydrones	  commanderplayershipship_sship_mship_xs
dronebattleshipcvfilter_shipsplayerGetContainedShipsByOwner
shipsReadText   subtitle
title	shipcreate_standard_header
LibMTrowDataMapcurrentTableRowDatacurrentTableRowremoveAllButtonScriptsHelper
  a+  7  T\+  7: +  7:8 TC4 88% % % >4	 '!N'->%
  %	 4
	 '!N' >
%
  % 4	 '!N'e >%
  $4 7+  7'	 '
  4 77>4 88%	 >  T+  7)	 :	4 7+	  7		'
 ' % 4 77>T+  7)	 :	T	4 7+  7' ' % )  >4  7+     >G  CheckButtonBarAvailabilityredSHIP HAS NO CAPTAIN!!!hascaptain	ship
pilot
whitecolours
LibMTinfotableupdateCellTextHelper - : ReadTextclustersector	zoneGetComponentDataheader	dataidxselectedRowdefaulttable     G       T
4 7+  ) % >+  7>T+  7>+  7>G   	BackcleanupgMT_Admin_closecloseMenuForSectionHelper
close  	 +     7   > 4 7+ ) % 3 2  ;2 ; ;;;>+ 7>G  cleanup  gMT_ShipMenu_backcloseMenuForSectionHelperGetExpandState  
	 $+     7   > +     7  > 3 ; ;;4 7+ ) % 2 ; ;2	  ;	;2	  ;	+	 7		7		;	2	  ;	>+ 7>G  cleanuptrader	shipgMT_ShipMenu_addshipcloseMenuForSectionHelper     addshipGetExpandStateTrader  
	 $+     7   > +     7  > 3 ; ;;4 7+ ) % 2 ; ;2	  ;	;2	  ;	+	 7		7		;	2	  ;	>+ 7>G  cleanuptrader	shipgMT_ShipMenu_removeshipcloseMenuForSectionHelper     removeshipGetExpandStateTrader  
	 $+     7   > +     7  > 3 ; ;;4 7+ ) % 2 ; ;2	  ;	;2	  ;	+	 7		7		;	2	  ;	>+ 7>G  cleanuptrader	shipgMT_ShipMenu_configcloseMenuForSectionHelper     configshipGetExpandStateTrader  
	 $+     7   > +     7  > 3 ; ;;4 7+ ) % 2 ; ;2	  ;	;2	  ;	+	 7		7		;	2	  ;	>+ 7>G  cleanuptrader	shipgMT_ShipMenu_startshipcloseMenuForSectionHelper     startshipGetExpandStateTrader  
	 $+     7   > +     7  > 3 ; ;;4 7+ ) % 2 ; ;2	  ;	;2	  ;	+	 7		7		;	2	  ;	>+ 7>G  cleanuptrader	shipgMT_ShipMenu_stopshipcloseMenuForSectionHelper     stopshipGetExpandStateTrader  
	 $+     7   > +     7  > 3 ; ;;4 7+ ) % 2 ; ;2	  ;	;2	  ;	+	 7		7		;	2	  ;	>+ 7>G  cleanuptrader	shipgMT_ShipMenu_gethomebasecloseMenuForSubSectionHelper     map_callGetExpandStateTrader'   8  T) T) H new>   8  T88'   T) T) H active?   8  T88 T) T) H 	noneactive   7  7  T8 T88 T
88'  T88'   T) T) H 	noneactivehascaptain	ship>   8  T88'    T) T) H active>   8  T88'   T) T) H active  		  2   4  +  7>T7  T4 7  ' >T4 7  '  >AN4 +  7>4 7    F currentDefaultTableRowHelperdefaulttableGetTopRowinsert
tableexpandedexpandStatesipairs   +   7   7  8  +  72  :+  78 :+  78   T% :+  78   T4 7+  77>:+  78   T2  :	+  78   T' :
+  78   T'  :+  78   T2  :+  78   T'  :+  78	   T3 :+  78
   T'  :+  78   T'  :+  78   T2  :+  78   T'  :+  78   T'  :4 7+  77+  77>4 7+  77+  77>4 7+  77+  77>4 7+  77+  77	>4 7+  77+  77
>4 7+  77+  77>4 7+  77+  77>4 7+  77+  77>4 7+  77+  77>4 7+  77+  77>4 7+  77+  77>4 7+  77+  77>4 7+  77+  77>4 7+  77+  77>G  insert
table
TrackDbgLvltracklog
numwp
index      
statsactivitylogcrewscore
levelwaypointsGetCargoSpecs
LibMTcargolist	nonehomebasetrader	ship	dataselectedRow  ( 52   2  2  3  3 :1 1 :1 :1	 :1 :
1 :1 :1 : 1 : 1 : 1 : 1 : 1 : 1 : 1 :1 :1  :1! :1" :1# :1% :$1' :& >0  G   Trader GetExpandState       Homebase 	Stop 
Start Select Remove Add 	Back onCloseElement onSelectElement onRowChanged display onShowMenu cleanup transparent g a r b  	name&gMT_Station_Logistics_Select_ShipstatusWidthstatusHeight LJx   4      T2   5   4  7  4  +  > 4     T4  7  +  > G   registerMenuHelperinsert
table
Menus   +   )  :  +   )  : +   )  : +   )  : +   )  : +   )  : +   )  : G   	shipbuttonsdefaulttablebuttontableselecttableinfotableupdateInterval
  ++   2  :  +   ' : +   ' : +   7   +  78: +   7   +  78: +   7   4 (  '>: +   7   4 (  '>: +   7   +  7 78  T2  :	 +   7   +  78  T2  :
 +   7   +  7 78: +   7   +  7 78: +   7   3 : +   7   3 : +   7   4 +  7 78% >: +   7   2  : +   7   % : +   7   7     Tn4  +  7 7% % % % % >   % '   T8 78 7 % 4	 '
'N >	4
 ''x >
% 4 7 4  %  >  T4  %! >  T)  >$'  T6 76 7 T %" 4	 7		
 4  %  >  T4  %! >  T)  >	$	+  7 :+  7 4$ +	  7	 	7		%
% >:#+  7 7#  T+  7 +  7 7#8:T+  7 2  :+  7 % :+   3' +  7:(2  :):& +   7 * > G   display	dataidx  selectedRow$XRCLSGetNPCBlackboardcaptainlog - 	namecomponentIsComponentClassformatstring aicommandactionparamaicommandactionaicommandparamaicommandaicommandstackcommandTrackLog
pilotGetComponentDatacaptain  Not TrackingTrackingtracktype  NormalVerbosedbgTypetrackingdebug_leveladminloglogsubtitleReadText
titletrader
paramret_expselrowtoprow	ship     )  H       )  H       )  H  1 *U

4   7  +  > 4   2  : 4   )  : +   2  : 4  +  778% %	 > +  77
%   $2 4  7 ) ' ' '	 '
d '  '  4  74  7>;4  7 ) % ' '	 '
 'd 4  74  7) >;4  7% ) % ' '	 '
 'd 4  74  7>
 <  5
 3 4  74  7>;4  74  7>;3 2  2  4 7 4	 
	 7		% )  ' >	 =4 7 4	 
	 7		4 ( '/>% $)  ' >	 =4 7 4	 
	 7		4 +  778	8>)  ' >	 =4 7 4	 
	 7		% )  ' >	 =4 7 4	 
	 7		 3 4  7) '  >	 =2  4 7	 4
 
 7

% )  ' >
 =4 7	 4
 
 7

4 ( '>% $)  ' >
 =4 7	 4
 
 7

4 +  778	8>)  ' >
 =4 7	 4
 
 7

% )  ' >
 =4 7	 4
 
 7

 3  4  7) '  >
 =2  4	 7		
 4  7% )  ' > =	4	 7		
 4  74 ( '>% $)  ' > =	'	  4
  7
!
+  778	8'  >
'  
 T
4
  7
!
+  778	8+  778	8!'  >
	
 4
 7

 4  7	 %" $)  ' > =
4
 7

 4  7% )  ' > =
4
 7

 4  7 3# 4  7) '  > =
2
  4 7
 4  7% )  ' > =4 7
 4  74 ( '>% $)  ' > =4$ +  778	8) ) )  ) >%% $4 7
 4  7 )  ' > =4 7
 4  7% )  ' > =4 7 4  7
 3& 4  7) '  > =2  4 7 4  7% )  ' > =4 7 4  74 ( '>% $)  ' > =4' +  778	8) ' ) >4 7 4  7 4 ''n >$)  ' > =4 7 4  7% )  ' > =4 7 4  7 3( 4  7) '  > =2  4 7 4  7+  77))  ' > =4 7 4  7 3* 4  7) '  > =4 7++  4
 2 4, ;   ) >'< 2  2  3- +  77.	 TO2  4 7 4  74 ( '>)  ' > =+  77/'   T4 7 4  74 ( '>%0 +  7718$)  ' > =T4 7 4  74 ( '>%0 +  7718$)  ' > =4 7 4  7+  772+  77.6)  ' > =4 7 4  7 2  4  7) '  > =+  773 '   T2  4 7 4  74 '' >)  ' > =4 7 4  74 ( ' >)  ' > =4 7 4  74 ''- >)  ' > =4 7 4  74 ''>)  ' > =4 7 4  74 '' >)  ' > =4 7 4  7 2  4  7) '   > =44 +  773>TT2  4 7 4  !  7  4" 4#5 >#8$#$#>")#  '$ >  =4 7 4  !  7  4" 7"6"8#6"#")#  '$ >  =4 7 4  !  7  4"7 8#%$ >")#  '$ >  =4 7 4  !  7  8"	)#  '$ >  =4 7 4  !  7  4" 8#%$ >")#  '$ >  =4 7 4  !  7  " 2#  4$  7$$)% '&  >  =ANTs2  4 7 4  7% )  ' > =4 7 4  7 2  4  7) '   > =2  4 7 4  74 ( '>)  ' > =4 7 4  7 2  4  7)  '!  > =T;+  77.	 T62  4 7 4  74 ( '>)  ' > =+  77/'   T4 7 4  74 ( '>%0 +  7718$)  ' > =T4 7 4  74 ( '>%0 +  7718$)  ' > =4 7 4  7+  772+  77.6)  ' > =4 7 4  7 2  4  7) '  > =2  4 7 4  74 '' >)  ' > =4 7 4  74 ( '>)  ' > =4 7 4  7 2  4  7) '   > =' '
 ' I+  7786  T{89 TA2  %: 4; 8 >% 0 4! 7!6!8"6!"!%"0 4#7 8$%% >#%$0 8%	%&0 4' 8(%) >'$'4 7  4! "! 7!!4# 4$5 >$8%$%$>#)$  '% >! =4 7  4! "! 7!!# )$  '% >! =4 7  4! "! 7!!# 2$  4%  7%%)& ''  >! =T]2  %: 4; 8 >% < 4!; 4" 7"="8#6"#">!$!4 7  4! "! 7!!4# 4$5 >$8%$%$>#)$  '% >! =4 7  4! "! 7!!# )$  '% >! =4 7  4! "! 7!!# 2$  4%  7%%)& ''  >! =T&2  % 4 7  4! "! 7!!%# )$  '% >! =4 7  4! "! 7!!# )$  '% >! =4 7  4! "! 7!!# 2$  4%  7%%)& ''  >! =KW4 7>+     ) ) 	+  7?+   7 @ >+  2  :A4 7+  7A4  7B> =4 7+  7A4  7B> =4 7+  7A4  7B> =4 7+  7A4  7B> =4 7+  7A4  7B4 ''m
>+ 7C1D %E > =4 7+  7A4  7B> =4 7F  T4 7+  7A4  7B%G + 7H1I %J > =T	4 7+  7A4  7B> =4 7+  7A4  7B4 ( '>+ 7K1L %M > =4 7N+  +  7A  >+  +  +  4  7R+     )  %! %" '#  '$  '%  '&  %'S )( )) >:Q:P:O44  >T >AN4  7T>0  G   releaseDescriptors	bothdisplayThreeTableViewbuttontableselecttableinfotablecreate_standard_button_bar INPUT_STATE_DETAILMONITOR_X 
Track INPUT_STATE_DETAILMONITOR_Y Verbose(DBG) Verbose
DEBUG INPUT_STATE_DETAILMONITOR_B 	BackBarButtonbuttonsselrowtoprowcreate_bodyMessages: tostringWaypoint: TRADE_SUCCESSTrackLogGetWareDataWPTypeGetCurTimeipairslogtracktypedbgType - debug_leveltracking  Kdd typenamecreate_column_header  	nonecommand  	noneConvertIntegerString  	none CrConvertMoneyString  	none %
round  	none!defaultHeaderBackgroundColor  	noneRowConvertTimeString:ReadText	Cell
LibMTinsert
table      scaleXheaderRow1FontSizeheaderRow1Font	leftcreateFontStringheaderCharacterIconSizecreateIcon

titleownericon	nametrader	shipGetComponentDatarowDataMapcurrentTableRowDatacurrentTableRowremoveAllButtonScriptsHelperJ (  +  7  T+  7: +  7:4  7+     >G   CheckButtonBarAvailability
LibMT	dataidxselectedRowdefaulttable     G  "  +   7 >G  	Back  -+   7   7     Tk4  +  7 78% % % > 4 +  7 7% % %	 %
 %	 > %	 4
  >
% 4  >% 4   >$		'
  
 T
8
7
8
7
4
 	 % 4 ''N >4 ''x >% 4 7 4  % >  T4  % >  T)  >$>
	
 '
 
 T
6
7
6
7
 T
4
 	 % 4 7 4  % >  T4  % >  T)  >$>
	
 +
  7
 
:	
+   7   4 +  7 7% >: +   7   7     T{+   7   7  	   T v+   7   7     '    T o+   7   +  7 78: '  '
 ' I d+  7 76  T\8 T2%  4 8>% 4! 7"8	6	%	 4
# 8% >
% 8	% 4 8% >$4$ 7%+  7& '	 4
' 4( >8>
4! 7)7*>4$ 7%+  7& '	 
 4! 7)7*>T'%  4 8>%+ 4 4	! 7	,	8
6	
	>$4$ 7%+  7& '	 4
' 4( >8>
4! 7)7*>4$ 7%+  7& '	 
 4! 7)7*>K G   Messages: 
whitecoloursGetCurTimeConvertTimeStringselecttableupdateCellTextHelperGetWareDataWPType
LibMTWaypoint: TRADE_SUCCESSTrackLogtracking$XRCLSGetNPCBlackboardcaptainlog - 	namecomponentIsComponentClassformatstring ReadText
paramcommand / tostringLocation: aicommandactionparamaicommandactionaicommandparamaicommandaicommandstackclustersector	zonetraderGetComponentDatacaptain	ship   #4   7  +  ) % 2 +  778;+  778;2  ;+  77;2  ;2  ;+  77;> +   7  > G   cleanuptraderret_exp	shipgMT_ReportMenu_returncloseMenuForSectionHelper  	)+   7   7  	   T +   7   ' : T +   7   '  : 4  7  +  ) % 3 +  7 7;+  7 7;2  ;2  ;+  7 7;> +   7  > G   cleanuptraderret_exp  "gMT_ReportMenu_toggleTrackingcloseMenuForSectionHelpertracking	ship   3+   7   7  	   T +   7   ' : T +   7   '  : 4  7  +  ) % 2 +  7 78;+  7 78;+  7 7;+  7 7;2  ;2  ;+  7 7;> +   7  > G   cleanuptraderret_expgMT_ReportMenu_toggleDbgcloseMenuForSectionHelperdebug_level	ship     G     "3   3 : 2  2  1 1 : 1 : 1	 : 1 :
 1 : 1 : ' : 1 : 1 :1 :1 :1 : >0  G   Select Verbose 
Track 	Back onUpdateupdateInterval onCloseElement onSelectElement onRowChanged display onShowMenu cleanup transparent g a r b  	name"gMT_Station_Logistics_ShipLogstatusWidthstatusHeight <?xml version="1.0" encoding="utf-8"?>
<diff xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <add sel="/addon[@name='ego_detailmonitor']/dependency" pos="before">
    <file name="..\..\..\extensions\mt_XRCLS\ui\addons\ego_detailmonitor\MT_Station_Logistics_Admin_Menu.lua" />
    <file name="..\..\..\extensions\mt_XRCLS\ui\addons\ego_detailmonitor\MT_Station_Logistics_Reports_Menu.lua" />
    <file name="..\..\..\extensions\mt_XRCLS\ui\addons\ego_detailmonitor\MT_Station_Logistics_Config_Menu.lua" />
    <file name="..\..\..\extensions\mt_XRCLS\ui\addons\ego_detailmonitor\MT_Station_Logistics_Select_Ship.lua" />
    <file name="..\..\..\extensions\mt_XRCLS\ui\addons\ego_detailmonitor\MT_Station_Logistics_ListWaypoints.lua" />
	<file name="..\..\..\extensions\mt_XRCLS\ui\addons\ego_detailmonitor\MT_Station_Logistics_EditWaypoint.lua" />
	<file name="..\..\..\extensions\mt_XRCLS\ui\addons\ego_detailmonitor\MT_Station_Logistics_CrewLog.lua" />
	<file name="..\..\..\extensions\mt_XRCLS\ui\addons\ego_detailmonitor\MT_Station_Logistics_ShipLog.lua" />
	<file name="..\..\..\extensions\mt_XRCLS\ui\addons\ego_detailmonitor\MT_Station_Logistics_AdminLog.lua" />
	<file name="..\..\..\extensions\mt_XRCLS\ui\addons\ego_detailmonitor\MT_Station_Logistics_Rename.lua" />
	<file name="..\..\..\extensions\mt_XRCLS\ui\addons\ego_detailmonitor\lib\LibMT.lua" />
  </add>
</diff>
<?xml version="1.0" encoding="utf-8"?>
<diff xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <add sel="/addon[@name='ego_mainmenu']/dependency" pos="before">
    <file name="..\..\..\extensions\mt_XRCLS\ui\addons\ego_mainmenu\mainmenu_mt_station_logistics.lua" />
  </add>
</diff>
LJ 		 4  7 7>T	7 T4 77+  7>ANG   entry1	listinsert
tablemm_ic_trading	icontop
setupipairs@   +   7   > +  +  7> G   	menuorigCreateSetup   4      T4  4  > T7 T+  :+  7:+ :T ANG   createSetuporigCreateSetup	menuMainMenu	nameipairs
Menus  3  3  4 (  ' >:4 (  ' >:3 2  ;2  ;2  ;2  ;:: 1 1	 1
  >0  G     entry1  sectionparam    	info	nameReadText 	iconmm_ic_tradingsectiongMT_Logisticscondition <?xml version="1.0" encoding="utf-8"?>
<diff xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <add sel="/addon[@name='ego_mainmenu']/dependency" pos="before">
    <file name="..\..\..\extensions\mt_XRCLS\ui\addons\ego_mainmenu\mainmenu_mt_station_logistics.lua" />
  </add>
</diff>
